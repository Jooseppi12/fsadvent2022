(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.WebSharper={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return WebSharper.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:WebSharper.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},MarkResizable:function(n){return Object.defineProperty(n,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},MarkReadOnly:function(n){return Object.defineProperty(n,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.WebSharper.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1;b=a.fsadvent=a.fsadvent||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.Obj=d.Obj||{};f=d.UI=d.UI||{};g=f.Var$1=f.Var$1||{};h=d.List=d.List||{};i=d.Operators=d.Operators||{};j=f.Templating=f.Templating||{};k=j.Runtime=j.Runtime||{};l=k.Server=k.Server||{};m=l.TemplateInstance=l.TemplateInstance||{};n=d.Arrays=d.Arrays||{};o=l.ProviderBuilder=l.ProviderBuilder||{};p=f.Var=f.Var||{};q=f.View=f.View||{};r=d.JavaScript=d.JavaScript||{};s=r.JS=r.JS||{};t=a.EventTarget;u=a.Node;v=r.Pervasives=r.Pervasives||{};w=d.Unchecked=d.Unchecked||{};x=a.Element;y=a.HTMLElement;z=c.Dart=c.Dart||{};A=l.Handler=l.Handler||{};B=h.T=h.T||{};C=a.fsadvent_Templates=a.fsadvent_Templates||{};D=f.ConcreteVar=f.ConcreteVar||{};E=f.Snap=f.Snap||{};F=f.AttrProxy=f.AttrProxy||{};G=a.System=a.System||{};H=G.Guid=G.Guid||{};I=f.AttrModule=f.AttrModule||{};J=a.StartupCode$fsadvent$Client=a.StartupCode$fsadvent$Client||{};K=a.WindowOrWorkerGlobalScope;L=d.Collections=d.Collections||{};M=L.FSharpMap=L.FSharpMap||{};N=a.Error;O=d.MatchFailureException=d.MatchFailureException||{};P=f.Doc=f.Doc||{};Q=d.Utils=d.Utils||{};R=f.Client=f.Client||{};S=R.Templates=R.Templates||{};T=f.Abbrev=f.Abbrev||{};U=T.Fresh=T.Fresh||{};V=L.Dictionary=L.Dictionary||{};W=f.Array=f.Array||{};X=f.Attrs=f.Attrs||{};Y=d.Seq=d.Seq||{};Z=L.Map=L.Map||{};_0=d.Numeric=d.Numeric||{};_1=a.Object;_2=L.Pair=L.Pair||{};_3=L.BalancedTree=L.BalancedTree||{};_4=d.Enumerator=d.Enumerator||{};_5=L.HashSet=L.HashSet||{};_6=l.TemplateInitializer=l.TemplateInitializer||{};_7=_4.T=_4.T||{};_8=a.Blob;_9=f.CheckedInput=f.CheckedInput||{};_=f.DynamicAttrNode=f.DynamicAttrNode||{};$=_3.Tree=_3.Tree||{};ba=f.Docs=f.Docs||{};bb=f.DomUtility=f.DomUtility||{};bc=L.DictionaryUtil=L.DictionaryUtil||{};bd=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};be=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bf=f.DocElemNode=f.DocElemNode||{};bg=a.CharacterData;bh=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bi=f.Elt=f.Elt||{};bj=S.Prepare=S.Prepare||{};bk=d.Slice=d.Slice||{};bl=L.KeyCollection=L.KeyCollection||{};bm=f.An=f.An||{};bn=R.Settings=R.Settings||{};bo=T.Mailbox=T.Mailbox||{};bp=R.Attrs=R.Attrs||{};bq=bp.Dyn=bp.Dyn||{};br=f.BindVar=f.BindVar||{};bs=f.String=f.String||{};bt=f.Updates=f.Updates||{};bu=d.Strings=d.Strings||{};bv=L.ValueCollection=L.ValueCollection||{};bw=R.Docs=R.Docs||{};bx=bw.RunState=bw.RunState||{};by=bw.NodeSet=bw.NodeSet||{};bz=d.Concurrency=d.Concurrency||{};bA=f.Anims=f.Anims||{};bB=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bC=L.HashSetUtil=L.HashSetUtil||{};bD=d.Char=d.Char||{};bE=d.DateUtil=d.DateUtil||{};bF=d.Queue=d.Queue||{};bG=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bH=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bI=f.AppendList=f.AppendList||{};bJ=d.KeyNotFoundException=d.KeyNotFoundException||{};bK=d.ArgumentException=d.ArgumentException||{};bL=bz.Scheduler=bz.Scheduler||{};bM=f.Easing=f.Easing||{};bN=bz.AsyncBody=bz.AsyncBody||{};bO=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bP=bz.CT=bz.CT||{};bQ=T.HashSet=T.HashSet||{};bR=d.CancellationTokenSource=d.CancellationTokenSource||{};bS=bw.DomNodes=bw.DomNodes||{};bT=d.OperationCanceledException=d.OperationCanceledException||{};bU=d.Lazy=d.Lazy||{};bV=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bW=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};bX=bW.LazyRecord=bW.LazyRecord||{};bY=a.Math;bZ=d&&d.Runtime;b0=a.console;b1=a.Date;c.Main=function(){var b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck;b2=g.Create$1(null);b3=g.Create$1(1);b4=g.Create$1(false);b5=g.Create$1(h.ofArray([null]));b6=(b7=(b8=P.BindView(function(cl){return P.Select([],c.PrettyPrintDartsSet,cl,b2);},b5.get_View()),(b9=(b_=(b$=q.Map(function(cl){return cl!=null&&cl.$==1?z.AsDartNotation(cl.$0[2]):"";},b2.get_View()),(ca=(cb=q.Map(function(cl){return cl!=null&&cl.$==1?z.AsDartNotation(cl.$0[1]):"";},b2.get_View()),(cc=(cd=q.Map(function(cl){return cl!=null&&cl.$==1?z.AsDartNotation(cl.$0[0]):"";},b2.get_View()),(ce=(cf=(cg=(ch=h.ofArray([I.DynamicCustom(function(cl){return function(cm){q.Get(function(cn){var co;if(cn!=null&&cn.$==1){a.clearInterval(cn.$0);co=self.document.querySelector("span.highlighted");if(co!==null)co.classList.remove("highlighted");c.animationHandle().Set(null);}},c.animationHandle().get_View());return c.highlightDartboard(cl.getContext("2d"),cm);};},b2.get_View()),I.OnAfterRender(function(cl){c.drawDartboard(cl.getContext("2d"),z.Nil);})]),(ci=new o.New$1(),(ci.h.push({$:3,$0:"canvasattr",$1:F.Concat(ch)}),ci))),(cg.h.push({$:11,$0:"isitcheckout",$1:b4}),cg)),(cf.h.push({$:16,$0:"selectednumber",$1:b3}),cf)),(ce.h.push({$:2,$0:"selected1",$1:cd}),ce))),(cc.h.push({$:2,$0:"selected2",$1:cb}),cc))),(ca.h.push({$:2,$0:"selected3",$1:b$}),ca))),(b_.h.push(A.EventQ2(b_.k,"calculate",function(){return b_.i;},function(){q.Get(function(cl){q.Get(function(cm){var cn;q.Get(function(co){if(co!=null&&co.$==1){a.clearInterval(co.$0);c.animationHandle().Set(null);}},c.animationHandle().get_View());cn=c.getCombinationsFor(cl,cm);if(cn.get_Length()===0)a.alert(a.String(cl)+" cannot be reached with 3 darts! Please try a different number.");b5.Set(new B({$:1,$0:null,$1:cn}));if(cn.get_Length()>1)b2.Set(h.head(cn));else b2.Set(null);},b4.get_View());},b3.get_View());})),b_)),(b9.h.push({$:0,$0:"selectionbox",$1:b8}),b9))),(cj=A.CompleteHoles(b7.k,b7.h,[["selectednumber",1,null],["isitcheckout",2,null]]),(ck=new m.New(cj[1],C.main(cj[0])),b7.i=ck,ck))).get_Doc();S.LoadLocalTemplates("");P.RunById("main",b6);};c.animationHandle=function(){J.$cctor();return J.animationHandle;};c.highlightDartboard=function(b2,b3){var b4,b5,b6,b7;if(b3!=null&&b3.$==1){b4=b3.$0[2];b5=b3.$0[1];b6=b3.$0[0];b7=1;c.animationHandle().Set({$:1,$0:a.setInterval(function(){var b8;b8=self.document.querySelector("span.highlighted");if(b8!==null)b8.classList.remove("highlighted");c.drawDartboard(b2,b7===1?b6:b7===2?b5:b4);self.document.getElementById("dart"+a.String(b7)).classList.add("highlighted");if(b7===3)b7=1;else b7=b7+1;},1000)});}else c.drawDartboard(b2,z.Nil);};c.drawDartboard=function(b2,b3){var b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci;b7="#61bff9";c.resetBoard(b2);b8=c.WIDTH()/2-10;b9=b8*0.75;c.renderCircle(b2,b8,"#11191f");b_=h.indexed(c.dartRingNumbers());b$=_4.Get(b_);try{while(b$.MoveNext()){ca=b$.Current();cb=ca[1];cc=ca[0];cd=b3.$==1&&(cb===b3.$0&&(ce=b3.$0,true))?b7:cc%2===0?"#e63322":"#389536";cf=b3.$==0&&(cb===b3.$0&&(cg=b3.$0,true))?b7:cc%2===0?"#e63322":"#389536";ch=b3.$==2&&(cb===b3.$0&&(ci=b3.$0,true))?b7:cc%2===0?"#171918":"#f7e0b6";c.renderSector(b2,b9,cd,cc);c.renderSector(b2,b9*0.953,ch,cc);c.renderSector(b2,b9*0.694,cf,cc);c.renderSector(b2,b9*0.629,ch,cc);c.renderLabel(b2,cb,cc);}}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}b5=w.Equals(b3,{$:2,$0:25})?b7:"#389536";b6=w.Equals(b3,{$:1,$0:25})?b7:"#e63322";c.renderCircle(b2,b9*0.094,b5);c.renderCircle(b2,b9*0.037,b6);};c.getCombinationsFor=function(b2,b3){function b4(b6,b7,b8){var b9,b_,b$,ca,cc,cd,ce,cf,cg,ch;function cb(ci){return b3?h.filter(z.IsCheckout,ci):ci;}cc=(b9=null,[c.scoringValues().TryGetValue(b6,{get:function(){return b9;},set:function(ci){b9=ci;}}),b9]);cd=(b_=null,[c.scoringValues().TryGetValue(b7,{get:function(){return b_;},set:function(ci){b_=ci;}}),b_]);ce=(b$=null,[c.scoringValues().TryGetValue(b8,{get:function(){return b$;},set:function(ci){b$=ci;}}),b$]);switch(cc[0]?cd[0]?cd[1].$==1?cd[1].$0.$==3?cd[1].$1.$==0?ce[0]?ce[1].$==1?ce[1].$0.$==3?ce[1].$1.$==0?(ca=cc[1],0):(ca=[cc[1],cd[1],ce[1]],2):(ca=[cc[1],cd[1],ce[1]],2):(ca=[cc[1],cd[1],ce[1]],2):3:ce[0]?ce[1].$==1?ce[1].$0.$==3?ce[1].$1.$==0?(ca=[cc[1],cd[1]],1):(ca=[cc[1],cd[1],ce[1]],2):(ca=[cc[1],cd[1],ce[1]],2):(ca=[cc[1],cd[1],ce[1]],2):3:ce[0]?ce[1].$==1?ce[1].$0.$==3?ce[1].$1.$==0?(ca=[cc[1],cd[1]],1):(ca=[cc[1],cd[1],ce[1]],2):(ca=[cc[1],cd[1],ce[1]],2):(ca=[cc[1],cd[1],ce[1]],2):3:ce[0]?ce[1].$==1?ce[1].$0.$==3?ce[1].$1.$==0?(ca=[cc[1],cd[1]],1):(ca=[cc[1],cd[1],ce[1]],2):(ca=[cc[1],cd[1],ce[1]],2):(ca=[cc[1],cd[1],ce[1]],2):3:3:3){case 0:return h.map(function(ci){return{$:1,$0:[ci,z.Nil,z.Nil]};},cb(ca));case 1:cf=ca[1];return h.collect(function(ci){return h.map(function(cj){return{$:1,$0:[ci,cj,z.Nil]};},cb(cf));},ca[0]);case 2:cg=ca[1];ch=ca[2];return h.collect(function(ci){return h.collect(function(cj){return h.map(function(ck){return{$:1,$0:[ci,cj,ck]};},cb(ch));},cg);},ca[0]);case 3:return B.Empty;}}function b5(b6,b7){return h.choose(function(b8){return b8===0&&b7!==0?null:b7-b8<0?null:b7-b8===0&&b3&&b8%2===0?{$:1,$0:[b6,b8,b7-b8]}:b7-b8===0&&b3?null:c.scoringValues().ContainsKey(b7-b8)&&(!b3||(b7-b8)%2===0)?{$:1,$0:[b6,b8,b7-b8]}:null;},h.ofSeq(c.scoringValues().get_Keys()));}return h.sortBy(function(b6){if(b6!=null&&b6.$==1)return[b6.$0[0],b6.$0[1]];else throw new O.New("Client.fs",126,29);},h.collect(function(b6){return b4(b6[0],b6[1],b6[2]);},h.collect(function(b6){return b5(b6[0],b6[1]);},h.choose(function(b6){return b6===0&&b2!==0?null:b2-b6<0?null:b3&&b2-b6===0&&b6%2===0?{$:1,$0:[b6,b2-b6]}:b3&&b2-b6===0?null:{$:1,$0:[b6,b2-b6]};},h.ofSeq(c.scoringValues().get_Keys())))));};c.PrettyPrintDartsSet=function(b2){var b3;switch(b2!=null&&b2.$==1?b2.$0[1].$==3?b2.$0[2].$==3?(b3=b2.$0[0],0):(b3=[b2.$0[0],b2.$0[1],b2.$0[2]],2):b2.$0[2].$==3?(b3=[b2.$0[0],b2.$0[1]],1):(b3=[b2.$0[0],b2.$0[1],b2.$0[2]],2):3){case 0:return Q.toSafe(z.AsDartNotation(b3));case 1:return Q.toSafe(z.AsDartNotation(b3[0]))+" - "+Q.toSafe(z.AsDartNotation(b3[1]));case 2:return Q.toSafe(z.AsDartNotation(b3[0]))+" - "+Q.toSafe(z.AsDartNotation(b3[1]))+" - "+Q.toSafe(z.AsDartNotation(b3[2]));case 3:return"None";}};c.resetBoard=function(b2){b2.clearRect(0,0,c.WIDTH(),c.HEIGHT());};c.WIDTH=function(){J.$cctor();return J.WIDTH;};c.renderCircle=function(b2,b3,b4){b2.beginPath();b2.arc(c.WIDTH()/2,c.HEIGHT()/2,b3,0,2*bY.PI,false);b2.lineWidth=1;b2.strokeStyle=b4;b2.fillStyle=b4;b2.fill();b2.stroke();};c.renderSector=function(b2,b3,b4,b5){var b6,b7,b8;b6=-99+b5*18;b7=c.convertToRadian(b6);b8=c.convertToRadian(b6+18);b2.beginPath();b2.moveTo(c.WIDTH()/2,c.HEIGHT()/2);b2.arc(c.WIDTH()/2,c.HEIGHT()/2,b3,b7,b8,false);b2.lineWidth=1;b2.strokeStyle=b4;b2.lineTo(c.WIDTH()/2,c.HEIGHT()/2);b2.fillStyle=b4;b2.fill();b2.stroke();};c.renderLabel=function(b2,b3,b4){b2.save();b2.strokeStyle="white";b2.fillStyle="white";b2.font="30px Arial";b2.textAlign="center";b2.translate(c.WIDTH()/2,c.HEIGHT()/2);b4>5&&b4<10?b2.rotate(c.convertToRadian((20+b4-10)*18)):b4===10?b2.rotate(c.convertToRadian(0)):b4>10&&b4<15?b2.rotate(c.convertToRadian((b4-10)*18)):b2.rotate(c.convertToRadian(b4*18));b2.fillText(a.String(b3),0,b4>5&&b4<15?c.HEIGHT()/2*0.85+15:-c.HEIGHT()/2*0.85);b2.restore();};c.dartRingNumbers=function(){J.$cctor();return J.dartRingNumbers;};c.scoringValues=function(){J.$cctor();return J.scoringValues;};c.HEIGHT=function(){J.$cctor();return J.HEIGHT;};c.convertToRadian=function(b2){return b2*bY.PI/180;};e=d.Obj=bZ.Class({Equals:function(b2){return this===b2;},GetHashCode:function(){return -1;}},null,e);e.New=bZ.Ctor(function(){},e);g=f.Var$1=bZ.Class({},e,g);g.Create$1=function(b2){return new D.New(false,E.New({$:2,$0:b2,$1:[]}),b2);};h.ofArray=function(b2){var b3,b4,b5;b3=B.Empty;for(b4=n.length(b2)-1,b5=0;b4>=b5;b4--)b3=new B({$:1,$0:n.get(b2,b4),$1:b3});return b3;};h.head=function(b2){return b2.$==1?b2.$0:h.listEmpty();};h.indexed=function(b2){return h.mapi(function(b3,b4){return[b3,b4];},b2);};h.ofSeq=function(b2){var b3,b4,b5,b6,b7,b8;if(b2 instanceof B)return b2;else if(b2 instanceof a.Array)return h.ofArray(b2);else{b3=_4.Get(b2);try{b5=b3.MoveNext();if(!b5)b4=B.Empty;else{b7=new B({$:1});b6=b7;while(b5){b6.$0=b3.Current();if(b3.MoveNext())b6=(b8=new B({$:1}),b6.$1=b8,b8);else b5=false;}b6.$1=B.Empty;b4=b7;}return b4;}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}}};h.choose=function(b2,b3){return h.ofSeq(Y.choose(b2,b3));};h.collect=function(b2,b3){return h.ofSeq(Y.collect(b2,b3));};h.filter=function(b2,b3){var b4,b5,b6,b7,b8,b9;if(b3.$==0)return b3;else{b4=B.Empty;b5=b4;b6=b3;b7=true;while(b7){if(b2(b6.$0)){b4.$==0?(b4=new B({$:1}),b5=b4):b5=(b8=new B({$:1}),b5.$1=b8,b8);b9=b6.$0;b5.$=1;b5.$0=b9;}b6=b6.$1;if(b6.$==0)b7=false;}if(!(b4.$==0))b5.$1=B.Empty;return b4;}};h.map=function(b2,b3){var b4,b5,b6,b7,b8;if(b3.$==0)return b3;else{b7=new B({$:1});b4=b7;b5=b3;b6=true;while(b6){b4.$0=b2(b5.$0);b5=b5.$1;if(b5.$==0)b6=false;else b4=(b8=new B({$:1}),b4.$1=b8,b8);}b4.$1=B.Empty;return b7;}};h.sortBy=function(b2,b3){var b4;b4=n.ofList(b3);n.sortInPlaceBy(b2,b4);return h.ofArray(b4);};h.length=function(b2){var b3,b4;b3=b2;b4=0;while(b3.$==1){b3=h.tail(b3);b4=b4+1;}return b4;};h.listEmpty=function(){return i.FailWith("The input list was empty.");};h.groupBy=function(b2,b3){var b4;function b5(b6,b7){return[b6,h.ofArray(b7)];}b4=n.groupBy(b2,n.ofList(b3));n.mapInPlace(function(b6){return b5(b6[0],b6[1]);},b4);return h.ofArray(b4);};h.mapi=function(b2,b3){var b4,b5,b6,b7,b8,b9;if(b3.$==0)return b3;else{b8=new B({$:1});b4=b8;b5=b3;b6=0;b7=true;while(b7){b4.$0=b2(b6,b5.$0);b5=b5.$1;if(b5.$==0)b7=false;else{b4=(b9=new B({$:1}),b4.$1=b9,b9);b6=b6+1;}}b4.$1=B.Empty;return b8;}};h.tail=function(b2){return b2.$==1?b2.$1:h.listEmpty();};i.FailWith=function(b2){throw new N(b2);};i.range=function(b2,b3){var b4;b4=1+b3-b2;return b4<=0?[]:Y.init(b4,function(b5){return b5+b2;});};i.KeyValue=function(b2){return[b2.K,b2.V];};m=l.TemplateInstance=bZ.Class({get_Doc:function(){return this.doc;},SetAnchorRoot:function(b2){this.anchorRoot=b2;}},e,m);m.New=bZ.Ctor(function(b2,b3){e.New.call(this);this.doc=b3;this.allVars=b2.$==0?b2.$0:i.FailWith("Should not happen");this.anchorRoot=null;},m);n.get=function(b2,b3){n.checkBounds(b2,b3);return b2[b3];};n.length=function(b2){return b2.dims===2?b2.length*b2.length:b2.length;};n.checkBounds=function(b2,b3){if(b3<0||b3>=b2.length)i.FailWith("Index was outside the bounds of the array.");};n.set=function(b2,b3,b4){n.checkBounds(b2,b3);b2[b3]=b4;};o=l.ProviderBuilder=bZ.Class({},e,o);o.New$1=bZ.Ctor(function(){var b2;e.New.call(this);this.i=null;this.k=(b2=H.NewGuid(),a.String(b2));this.h=bZ.MarkResizable([]);bZ.SetOptional(this,"s",null);},o);p=f.Var=bZ.Class({},e,p);p.New=bZ.Ctor(function(){e.New.call(this);},p);q.Get=function(b2,b3){var b4;function b5(){E.WhenRun(b3(),function(b6){if(!b4[0]){b4[0]=true;b2(b6);}},function(){if(!b4[0])b5();});}b4=[false];b5();};q.Map=function(b2,b3){return q.CreateLazy(function(){return E.Map(b2,b3());});};q.CreateLazy=function(b2){var b3;b3={c:null,o:b2};return function(){var b4,b5;b4=b3.c;return b4===null?(b4=b3.o(),b3.c=b4,(b5=b4.s,b5!=null&&b5.$==0)?b3.o=null:E.WhenObsoleteRun(b4,function(){b3.c=null;}),b4):b4;};};q.Bind=function(b2,b3){return q.Join(q.Map(b2,b3));};q.Const=function(b2){var b3;b3=E.New({$:0,$0:b2});return function(){return b3;};};q.Join=function(b2){return q.CreateLazy(function(){return E.Join(b2());});};q.Map2Unit=function(b2,b3){return q.CreateLazy(function(){return E.Map2Unit(b2(),b3());});};q.Sink=function(b2,b3){function b4(){E.WhenRun(b3(),b2,function(){bz.scheduler().Fork(b4);});}bz.scheduler().Fork(b4);};q.Map3=function(b2,b3,b4,b5){return q.CreateLazy(function(){return E.Map3(b2,b3(),b4(),b5());});};q.Sequence=function(b2){return q.CreateLazy(function(){return E.Sequence(Y.map(function(b3){return b3();},b2));});};q.Map2=function(b2,b3,b4){return q.CreateLazy(function(){return E.Map2(b2,b3(),b4());});};s.GetFieldValues=function(b2){var b3,b4;b3=[];for(var b5 in b2)b3.push(b2[b5]);return b3;};v.NewFromSeq=function(b2){var b3,b4,b5;b3={};b4=_4.Get(b2);try{while(b4.MoveNext()){b5=b4.Current();b3[b5[0]]=b5[1];}}finally{if(typeof b4=="object"&&"Dispose"in b4)b4.Dispose();}return b3;};w.Equals=function(b2,b3){var b4,b5,b6,b7;if(b2===b3)return true;else{b4=typeof b2;if(b4=="object"){if(b2===null||b2===void 0||b3===null||b3===void 0||!w.Equals(typeof b3,"object"))return false;else if("Equals"in b2)return b2.Equals(b3);else if("Equals"in b3)return false;else if(b2 instanceof a.Array&&b3 instanceof a.Array)return w.arrayEquals(b2,b3);else if(b2 instanceof a.Date&&b3 instanceof a.Date)return w.dateEquals(b2,b3);else{b5=[true];for(var b8 in b2)if(function(b9){b5[0]=!b2.hasOwnProperty(b9)||b3.hasOwnProperty(b9)&&w.Equals(b2[b9],b3[b9]);return!b5[0];}(b8))break;if(b5[0]){for(var b9 in b3)if(function(b_){b5[0]=!b3.hasOwnProperty(b_)||b2.hasOwnProperty(b_);return!b5[0];}(b9))break;}return b5[0];}}else return b4=="function"&&("$Func"in b2?b2.$Func===b3.$Func&&b2.$Target===b3.$Target:"$Invokes"in b2&&"$Invokes"in b3&&w.arrayEquals(b2.$Invokes,b3.$Invokes));}};w.arrayEquals=function(b2,b3){var b4,b5;if(n.length(b2)===n.length(b3)){b4=true;b5=0;while(b4&&b5<n.length(b2)){!w.Equals(n.get(b2,b5),n.get(b3,b5))?b4=false:void 0;b5=b5+1;}return b4;}else return false;};w.dateEquals=function(b2,b3){return b2.getTime()===b3.getTime();};w.Compare=function(b2,b3){var b4,b5,b6,b7,b8,b9;if(b2===b3)return 0;else{b5=typeof b2;switch(b5=="function"?1:b5=="boolean"?2:b5=="number"?2:b5=="string"?2:b5=="object"?3:0){case 0:return typeof b3=="undefined"?0:-1;case 1:return i.FailWith("Cannot compare function values.");case 2:return b2<b3?-1:1;case 3:if(b2===null)b6=-1;else if(b3===null)b6=1;else if("CompareTo"in b2)b6=b2.CompareTo(b3);else if("CompareTo0"in b2)b6=b2.CompareTo0(b3);else if(b2 instanceof a.Array&&b3 instanceof a.Array)b6=w.compareArrays(b2,b3);else if(b2 instanceof a.Date&&b3 instanceof a.Date)b6=w.compareDates(b2,b3);else{b7=[0];for(var b_ in b2)if(function(b$){return!b2.hasOwnProperty(b$)?false:!b3.hasOwnProperty(b$)?(b7[0]=1,true):(b7[0]=w.Compare(b2[b$],b3[b$]),b7[0]!==0);}(b_))break;if(b7[0]===0){for(var b$ in b3)if(function(ca){return!b3.hasOwnProperty(ca)?false:!b2.hasOwnProperty(ca)&&(b7[0]=-1,true);}(b$))break;}b6=b7[0];}return b6;}}};w.Hash=function(b2){var b3;b3=typeof b2;return b3=="function"?0:b3=="boolean"?b2?1:0:b3=="number"?b2:b3=="string"?w.hashString(b2):b3=="object"?b2==null?0:b2 instanceof a.Array?w.hashArray(b2):w.hashObject(b2):0;};w.compareArrays=function(b2,b3){var b4,b5;if(n.length(b2)<n.length(b3))return -1;else if(n.length(b2)>n.length(b3))return 1;else{b4=0;b5=0;while(b4===0&&b5<n.length(b2)){b4=w.Compare(n.get(b2,b5),n.get(b3,b5));b5=b5+1;}return b4;}};w.compareDates=function(b2,b3){return w.Compare(b2.getTime(),b3.getTime());};w.hashString=function(b2){var b3,b4,b5;if(b2===null)return 0;else{b3=5381;for(b4=0,b5=b2.length-1;b4<=b5;b4++)b3=w.hashMix(b3,b2[b4].charCodeAt());return b3;}};w.hashArray=function(b2){var b3,b4,b5;b3=-34948909;for(b4=0,b5=n.length(b2)-1;b4<=b5;b4++)b3=w.hashMix(b3,w.Hash(n.get(b2,b4)));return b3;};w.hashObject=function(b2){var b3,b4;if("GetHashCode"in b2)return b2.GetHashCode();else{b3=[0];for(var b5 in b2)if(function(b6){b3[0]=w.hashMix(w.hashMix(b3[0],w.hashString(b6)),w.Hash(b2[b6]));return false;}(b5))break;return b3[0];}};w.hashMix=function(b2,b3){return(b2<<5)+b2+b3;};z.Nil={$:3};z.AsDartNotation=function(b2){var b3;return b2.$==1?(b3=b2.$0,b3===25?"Bull":"D"+a.String(b3)):b2.$==2?a.String(b2.$0):b2.$==3?"":"T"+a.String(b2.$0);};z.IsCheckout=function(b2){return b2.$==1;};z.AsScore=function(b2){return b2.$==1?2*b2.$0:b2.$==2?b2.$0:b2.$==3?0:3*b2.$0;};q=f.View=bZ.Class({},null,q);A.EventQ2=function(b2,b3,b4,b5){return{$:5,$0:b3,$1:function(b6){return function(b7){var b8;b8=b4();b8.SetAnchorRoot(b6);return b5({Vars:b8,Anchors:b8,Target:b6,Event:b7});};}};};A.CompleteHoles=function(b2,b3,b4){var b6,b7,b8,b9,b_;function b5(b$,ca,cb){var cc;return b7.Contains(b$)?null:(cc=w.Equals(ca,0)?_6.GetOrAddHoleFor(b2,b$,function(){return{$:10,$0:b$,$1:g.Create$1("")};}):w.Equals(ca,1)?_6.GetOrAddHoleFor(b2,b$,function(){return{$:18,$0:b$,$1:g.Create$1(0)};}):w.Equals(ca,2)?_6.GetOrAddHoleFor(b2,b$,function(){return{$:11,$0:b$,$1:g.Create$1(false)};}):w.Equals(ca,3)?_6.GetOrAddHoleFor(b2,b$,function(){return{$:12,$0:b$,$1:g.Create$1(-8640000000000000)};}):w.Equals(ca,4)?_6.GetOrAddHoleFor(b2,b$,function(){return{$:13,$0:b$,$1:g.Create$1([])};}):w.Equals(ca,5)?_6.GetOrAddHoleFor(b2,b$,function(){var cd;cd=self.document.querySelector("[ws-dom="+b$+"]");cd.removeAttribute("ws-dom");return{$:14,$0:b$,$1:g.Create$1({$:1,$0:cd})};}):i.FailWith("Invalid value type"),(b6.set_Item(b$,cc),{$:1,$0:cc}));}b6=new V.New$5();b7=new _5.New$3();b8=_4.Get(b3);try{while(b8.MoveNext()){b9=b8.Current();b_=b9.$0;b7.SAdd(b_);b6.set_Item(b_,b9);}}finally{if(typeof b8=="object"&&"Dispose"in b8)b8.Dispose();}return[Y.append(b3,n.choose(function(b$){return b5(b$[0],b$[1],b$[2]);},b4)),{$:0,$0:b6}];};B=h.T=bZ.Class({get_Length:function(){return h.length(this);},get_Item:function(b2){return Y.nth(b2,this);},GetEnumerator:function(){return new _7.New(this,null,function(b2){var b3;b3=b2.s;return b3.$==0?false:(b2.c=b3.$0,b2.s=b3.$1,true);},void 0);}},null,B);B.Empty=new B({$:0});C.main=function(b2){S.LoadLocalTemplates("index");return b2?S.NamedTemplate("index",{$:1,$0:"main"},b2):void 0;};D=f.ConcreteVar=bZ.Class({get_View:function(){return this.view;},Set:function(b2){if(this.isConst)(function(b3){return b3("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(b3){b0.log(b3);}));else{E.Obsolete(this.snap);this.current=b2;this.snap=E.New({$:2,$0:b2,$1:[]});}},Get:function(){return this.current;},UpdateMaybe:function(b2){var b3;b3=b2(this.Get());if(b3!=null&&b3.$==1)this.Set(b3.$0);},SetFinal:function(b2){if(this.isConst)(function(b3){return b3("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(b3){b0.log(b3);}));else{E.Obsolete(this.snap);this.isConst=true;this.current=b2;this.snap=E.New({$:0,$0:b2});}}},p,D);D.New=bZ.Ctor(function(b2,b3,b4){var b5;b5=this;p.New.call(this);this.isConst=b2;this.current=b4;this.snap=b3;this.view=function(){return b5.snap;};this.id=U.Int();},D);E.WhenRun=function(b2,b3,b4){var b5;b5=b2.s;if(b5==null)b4();else b5!=null&&b5.$==2?(b5.$1.push(b4),b3(b5.$0)):b5!=null&&b5.$==3?(b5.$0.push(b3),b5.$1.push(b4)):b3(b5.$0);};E.Map=function(b2,b3){var b4,b5;b4=b3.s;return b4!=null&&b4.$==0?E.New({$:0,$0:b2(b4.$0)}):(b5=E.New({$:3,$0:[],$1:[]}),(E.When(b3,function(b6){E.MarkDone(b5,b3,b2(b6));},b5),b5));};E.WhenObsoleteRun=function(b2,b3){var b4;b4=b2.s;if(b4==null)b3();else b4!=null&&b4.$==2?b4.$1.push(b3):b4!=null&&b4.$==3?b4.$1.push(b3):void 0;};E.When=function(b2,b3,b4){var b5;b5=b2.s;if(b5==null)E.Obsolete(b4);else b5!=null&&b5.$==2?(E.EnqueueSafe(b5.$1,b4),b3(b5.$0)):b5!=null&&b5.$==3?(b5.$0.push(b3),E.EnqueueSafe(b5.$1,b4)):b3(b5.$0);};E.MarkDone=function(b2,b3,b4){var b5;if(b5=b3.s,b5!=null&&b5.$==0)E.MarkForever(b2,b4);else E.MarkReady(b2,b4);};E.EnqueueSafe=function(b2,b3){var b4,b5,b6,b7;b2.push(b3);if(b2.length%20===0){b4=b2.slice(0);bF.Clear(b2);for(b5=0,b6=n.length(b4)-1;b5<=b6;b5++){b7=n.get(b4,b5);if(typeof b7=="object")(function(b8){if(b8.s)b2.push(b8);}(b7));else(function(b8){b2.push(b8);}(b7));}}else void 0;};E.MarkForever=function(b2,b3){var b4,b5,b6,b7;b4=b2.s;if(b4!=null&&b4.$==3){b2.s={$:0,$0:b3};b5=b4.$0;for(b6=0,b7=n.length(b5)-1;b6<=b7;b6++)(n.get(b5,b6))(b3);}else void 0;};E.MarkReady=function(b2,b3){var b4,b5,b6,b7;b4=b2.s;if(b4!=null&&b4.$==3){b2.s={$:2,$0:b3,$1:b4.$1};b5=b4.$0;for(b6=0,b7=n.length(b5)-1;b6<=b7;b6++)(n.get(b5,b6))(b3);}else void 0;};E.Join=function(b2){var b3;b3=E.New({$:3,$0:[],$1:[]});E.When(b2,function(b4){var b5;b5=b4();E.When(b5,function(b6){var b7,b8;if((b7=b5.s,b7!=null&&b7.$==0)&&(b8=b2.s,b8!=null&&b8.$==0))E.MarkForever(b3,b6);else E.MarkReady(b3,b6);},b3);},b3);return b3;};E.Map2Unit=function(b2,b3){var b4,b5,b6;function b7(){var b8,b9,b_;if(!(b8=b6.s,b8!=null&&b8.$==0||b8!=null&&b8.$==2)){b9=E.ValueAndForever(b2);b_=E.ValueAndForever(b3);if(b9!=null&&b9.$==1)b_!=null&&b_.$==1?b9.$0[1]&&b_.$0[1]?E.MarkForever(b6,null):E.MarkReady(b6,null):void 0;}}b4=b2.s;b5=b3.s;return b4!=null&&b4.$==0?b5!=null&&b5.$==0?E.New({$:0,$0:null}):b3:b5!=null&&b5.$==0?b2:(b6=E.New({$:3,$0:[],$1:[]}),(E.When(b2,b7,b6),E.When(b3,b7,b6),b6));};E.Copy=function(b2){var b3,b4,b5;b3=b2.s;return b3==null?b2:b3!=null&&b3.$==2?(b4=E.New({$:2,$0:b3.$0,$1:[]}),(E.WhenObsolete(b2,b4),b4)):b3!=null&&b3.$==3?(b5=E.New({$:3,$0:[],$1:[]}),(E.When(b2,function(b6){E.MarkDone(b5,b2,b6);},b5),b5)):b2;};E.ValueAndForever=function(b2){var b3;b3=b2.s;return b3!=null&&b3.$==0?{$:1,$0:[b3.$0,true]}:b3!=null&&b3.$==2?{$:1,$0:[b3.$0,false]}:null;};E.Map3=function(b2,b3,b4,b5){var b6,b7,b8,b9;function b_(b$){var ca,cb,cc,cd;if(!(ca=b9.s,ca!=null&&ca.$==0||ca!=null&&ca.$==2)){cb=E.ValueAndForever(b3);cc=E.ValueAndForever(b4);cd=E.ValueAndForever(b5);if(cb!=null&&cb.$==1)cc!=null&&cc.$==1?cd!=null&&cd.$==1?cb.$0[1]&&cc.$0[1]&&cd.$0[1]?E.MarkForever(b9,b2(cb.$0[0],cc.$0[0],cd.$0[0])):E.MarkReady(b9,b2(cb.$0[0],cc.$0[0],cd.$0[0])):void 0:void 0;}}b6=b3.s;b7=b4.s;b8=b5.s;return b6!=null&&b6.$==0?b7!=null&&b7.$==0?b8!=null&&b8.$==0?E.New({$:0,$0:b2(b6.$0,b7.$0,b8.$0)}):E.Map3Opt1(b2,b6.$0,b7.$0,b5):b8!=null&&b8.$==0?E.Map3Opt2(b2,b6.$0,b8.$0,b4):E.Map3Opt3(b2,b6.$0,b4,b5):b7!=null&&b7.$==0?b8!=null&&b8.$==0?E.Map3Opt4(b2,b7.$0,b8.$0,b3):E.Map3Opt5(b2,b7.$0,b3,b5):b8!=null&&b8.$==0?E.Map3Opt6(b2,b8.$0,b3,b4):(b9=E.New({$:3,$0:[],$1:[]}),(E.When(b3,b_,b9),E.When(b4,b_,b9),E.When(b5,b_,b9),b9));};E.Sequence=function(b2){var b3,b4,b5;function b6(b7){var b8;if(b5[0]===0){b8=n.map(function(b9){var b_;b_=b9.s;return b_!=null&&b_.$==0?b_.$0:b_!=null&&b_.$==2?b_.$0:i.FailWith("value not found by View.Sequence");},b3);if(n.forall(function(b9){var b_;b_=b9.s;return b_!=null&&b_.$==0;},b3))E.MarkForever(b4,b8);else E.MarkReady(b4,b8);}else b5[0]=b5[0]-1;}b3=n.ofSeq(b2);return b3.length==0?E.New({$:0,$0:[]}):(b4=E.New({$:3,$0:[],$1:[]}),(b5=[n.length(b3)-1],(n.iter(function(b7){E.When(b7,b6,b4);},b3),b4)));};E.Map2=function(b2,b3,b4){var b5,b6,b7;function b8(b9){var b_,b$,ca;if(!(b_=b7.s,b_!=null&&b_.$==0||b_!=null&&b_.$==2)){b$=E.ValueAndForever(b3);ca=E.ValueAndForever(b4);if(b$!=null&&b$.$==1)ca!=null&&ca.$==1?b$.$0[1]&&ca.$0[1]?E.MarkForever(b7,b2(b$.$0[0],ca.$0[0])):E.MarkReady(b7,b2(b$.$0[0],ca.$0[0])):void 0;}}b5=b3.s;b6=b4.s;return b5!=null&&b5.$==0?b6!=null&&b6.$==0?E.New({$:0,$0:b2(b5.$0,b6.$0)}):E.Map2Opt1(b2,b5.$0,b4):b6!=null&&b6.$==0?E.Map2Opt2(b2,b6.$0,b3):(b7=E.New({$:3,$0:[],$1:[]}),(E.When(b3,b8,b7),E.When(b4,b8,b7),b7));};E.WhenObsolete=function(b2,b3){var b4;b4=b2.s;if(b4==null)E.Obsolete(b3);else b4!=null&&b4.$==2?E.EnqueueSafe(b4.$1,b3):b4!=null&&b4.$==3?E.EnqueueSafe(b4.$1,b3):void 0;};E.Map3Opt1=function(b2,b3,b4,b5){return E.Map(function(b6){return b2(b3,b4,b6);},b5);};E.Map3Opt2=function(b2,b3,b4,b5){return E.Map(function(b6){return b2(b3,b6,b4);},b5);};E.Map3Opt3=function(b2,b3,b4,b5){return E.Map2(function(b6,b7){return b2(b3,b6,b7);},b4,b5);};E.Map3Opt4=function(b2,b3,b4,b5){return E.Map(function(b6){return b2(b6,b3,b4);},b5);};E.Map3Opt5=function(b2,b3,b4,b5){return E.Map2(function(b6,b7){return b2(b6,b3,b7);},b4,b5);};E.Map3Opt6=function(b2,b3,b4,b5){return E.Map2(function(b6,b7){return b2(b6,b7,b3);},b4,b5);};E.Map2Opt1=function(b2,b3,b4){return E.Map(function(b5){return b2(b3,b5);},b4);};E.Map2Opt2=function(b2,b3,b4){return E.Map(function(b5){return b2(b5,b3);},b4);};F=f.AttrProxy=bZ.Class({},null,F);F.Concat=function(b2){var b3;b3=W.ofSeqNonCopying(b2);return W.TreeReduce(X.EmptyAttr(),F.Append,b3);};F.Append=function(b2,b3){return X.AppendTree(b2,b3);};F.Create=function(b2,b3){return X.Static(function(b4){b4.setAttribute(b2,b3);});};F.Handler=function(b2,b3){return F.HandlerImpl(b2,b3);};F.HandlerImpl=function(b2,b3){return X.Static(function(b4){b4.addEventListener(b2,function(b5){return(b3(b4))(b5);},false);});};H.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(b2){var b3,b4;b3=bY.random()*16|0;b4=b2=="x"?b3:b3&3|8;return b4.toString(16);});};I.DynamicCustom=function(b2,b3){return X.Dynamic(b3,b2);};I.OnAfterRender=function(b2){return new F({$:4,$0:b2});};I.Handler=function(b2,b3){return X.Static(function(b4){b4.addEventListener(b2,function(b5){return(b3(b4))(b5);},false);});};I.Value=function(b2){return I.ValueWith(br.StringApply(),b2);};I.Checked=function(b2){return I.ValueWith(br.BoolCheckedApply(),b2);};I.DateTimeValue=function(b2){return I.ValueWith(br.DateTimeApplyUnchecked(),b2);};I.FileValue=function(b2){return I.ValueWith(br.FileApplyUnchecked(),b2);};I.IntValue=function(b2){return I.ValueWith(br.IntApplyChecked(),b2);};I.IntValueUnchecked=function(b2){return I.ValueWith(br.IntApplyUnchecked(),b2);};I.FloatValue=function(b2){return I.ValueWith(br.FloatApplyChecked(),b2);};I.FloatValueUnchecked=function(b2){return I.ValueWith(br.FloatApplyUnchecked(),b2);};I.Dynamic=function(b2,b3){return X.Dynamic(b3,function(b4){return function(b5){return b4.setAttribute(b2,b5);};});};I.ValueWith=function(b2,b3){var b4;b4=b2(b3);return F.Append(X.Static(b4[0]),I.DynamicCustom(b4[1],b4[2]));};J.$cctor=function(){J.$cctor=a.ignore;J.WIDTH=600;J.HEIGHT=600;J.animationHandle=g.Create$1(null);J.scoringValues=Z.OfArray(n.ofSeq(h.groupBy(z.AsScore,h.ofSeq(Y.delay(function(){return Y.append(Y.collect(function(b2){return Y.append([{$:0,$0:b2}],Y.delay(function(){return Y.append([{$:1,$0:b2}],Y.delay(function(){return[{$:2,$0:b2}];}));}));},i.range(1,20)),Y.delay(function(){return Y.append([{$:2,$0:25}],Y.delay(function(){return Y.append([{$:1,$0:25}],Y.delay(function(){return[z.Nil];}));}));}));})))));J.dartRingNumbers=h.ofArray([20,1,18,4,13,6,10,15,2,17,3,19,7,16,8,11,14,9,12,5]);};M=L.FSharpMap=bZ.Class({get_Keys:function(){return bZ.MarkResizable(n.ofSeq(Y.map(function(b2){return b2.Key;},_3.Enumerate(false,this.get_Tree()))));},ContainsKey:function(b2){return _3.Contains(_2.New(b2,void 0),this.tree);},TryGetValue:function(b2,b3){var b4;b4=this.TryFind(b2);return b4!=null&&b4.$==1&&(b3.set(b4.$0),true);},get_Tree:function(){return this.tree;},TryFind:function(b2){var b3;b3=_3.TryFind(_2.New(b2,void 0),this.tree);return b3==null?null:{$:1,$0:b3.$0.Value};},GetEnumerator:function(){return _4.Get(Y.map(function(b2){return{K:b2.Key,V:b2.Value};},_3.Enumerate(false,this.tree)));},Equals:function(b2){return this.Count()===b2.Count()&&Y.forall2(w.Equals,this,b2);},Count:function(){var b2;b2=this.tree;return b2==null?0:b2.Count;},GetHashCode:function(){return w.Hash(n.ofSeq(this));},CompareTo0:function(b2){return Y.compareWith(w.Compare,this,b2);}},e,M);M.New$1=bZ.Ctor(function(b2){e.New.call(this);this.tree=b2;},M);O=d.MatchFailureException=bZ.Class({},N,O);O.New=bZ.Ctor(function(b2,b3,b4){this.message=b2+" at "+a.String(b3)+":"+a.String(b4);_1.setPrototypeOf(this,O.prototype);},O);P=f.Doc=bZ.Class({},e,P);P.BindView=function(b2,b3){return P.EmbedView(q.Map(b2,b3));};P.Select=function(b2,b3,b4,b5){return P.SelectImpl(b2,b3,function(b6){b6[0]=b4;return P.Concat(h.mapi(function(b7,b8){return P.Element("option",h.ofArray([F.Create("value",a.String(b7))]),h.ofArray([P.TextNode(b3(b8))]));},b4));},b5);};P.RunById=function(b2,b3){var b4;b4=self.document.getElementById(b2);if(w.Equals(b4,null))i.FailWith("invalid id: "+b2);else P.Run(b4,b3);};P.EmbedView=function(b2){var b3;b3=ba.CreateEmbedNode();return P.Mk({$:2,$0:b3},q.Map(a.ignore,q.Bind(function(b4){ba.UpdateEmbedNode(b3,b4.docNode);return b4.updates;},b2)));};P.SelectImpl=function(b2,b3,b4,b5){var b6,b7,b8,b9;function b_(cd){return cd.selectedIndex;}function b$(cd,ce){cd.selectedIndex=ce;}function ca(cd){var ce;ce=b_(cd);return b6[0].get_Item(ce);}function cb(cd){return Y.findIndex(function(ce){return w.Equals(cd,ce);},b6[0]);}function cc(cd,ce){return b$(cd,cb(ce));}b6=[B.Empty];b7=self.document.createElement("select");b8=I.DynamicCustom(function(cd){return function(ce){return cc(cd,ce);};},b5.get_View());b7.addEventListener("change",function(){b5.UpdateMaybe(function(cd){var ce;ce=ca(b7);return w.Equals(cd,ce)?null:{$:1,$0:ce};});},false);return bi.New(b7,(b9=F.Append(b8,F.Concat(b2)),F.Append(I.OnAfterRender(function(cd){cc(cd,b5.Get());}),b9)),b4(b6));};P.Element=function(b2,b3,b4){var b5,b6;b5=F.Concat(b3);b6=P.Concat(b4);return bi.New(self.document.createElement(b2),b5,b6);};P.TextNode=function(b2){return P.Mk({$:5,$0:self.document.createTextNode(b2)},q.Const());};P.Concat=function(b2){var b3;b3=W.ofSeqNonCopying(b2);return W.TreeReduce(P.get_Empty(),P.Append,b3);};P.Run=function(b2,b3){ba.LinkElement(b2,b3.docNode);P.RunInPlace(false,b2,b3);};P.Mk=function(b2,b3){return new P.New(b2,b3);};P.Append=function(b2,b3){return P.Mk({$:0,$0:b2.docNode,$1:b3.docNode},q.Map2Unit(b2.updates,b3.updates));};P.get_Empty=function(){return P.Mk(null,q.Const());};P.RunInPlace=function(b2,b3,b4){var b5;b5=ba.CreateRunState(b3,b4.docNode);q.Sink(bm.get_UseAnimations()||bn.BatchUpdatesEnabled()?bo.StartProcessor(ba.PerformAnimatedUpdate(b2,b5,b4.docNode)):function(){ba.PerformSyncUpdate(b2,b5,b4.docNode);},b4.updates);};P.TextView=function(b2){var b3;b3=ba.CreateTextNode();return P.Mk({$:4,$0:b3},q.Map(function(b4){ba.UpdateTextNode(b3,b4);},b2));};P.New=bZ.Ctor(function(b2,b3){e.New.call(this);this.docNode=b2;this.updates=b3;},P);Q.toSafe=function(b2){return b2==null?"":b2;};S.LoadLocalTemplates=function(b2){!S.LocalTemplatesLoaded()?(S.set_LocalTemplatesLoaded(true),S.LoadNestedTemplates(self.document.body,"")):void 0;S.LoadedTemplates().set_Item(b2,S.LoadedTemplateFile(""));};S.NamedTemplate=function(b2,b3,b4){var b5,b6;b5=(b6=null,[S.LoadedTemplateFile(b2).TryGetValue(b3==null?"":b3.$0,{get:function(){return b6;},set:function(b7){b6=b7;}}),b6]);return b5[0]?S.ChildrenTemplate(b5[1].cloneNode(true),b4):(b0.warn("Local template doesn't exist",b3),P.get_Empty());};S.LocalTemplatesLoaded=function(){bd.$cctor();return bd.LocalTemplatesLoaded;};S.set_LocalTemplatesLoaded=function(b2){bd.$cctor();bd.LocalTemplatesLoaded=b2;};S.LoadNestedTemplates=function(b2,b3){var b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn;function b4(co){var cp,cq;if(!b5.ContainsKey(co)){cp=(cq=null,[b6.TryGetValue(co,{get:function(){return cq;},set:function(cr){cq=cr;}}),cq]);if(cp[0]){cn.SAdd(co);b6.RemoveKey(co);S.PrepareTemplateStrict(b3,{$:1,$0:co},cp[1],{$:1,$0:b4});}else b0.warn(cn.Contains(co)?"Encountered loop when instantiating "+co:"Local template does not exist: "+co);}}b5=S.LoadedTemplateFile(b3);b6=new V.New$5();b7=b2.querySelectorAll("[ws-template]");for(b8=0,b9=b7.length-1;b8<=b9;b8++){b_=b7[b8];b$=b_.getAttribute("ws-template").toLowerCase();b_.removeAttribute("ws-template");b6.set_Item(b$,S.FakeRootSingle(b_));}ca=b2.querySelectorAll("[ws-children-template]");for(cb=0,cc=ca.length-1;cb<=cc;cb++){cd=ca[cb];ce=cd.getAttribute("ws-children-template").toLowerCase();cd.removeAttribute("ws-children-template");b6.set_Item(ce,S.FakeRoot(cd));}cf=b2.querySelectorAll("template[id]");for(cg=0,ch=cf.length-1;cg<=ch;cg++){ci=cf[cg];b6.set_Item(ci.getAttribute("id").toLowerCase(),S.FakeRootFromHTMLTemplate(ci));}cj=b2.querySelectorAll("template[name]");for(ck=0,cl=cj.length-1;ck<=cl;ck++){cm=cj[ck];b6.set_Item(cm.getAttribute("name").toLowerCase(),S.FakeRootFromHTMLTemplate(cm));}cn=new _5.New$3();while(b6.count>0)b4(Y.head(b6.Keys()));};S.LoadedTemplates=function(){bd.$cctor();return bd.LoadedTemplates;};S.LoadedTemplateFile=function(b2){var b3,b4,b5;b3=(b4=null,[S.LoadedTemplates().TryGetValue(b2,{get:function(){return b4;},set:function(b6){b4=b6;}}),b4]);return b3[0]?b3[1]:(b5=new V.New$5(),(S.LoadedTemplates().set_Item(b2,b5),b5));};S.ChildrenTemplate=function(b2,b3){var b4,b5,b6,b7,b8;b4=S.InlineTemplate(b2,Y.append(b3,S.GlobalHoles().Values()));b5=b4[1];b6=b4[0];b7=b6.Els;return!w.Equals(b7,null)&&b7.length===1&&(n.get(b7,0)instanceof u&&(w.Equals(n.get(b7,0).nodeType,u.ELEMENT_NODE)&&(b8=n.get(b7,0),true)))?bi.TreeNode(b6,b5):P.Mk({$:6,$0:b6},b5);};S.FakeRootSingle=function(b2){var b3,b4,b5,b6;b2.removeAttribute("ws-template");b3=b2.getAttribute("ws-replace");if(b3===null);else{b2.removeAttribute("ws-replace");b4=b2.parentNode;w.Equals(b4,null)?void 0:(b5=self.document.createElement(b2.tagName),b5.setAttribute("ws-replace",b3),b4.replaceChild(b5,b2));}b6=self.document.createElement("div");b6.appendChild(b2);return b6;};S.FakeRoot=function(b2){var b3;b3=self.document.createElement("div");while(b2.hasChildNodes())b3.appendChild(b2.firstChild);return b3;};S.FakeRootFromHTMLTemplate=function(b2){var b3,b4,b5,b6;b3=self.document.createElement("div");b4=b2.content;for(b5=0,b6=b4.childNodes.length-1;b5<=b6;b5++)b3.appendChild(b4.childNodes[b5].cloneNode(true));return b3;};S.PrepareTemplateStrict=function(b2,b3,b4,b5){var b6,b7;function b8(cc,cd){var ce,cf,cg,ch,ci,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE;function cj(cF){}while(true)switch(cc){case 0:if(cd!==null){ce=cd.nextSibling;if(w.Equals(cd.nodeType,u.TEXT_NODE))bj.convertTextNode(cd);else if(w.Equals(cd.nodeType,u.ELEMENT_NODE))b_(cd);cd=ce;}else return null;break;case 1:ck=bk.string(cd.nodeName,{$:1,$0:3},null).toLowerCase();cl=(cf=ck.indexOf("."),cf===-1?[b2,ck]:[bk.string(ck,null,{$:1,$0:cf-1}),bk.string(ck,{$:1,$0:cf+1},null)]);cm=cl[1];cn=cl[0];if(cn!==""&&!S.LoadedTemplates().ContainsKey(cn))return bj.failNotLoaded(cm);else{if(cn===""&&b5!=null)b5.$0(cm);co=S.LoadedTemplates().Item(cn);if(!co.ContainsKey(cm))return bj.failNotLoaded(cm);else{cp=co.Item(cm);cq=cp.cloneNode(true);cr=new _5.New$3();cs=new V.New$5();ct=cd.attributes;for(cu=0,cv=ct.length-1;cu<=cv;cu++){cw=ct.item(cu).name.toLowerCase();cs.set_Item(cw,(cx=ct.item(cu).nodeValue,cx===""?cw:cx.toLowerCase()));if(!cr.SAdd(cw))b0.warn("Hole mapped twice",cw);}for(cy=0,cz=cd.childNodes.length-1;cy<=cz;cy++){cA=cd.childNodes[cy];if(w.Equals(cA.nodeType,u.ELEMENT_NODE))!cr.SAdd(cA.nodeName.toLowerCase())?b0.warn("Hole filled twice",cm):void 0;}cB=cd.childNodes.length===1&&w.Equals(cd.firstChild.nodeType,u.TEXT_NODE);if(cB){ch=bj.fillTextHole(cq,cd.firstChild.textContent,cm);((function(cF){return function(cG){if(cG!=null)cF(cG.$0);};}((ci=function(cF){return function(cG){return cF.SAdd(cG);};}(cr),function(cF){return cj(ci(cF));})))(ch));}bj.removeHolesExcept(cq,cr);if(!cB){for(cC=0,cD=cd.childNodes.length-1;cC<=cD;cC++){cE=cd.childNodes[cC];if(w.Equals(cE.nodeType,u.ELEMENT_NODE))cE.hasAttributes()?bj.fillInstanceAttrs(cq,cE):b9(cq,cE);}}bj.mapHoles(cq,cs);bj.fill(cq,cd.parentNode,cd);cd.parentNode.removeChild(cd);return;}}break;}}function b9(cc,cd){var ce,cf,ch,ci;function cg(cj,ck){var cl;if(ch==="title"&&cd.hasChildNodes()){cl=bb.ParseHTMLIntoFakeRoot(cd.textContent);cd.removeChild(cd.firstChild);while(cl.hasChildNodes())cd.appendChild(cl.firstChild);}else null;b_(cd);return bj.fill(cd,cj,ck);}ch=cd.nodeName.toLowerCase();S.foreachNotPreserved(cc,"[ws-attr-holes]",function(cj){var ck,cl,cm,cn,co;ck=bu.SplitChars(cj.getAttribute("ws-attr-holes"),[" "],1);for(cl=0,cm=ck.length-1;cl<=cm;cl++){cn=n.get(ck,cl);cj.setAttribute(cn,(co=new a.RegExp("\\${"+ch+"}","ig"),cj.getAttribute(cn).replace(co,cd.textContent)));}});ci=cc.querySelector("[ws-hole="+ch+"]");if(w.Equals(ci,null)){ce=cc.querySelector("[ws-replace="+ch+"]");return w.Equals(ce,null)?(cf=cc.querySelector("slot[name="+ch+"]"),cc.tagName.toLowerCase()==="template"?(cg(cf.parentNode,cf),void cf.parentNode.removeChild(cf)):null):(cg(ce.parentNode,ce),void ce.parentNode.removeChild(ce));}else{while(ci.hasChildNodes())ci.removeChild(ci.lastChild);ci.removeAttribute("ws-hole");return cg(ci,null);}}function b_(cc){if(!cc.hasAttribute("ws-preserve"))if(bu.StartsWith(cc.nodeName.toLowerCase(),"ws-"))ca(cc);else{bj.convertAttrs(cc);b$(cc.firstChild);}}function b$(cc){return b8(0,cc);}function ca(cc){return b8(1,cc);}function cb(cc){var cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co;while(true){cd=cc.querySelector("[ws-template]");if(w.Equals(cd,null)){ce=cc.querySelector("[ws-children-template]");if(w.Equals(ce,null)){cf=cc.querySelectorAll("template[id]");for(cg=1,ch=cf.length-1;cg<=ch;cg++){ci=cf[cg];if(b6.Contains(ci));else{S.PrepareTemplateStrict(b2,{$:1,$0:ci.getAttribute("id")},ci,null);b6.SAdd(ci);}}cj=cc.querySelectorAll("template[name]");for(ck=1,cl=cj.length-1;ck<=cl;ck++){cm=cj[ck];if(b6.Contains(cm));else{S.PrepareTemplateStrict(b2,{$:1,$0:cm.getAttribute("name")},cm,null);b6.SAdd(cm);}}return null;}else{cn=ce.getAttribute("ws-children-template");ce.removeAttribute("ws-children-template");S.PrepareTemplateStrict(b2,{$:1,$0:cn},ce,null);cc=cc;}}else{co=cd.getAttribute("ws-template");(S.PrepareSingleTemplate(b2,{$:1,$0:co},cd))(null);cc=cc;}}}b6=new _5.New$3();b7=(b3==null?"":b3.$0).toLowerCase();S.LoadedTemplateFile(b2).set_Item(b7,b4);if(b4.hasChildNodes()){cb(b4);b$(b4.firstChild);}};S.InlineTemplate=function(b2,b3){var b4,b5,b6,b7,b8,ca,cb,cc,cd,ce,cf,cg;function b9(ch,ci){var cj,ck,cl;cj=X.Insert(ch,ci);cb.push(X.Updates(cj));cc.push([ch,cj]);ck=bZ.GetOptional(cj.OnAfterRender);return ck==null?null:(cl=ck.$0,void cd.push(function(){cl(ch);}));}function b_(ch){var ci,cj;ci=(cj=null,[ce.TryGetValue(ch,{get:function(){return cj;},set:function(ck){cj=ck;}}),cj]);return ci[0]?ci[1].$==0?{$:1,$0:ci[1].$1}:ci[1].$==1?{$:1,$0:P.TextNode(ci[1].$1)}:ci[1].$==2?{$:1,$0:P.TextView(ci[1].$1)}:ci[1].$==10?{$:1,$0:P.TextView(ci[1].$1.get_View())}:ci[1].$==11?{$:1,$0:P.TextView(q.Map(a.String,ci[1].$1.get_View()))}:ci[1].$==12?{$:1,$0:P.TextView(q.Map(function(ck){return(new a.Date(ck)).toLocaleString();},ci[1].$1.get_View()))}:ci[1].$==13?{$:1,$0:P.TextView(q.Map(a.String,ci[1].$1.get_View()))}:ci[1].$==15?{$:1,$0:P.TextView(q.Map(function(ck){return ck.get_Input();},ci[1].$1.get_View()))}:ci[1].$==16?{$:1,$0:P.TextView(q.Map(a.String,ci[1].$1.get_View()))}:ci[1].$==17?{$:1,$0:P.TextView(q.Map(function(ck){return ck.get_Input();},ci[1].$1.get_View()))}:ci[1].$==18?{$:1,$0:P.TextView(q.Map(a.String,ci[1].$1.get_View()))}:(b0.warn("Content hole filled with attribute data",ch),null):null;}function b$(){S.foreachNotPreservedwsDOM("[ws-dom]",function(ch){var ci,cj,ck,cl,cm,cn;ci=(cj=null,[ce.TryGetValue(ch.getAttribute("ws-dom").toLowerCase(),{get:function(){return cj;},set:function(co){cj=co;}}),cj]);if(ci[0])ci[1].$==14?(ck=ci[1].$1,ch.removeAttribute("ws-dom"),cl=ch,cm=new a.MutationObserver(function(co,cp){n.iter(function(cq){function cr(cs,ct,cu,cv){if(cs===cl&&cq.addedNodes.length!==1){ck.SetFinal(null);cp.disconnect();}}cq.removedNodes.forEach(bZ.CreateFuncWithArgs(function(cs){return cr(cs[0],cs[1],cs[2],cs[3]);}),null);},co);}),ch.parentElement!==null?cm.observe(ch.parentElement,(cn={},cn.childList=true,cn)):void 0,ck.Set({$:1,$0:ch}),q.Sink(function(co){var cp;if(co!=null&&co.$==1){cp=co.$0;if(cl===cp);else{cl.replaceWith.apply(cl,[cp]);cl=cp;}}else{cl.remove();cm.disconnect();}},ck.get_View())):void 0;});}ca=[];cb=[];cc=[];cd=[];ce=new V.New$5();cf=_4.Get(b3);try{while(cf.MoveNext()){cg=cf.Current();ce.set_Item(cg.$0,cg);}}finally{if(typeof cf=="object"&&"Dispose"in cf)cf.Dispose();}b4=bb.ChildrenArray(b2);S.foreachNotPreserved(b2,"[ws-hole]",function(ch){var ci,cj,ck;ck=ch.getAttribute("ws-hole");ch.removeAttribute("ws-hole");while(ch.hasChildNodes())ch.removeChild(ch.lastChild);ci=b_(ck);if(ci!=null&&ci.$==1){cj=ci.$0;ba.LinkElement(ch,cj.docNode);ca.push(bf.New(X.Empty(ch),cj.docNode,null,ch,U.Int(),null));cb.push(cj.updates);}});S.foreachNotPreserved(b2,"[ws-replace]",function(ch){var ci,cj,ck,cl,cm,cn;ci=b_(ch.getAttribute("ws-replace"));if(ci!=null&&ci.$==1){cj=ci.$0;ck=ch.parentNode;cl=self.document.createTextNode("");ck.replaceChild(cl,ch);cm=ba.InsertBeforeDelim(cl,cj.docNode);cn=n.tryFindIndex(function(co){return ch===co;},b4);cn==null?void 0:n.set(b4,cn.$0,cj.docNode);ca.push(bf.New(X.Empty(ck),cj.docNode,{$:1,$0:[cm,cl]},ck,U.Int(),null));cb.push(cj.updates);}});b5=false;S.foreachNotPreserved(b2,"slot",function(ch){var ci,cj,ck,cl;ck=ch.getAttribute("name");cl=ck===""||ck===null?"default":ck.toLowerCase();if(b5&&cl==="default"||!w.Equals(b2.parentElement,null))void 0;else{while(ch.hasChildNodes())ch.removeChild(ch.lastChild);if(cl==="default")b5=true;ci=b_(cl);if(ci!=null&&ci.$==1){cj=ci.$0;ba.LinkElement(ch,cj.docNode);ca.push(bf.New(X.Empty(ch),cj.docNode,null,ch,U.Int(),null));cb.push(cj.updates);}}});S.foreachNotPreserved(b2,"[ws-attr]",function(ch){var ci,cj,ck;ci=ch.getAttribute("ws-attr");ch.removeAttribute("ws-attr");cj=(ck=null,[ce.TryGetValue(ci,{get:function(){return ck;},set:function(cl){ck=cl;}}),ck]);if(cj[0])cj[1].$==3?b9(ch,cj[1].$1):b0.warn("Attribute hole filled with non-attribute data",ci);});S.foreachNotPreserved(b2,"[ws-on]",function(ch){b9(ch,F.Concat(n.choose(function(ci){var cj,ck,cl;cj=bu.SplitChars(ci,[":"],1);ck=(cl=null,[ce.TryGetValue(n.get(cj,1),{get:function(){return cl;},set:function(cm){cl=cm;}}),cl]);return ck[0]?ck[1].$==4?{$:1,$0:I.Handler(n.get(cj,0),ck[1].$1)}:ck[1].$==5?{$:1,$0:F.Handler(n.get(cj,0),ck[1].$1)}:(b0.warn("Event hole on"+n.get(cj,0)+" filled with non-event data",n.get(cj,1)),null):null;},bu.SplitChars(ch.getAttribute("ws-on"),[" "],1))));ch.removeAttribute("ws-on");});S.foreachNotPreserved(b2,"[ws-onafterrender]",function(ch){var ci,cj,ck;ci=ch.getAttribute("ws-onafterrender");cj=(ck=null,[ce.TryGetValue(ci,{get:function(){return ck;},set:function(cl){ck=cl;}}),ck]);if(cj[0])cj[1].$==7?(ch.removeAttribute("ws-onafterrender"),b9(ch,I.OnAfterRender(cj[1].$1))):cj[1].$==8?(ch.removeAttribute("ws-onafterrender"),b9(ch,I.OnAfterRender(cj[1].$1))):b0.warn("onafterrender hole filled with non-onafterrender data",ci);});S.foreachNotPreserved(b2,"[ws-var]",function(ch){var ci,cj,ck;ci=ch.getAttribute("ws-var");ch.removeAttribute("ws-var");cj=(ck=null,[ce.TryGetValue(ci,{get:function(){return ck;},set:function(cl){ck=cl;}}),ck]);if(cj[0])cj[1].$==10?b9(ch,I.Value(cj[1].$1)):cj[1].$==11?b9(ch,I.Checked(cj[1].$1)):cj[1].$==12?b9(ch,I.DateTimeValue(cj[1].$1)):cj[1].$==13?b9(ch,I.FileValue(cj[1].$1)):cj[1].$==15?b9(ch,I.IntValue(cj[1].$1)):cj[1].$==16?b9(ch,I.IntValueUnchecked(cj[1].$1)):cj[1].$==17?b9(ch,I.FloatValue(cj[1].$1)):cj[1].$==18?b9(ch,I.FloatValueUnchecked(cj[1].$1)):b0.warn("Var hole filled with non-Var data",ci);});S.foreachNotPreserved(b2,"[ws-attr-holes]",function(ch){var ci,cj,ck,cl;ci=new a.RegExp(S.TextHoleRE(),"g");cj=bu.SplitChars(ch.getAttribute("ws-attr-holes"),[" "],1);ch.removeAttribute("ws-attr-holes");for(ck=0,cl=cj.length-1;ck<=cl;ck++)(function(){var cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy;cv=n.get(cj,ck);cw=ch.getAttribute(cv);cm=null;cn=0;cx=[];while(cm=ci.exec(cw),cm!==null){cy=bk.string(cw,{$:1,$0:cn},{$:1,$0:ci.lastIndex-n.get(cm,0).length-1});cn=ci.lastIndex;cx.push([cy,n.get(cm,1)]);}cp=bk.string(cw,{$:1,$0:cn},null);ci.lastIndex=0;cq=n.foldBack(function(cz,cA){return(function(cB){var cC,cD;cC=cB[0];cD=cB[1];return function(cE){var cF,cG,cH,cI,cJ;cF=cE[0];cG=cE[1];cH=(cI=(cJ=null,[ce.TryGetValue(cD,{get:function(){return cJ;},set:function(cK){cJ=cK;}}),cJ]),cI[0]?cI[1].$==1?{$:0,$0:cI[1].$1}:cI[1].$==2?{$:1,$0:cI[1].$1}:cI[1].$==10?{$:1,$0:cI[1].$1.get_View()}:cI[1].$==11?{$:1,$0:q.Map(a.String,cI[1].$1.get_View())}:cI[1].$==12?{$:1,$0:q.Map(function(cK){return(new a.Date(cK)).toLocaleString();},cI[1].$1.get_View())}:cI[1].$==13?{$:1,$0:q.Map(a.String,cI[1].$1.get_View())}:cI[1].$==15?{$:1,$0:q.Map(function(cK){return cK.get_Input();},cI[1].$1.get_View())}:cI[1].$==16?{$:1,$0:q.Map(a.String,cI[1].$1.get_View())}:cI[1].$==17?{$:1,$0:q.Map(function(cK){return cK.get_Input();},cI[1].$1.get_View())}:cI[1].$==18?{$:1,$0:q.Map(a.String,cI[1].$1.get_View())}:(b0.warn("Attribute value hole filled with non-text data",cD),{$:0,$0:""}):{$:0,$0:""});return cH.$==1?[cC,new B({$:1,$0:cF===""?cH.$0:q.Map(function(cK){return cK+cF;},cH.$0),$1:cG})]:[cC+cH.$0+cF,cG];};}(cz))(cA);},cx,[cp,B.Empty]);return b9(ch,cq[1].$==1?cq[1].$1.$==1?cq[1].$1.$1.$==1?cq[1].$1.$1.$1.$==0?(cr=cq[0],I.Dynamic(cv,q.Map3(function(cz,cA,cB){return cr+cz+cA+cB;},cq[1].$0,cq[1].$1.$0,cq[1].$1.$1.$0))):(cs=cq[0],I.Dynamic(cv,q.Map(function(cz){return cs+bu.concat("",cz);},q.Sequence(cq[1])))):(ct=cq[0],I.Dynamic(cv,q.Map2(function(cz,cA){return ct+cz+cA;},cq[1].$0,cq[1].$1.$0))):cq[0]===""?I.Dynamic(cv,cq[1].$0):(cu=cq[0],I.Dynamic(cv,q.Map(function(cz){return cu+cz;},cq[1].$0))):F.Create(cv,cq[0]));}());});return[bZ.DeleteEmptyFields({Els:b4,Dirty:true,Holes:ca,Attrs:cc,Render:(b6=cd.length==0?{$:1,$0:function(){b$();}}:{$:1,$0:function(ch){b$();n.iter(function(ci){ci(ch);},cd);}},b6?b6.$0:void 0),El:(b7=!w.Equals(b4,null)&&b4.length===1&&(n.get(b4,0)instanceof u&&(n.get(b4,0)instanceof x&&(b8=n.get(b4,0),true)))?{$:1,$0:b8}:null,b7?b7.$0:void 0)},["Render","El"]),W.TreeReduce(q.Const(),q.Map2Unit,cb)];};S.GlobalHoles=function(){bd.$cctor();return bd.GlobalHoles;};S.foreachNotPreserved=function(b2,b3,b4){bb.IterSelector(b2,b3,function(b5){if(b5.closest("[ws-preserve]")==null)b4(b5);});};S.PrepareSingleTemplate=function(b2,b3,b4){var b5;b5=S.FakeRootSingle(b4);return function(b6){S.PrepareTemplateStrict(b2,b3,b5,b6);};};S.foreachNotPreservedwsDOM=function(b2,b3){bb.IterSelectorDoc(b2,function(b4){if(b4.closest("[ws-preserve]")==null)b3(b4);});};S.TextHoleRE=function(){bd.$cctor();return bd.TextHoleRE;};U.Int=function(){U.set_counter(U.counter()+1);return U.counter();};U.set_counter=function(b2){be.$cctor();be.counter=b2;};U.counter=function(){be.$cctor();return be.counter;};V=L.Dictionary=bZ.Class({set_Item:function(b2,b3){this.set(b2,b3);},set:function(b2,b3){var b4,b5,b6,b7;b4=this;b5=this.hash(b2);b6=this.data[b5];if(b6==null){this.count=this.count+1;this.data[b5]=new a.Array({K:b2,V:b3});}else{b7=n.tryFindIndex(function(b8){return b4.equals.apply(null,[(i.KeyValue(b8))[0],b2]);},b6);b7==null?(this.count=this.count+1,b6.push({K:b2,V:b3})):b6[b7.$0]={K:b2,V:b3};}},TryGetValue:function(b2,b3){var b4,b5,b6;b4=this;b5=this.data[this.hash(b2)];return b5==null?false:(b6=n.tryPick(function(b7){var b8;b8=i.KeyValue(b7);return b4.equals.apply(null,[b8[0],b2])?{$:1,$0:b8[1]}:null;},b5),b6!=null&&b6.$==1&&(b3.set(b6.$0),true));},ContainsKey:function(b2){var b3,b4;b3=this;b4=this.data[this.hash(b2)];return b4==null?false:n.exists(function(b5){return b3.equals.apply(null,[(i.KeyValue(b5))[0],b2]);},b4);},RemoveKey:function(b2){return this.remove(b2);},Keys:function(){return new bl.New(this);},GetEnumerator:function(){return _4.Get0(n.concat(s.GetFieldValues(this.data)));},Item:function(b2){return this.get(b2);},DAdd:function(b2,b3){this.add(b2,b3);},Values:function(){return new bv.New(this);},remove:function(b2){var b3,b4,b5,b6;b3=this;b4=this.hash(b2);b5=this.data[b4];return b5==null?false:(b6=n.filter(function(b7){return!b3.equals.apply(null,[(i.KeyValue(b7))[0],b2]);},b5),n.length(b6)<b5.length&&(this.count=this.count-1,this.data[b4]=b6,true));},get:function(b2){var b3,b4;b3=this;b4=this.data[this.hash(b2)];return b4==null?bc.notPresent():n.pick(function(b5){var b6;b6=i.KeyValue(b5);return b3.equals.apply(null,[b6[0],b2])?{$:1,$0:b6[1]}:null;},b4);},add:function(b2,b3){var b4,b5,b6;b4=this;b5=this.hash(b2);b6=this.data[b5];if(b6==null){this.count=this.count+1;this.data[b5]=new a.Array({K:b2,V:b3});}else{n.exists(function(b7){return b4.equals.apply(null,[(i.KeyValue(b7))[0],b2]);},b6)?bc.alreadyAdded():void 0;this.count=this.count+1;b6.push({K:b2,V:b3});}}},e,V);V.New$5=bZ.Ctor(function(){V.New$6.call(this,[],w.Equals,w.Hash);},V);V.New$6=bZ.Ctor(function(b2,b3,b4){var b5,b6;e.New.call(this);this.equals=b3;this.hash=b4;this.count=0;this.data=[];b5=_4.Get(b2);try{while(b5.MoveNext()){b6=b5.Current();this.set(b6.K,b6.V);}}finally{if(typeof b5=="object"&&"Dispose"in b5)b5.Dispose();}},V);W.ofSeqNonCopying=function(b2){var b3,b4;if(b2 instanceof a.Array)return b2;else if(b2 instanceof B)return n.ofList(b2);else if(b2===null)return[];else{b3=[];b4=_4.Get(b2);try{while(b4.MoveNext())b3.push(b4.Current());return b3;}finally{if(typeof b4=="object"&&"Dispose"in b4)b4.Dispose();}}};W.TreeReduce=function(b2,b3,b4){var b5;function b6(b7){return function(b8){var b9,b_;switch(b8<=0?0:b8===1?b7>=0&&b7<b5?1:(b9=b8,2):(b9=b8,2)){case 0:return b2;case 1:return n.get(b4,b7);case 2:b_=b8/2>>0;return b3((b6(b7))(b_),(b6(b7+b_))(b8-b_));}};}b5=n.length(b4);return(b6(0))(b5);};W.MapTreeReduce=function(b2,b3,b4,b5){var b6;function b7(b8){return function(b9){var b_,b$;switch(b9<=0?0:b9===1?b8>=0&&b8<b6?1:(b_=b9,2):(b_=b9,2)){case 0:return b3;case 1:return b2(n.get(b5,b8));case 2:b$=b9/2>>0;return b4((b7(b8))(b$),(b7(b8+b$))(b9-b$));}};}b6=n.length(b5);return(b7(0))(b6);};X.Dynamic=function(b2,b3){return new F({$:1,$0:new _.New(b2,b3)});};X.AppendTree=function(b2,b3){var b4;return b2===null?b3:b3===null?b2:(b4=new F({$:2,$0:b2,$1:b3}),(X.SetFlags(b4,X.Flags(b2)|X.Flags(b3)),b4));};X.EmptyAttr=function(){bh.$cctor();return bh.EmptyAttr;};X.Static=function(b2){return new F({$:3,$0:b2});};X.SetFlags=function(b2,b3){b2.flags=b3;};X.Flags=function(b2){return b2!==null&&b2.hasOwnProperty("flags")?b2.flags:0;};X.Updates=function(b2){return W.MapTreeReduce(function(b3){return b3.NChanged();},q.Const(),q.Map2Unit,b2.DynNodes);};X.Insert=function(b2,b3){var b4,b5,b6;function b7(b8){var b9,b_;while(true)if(!(b8===null)){if(b8!=null&&b8.$==1)return b4.push(b8.$0);else if(b8!=null&&b8.$==2){b9=b8.$1;b_=b8.$0;b7(b_);b8=b9;}else return b8!=null&&b8.$==3?b8.$0(b2):b8!=null&&b8.$==4?b5.push(b8.$0):null;}else return null;}b4=[];b5=[];b7(b3);b6=b4.slice(0);return bq.New(b2,X.Flags(b3),b6,b5.length===0?null:{$:1,$0:function(b8){Y.iter(function(b9){b9(b8);},b5);}});};X.Empty=function(b2){return bq.New(b2,0,[],null);};X.HasExitAnim=function(b2){var b3;b3=2;return(b2.DynFlags&b3)===b3;};X.GetExitAnim=function(b2){return X.GetAnim(b2,function(b3,b4){return b3.NGetExitAnim(b4);});};X.HasEnterAnim=function(b2){var b3;b3=1;return(b2.DynFlags&b3)===b3;};X.GetEnterAnim=function(b2){return X.GetAnim(b2,function(b3,b4){return b3.NGetEnterAnim(b4);});};X.HasChangeAnim=function(b2){var b3;b3=4;return(b2.DynFlags&b3)===b3;};X.GetChangeAnim=function(b2){return X.GetAnim(b2,function(b3,b4){return b3.NGetChangeAnim(b4);});};X.GetAnim=function(b2,b3){return bm.Concat(n.map(function(b4){return b3(b4,b2.DynElem);},b2.DynNodes));};X.Sync=function(b2,b3){n.iter(function(b4){b4.NSync(b2);},b3.DynNodes);};Y.delay=function(b2){return{GetEnumerator:function(){return _4.Get(b2());}};};Y.append=function(b2,b3){return{GetEnumerator:function(){var b4,b5;b4=_4.Get(b2);b5=[true];return new _7.New(b4,null,function(b6){var b7;return b6.s.MoveNext()?(b6.c=b6.s.Current(),true):(b7=b6.s,!w.Equals(b7,null)?b7.Dispose():void 0,b6.s=null,b5[0]&&(b5[0]=false,b6.s=_4.Get(b3),b6.s.MoveNext()?(b6.c=b6.s.Current(),true):(b6.s.Dispose(),b6.s=null,false)));},function(b6){var b7;b7=b6.s;if(!w.Equals(b7,null))b7.Dispose();});}};};Y.collect=function(b2,b3){return Y.concat(Y.map(b2,b3));};Y.map=function(b2,b3){return{GetEnumerator:function(){var b4;b4=_4.Get(b3);return new _7.New(null,null,function(b5){return b4.MoveNext()&&(b5.c=b2(b4.Current()),true);},function(){b4.Dispose();});}};};Y.choose=function(b2,b3){return Y.collect(function(b4){var b5;b5=b2(b4);return b5==null?B.Empty:h.ofArray([b5.$0]);},b3);};Y.concat=function(b2){return{GetEnumerator:function(){var b3;function b4(b5){var b6;while(true){b6=b5.s;if(w.Equals(b6,null)){if(b3.MoveNext()){b5.s=_4.Get(b3.Current());b5=b5;}else{b3.Dispose();return false;}}else if(b6.MoveNext()){b5.c=b6.Current();return true;}else{b5.Dispose();b5.s=null;b5=b5;}}}b3=_4.Get(b2);return new _7.New(null,null,b4,function(b5){var b6;b6=b5.s;if(!w.Equals(b6,null))b6.Dispose();if(!w.Equals(b3,null))b3.Dispose();});}};};Y.init=function(b2,b3){return Y.take(b2,Y.initInfinite(b3));};Y.head=function(b2){var b3;b3=_4.Get(b2);try{return b3.MoveNext()?b3.Current():Y.insufficient();}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}};Y.take=function(b2,b3){b2<0?Y.nonNegative():void 0;return{GetEnumerator:function(){var b4;b4=[_4.Get(b3)];return new _7.New(0,null,function(b5){var b6;b5.s=b5.s+1;return b5.s>b2?false:(b6=b4[0],w.Equals(b6,null)?Y.insufficient():b6.MoveNext()?(b5.c=b6.Current(),b5.s===b2?(b6.Dispose(),b4[0]=null):void 0,true):(b6.Dispose(),b4[0]=null,Y.insufficient()));},function(){var b5;b5=b4[0];if(!w.Equals(b5,null))b5.Dispose();});}};};Y.initInfinite=function(b2){return{GetEnumerator:function(){return new _7.New(0,null,function(b3){b3.c=b2(b3.s);b3.s=b3.s+1;return true;},void 0);}};};Y.unfold=function(b2,b3){return{GetEnumerator:function(){return new _7.New(b3,null,function(b4){var b5;b5=b2(b4.s);return b5==null?false:(b4.c=b5.$0[0],b4.s=b5.$0[1],true);},void 0);}};};Y.findIndex=function(b2,b3){var b4;b4=Y.tryFindIndex(b2,b3);return b4==null?i.FailWith("KeyNotFoundException"):b4.$0;};Y.forall2=function(b2,b3,b4){return!Y.exists2(function(b5,b6){return!b2(b5,b6);},b3,b4);};Y.tryFindIndex=function(b2,b3){var b4,b5,b6;b4=_4.Get(b3);try{b5=true;b6=0;while(b5&&b4.MoveNext())if(b2(b4.Current()))b5=false;else b6=b6+1;return b5?null:{$:1,$0:b6};}finally{if(typeof b4=="object"&&"Dispose"in b4)b4.Dispose();}};Y.fold=function(b2,b3,b4){var b5,b6;b5=b3;b6=_4.Get(b4);try{while(b6.MoveNext())b5=b2(b5,b6.Current());return b5;}finally{if(typeof b6=="object"&&"Dispose"in b6)b6.Dispose();}};Y.exists2=function(b2,b3,b4){var b5,b6,b7,b8;b5=_4.Get(b3);try{b7=_4.Get(b4);try{b8=false;while(!b8&&b5.MoveNext()&&b7.MoveNext())b8=b2(b5.Current(),b7.Current());b6=b8;}finally{if(typeof b7=="object"&&"Dispose"in b7)b7.Dispose();}return b6;}finally{if(typeof b5=="object"&&"Dispose"in b5)b5.Dispose();}};Y.distinct=function(b2){return Y.distinctBy(a.id,b2);};Y.nth=function(b2,b3){var b4,b5;if(b2<0)i.FailWith("negative index requested");b4=-1;b5=_4.Get(b3);try{while(b4<b2){!b5.MoveNext()?Y.insufficient():void 0;b4=b4+1;}return b5.Current();}finally{if(typeof b5=="object"&&"Dispose"in b5)b5.Dispose();}};Y.iter=function(b2,b3){var b4;b4=_4.Get(b3);try{while(b4.MoveNext())b2(b4.Current());}finally{if(typeof b4=="object"&&"Dispose"in b4)b4.Dispose();}};Y.compareWith=function(b2,b3,b4){var b5,b6,b7,b8,b9;b5=_4.Get(b3);try{b7=_4.Get(b4);try{b8=0;b9=true;while(b9&&b8===0)if(b5.MoveNext())b8=b7.MoveNext()?b2(b5.Current(),b7.Current()):1;else if(b7.MoveNext())b8=-1;else b9=false;b6=b8;}finally{if(typeof b7=="object"&&"Dispose"in b7)b7.Dispose();}return b6;}finally{if(typeof b5=="object"&&"Dispose"in b5)b5.Dispose();}};Y.forall=function(b2,b3){return!Y.exists(function(b4){return!b2(b4);},b3);};Y.distinctBy=function(b2,b3){return{GetEnumerator:function(){var b4,b5;b4=_4.Get(b3);b5=new _5.New$3();return new _7.New(null,null,function(b6){var b7,b8;if(b4.MoveNext()){b7=b4.Current();b8=b5.SAdd(b2(b7));while(!b8&&b4.MoveNext()){b7=b4.Current();b8=b5.SAdd(b2(b7));}return b8&&(b6.c=b7,true);}else return false;},function(){b4.Dispose();});}};};Y.exists=function(b2,b3){var b4,b5;b4=_4.Get(b3);try{b5=false;while(!b5&&b4.MoveNext())b5=b2(b4.Current());return b5;}finally{if(typeof b4=="object"&&"Dispose"in b4)b4.Dispose();}};Y.max=function(b2){var b3,b4,b5;b3=_4.Get(b2);try{if(!b3.MoveNext())Y.seqEmpty();b4=b3.Current();while(b3.MoveNext()){b5=b3.Current();if(w.Compare(b5,b4)===1)b4=b5;}return b4;}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}};Y.seqEmpty=function(){return i.FailWith("The input sequence was empty.");};Z.OfArray=function(b2){return new M.New$1(_3.OfSeq(Y.map(function(b3){return _2.New(b3[0],b3[1]);},b2)));};E.Obsolete=function(b2){var b3,b4,b5,b6,b7;b4=b2.s;if(b4==null||(b4!=null&&b4.$==2?(b3=b4.$1,false):b4!=null&&b4.$==3?(b3=b4.$1,false):true))void 0;else{b2.s=null;for(b5=0,b6=n.length(b3)-1;b5<=b6;b5++){b7=n.get(b3,b5);if(typeof b7=="object")(function(b8){E.Obsolete(b8);}(b7));else b7();}}};E.New=function(b2){return{s:b2};};_0.TryParseInt32=function(b2,b3){return _0.TryParse(b2,-2147483648,2147483647,b3);};_2=L.Pair=bZ.Class({Equals:function(b2){return w.Equals(this.Key,b2.Key);},GetHashCode:function(){return w.Hash(this.Key);},CompareTo0:function(b2){return w.Compare(this.Key,b2.Key);}},null,_2);_2.New=function(b2,b3){return new _2({Key:b2,Value:b3});};_3.Contains=function(b2,b3){return!((_3.Lookup(b2,b3))[0]==null);};_3.Enumerate=function(b2,b3){function b4(b5,b6){var b7;while(true)if(b5==null)return b6.$==1?{$:1,$0:[b6.$0[0],[b6.$0[1],b6.$1]]}:null;else if(b2){b7=b5;b5=b7.Right;b6=new B({$:1,$0:[b7.Node,b7.Left],$1:b6});}else{b7=b5;b5=b7.Left;b6=new B({$:1,$0:[b7.Node,b7.Right],$1:b6});}}return Y.unfold(function(b5){return b4(b5[0],b5[1]);},[b3,B.Empty]);};_3.Lookup=function(b2,b3){var b4,b5,b6,b7;b4=[];b5=b3;b6=true;while(b6)if(b5==null)b6=false;else{b7=w.Compare(b2,b5.Node);if(b7===0)b6=false;else b7===1?(b4.unshift([true,b5.Node,b5.Left]),b5=b5.Right):(b4.unshift([false,b5.Node,b5.Right]),b5=b5.Left);}return[b5,b4];};_3.TryFind=function(b2,b3){var b4;b4=(_3.Lookup(b2,b3))[0];return b4==null?null:{$:1,$0:b4.Node};};_3.OfSeq=function(b2){var b3;b3=n.ofSeq(Y.distinct(b2));n.sortInPlace(b3);return _3.Build(b3,0,b3.length-1);};_3.Build=function(b2,b3,b4){var b5,b6,b7;return b4-b3+1<=0?null:(b5=(b3+b4)/2>>0,(b6=_3.Build(b2,b3,b5-1),(b7=_3.Build(b2,b5+1,b4),_3.Branch(n.get(b2,b5),b6,b7))));};_3.Branch=function(b2,b3,b4){var b5,b6;return $.New(b2,b3,b4,1+(b5=b3==null?0:b3.Height,(b6=b4==null?0:b4.Height,w.Compare(b5,b6)===1?b5:b6)),1+(b3==null?0:b3.Count)+(b4==null?0:b4.Count));};_4.Get=function(b2){return b2 instanceof a.Array?_4.ArrayEnumerator(b2):w.Equals(typeof b2,"string")?_4.StringEnumerator(b2):b2.GetEnumerator();};_4.ArrayEnumerator=function(b2){return new _7.New(0,null,function(b3){var b4;b4=b3.s;return b4<n.length(b2)&&(b3.c=n.get(b2,b4),b3.s=b4+1,true);},void 0);};_4.StringEnumerator=function(b2){return new _7.New(0,null,function(b3){var b4;b4=b3.s;return b4<b2.length&&(b3.c=b2[b4],b3.s=b4+1,true);},void 0);};_4.Get0=function(b2){return b2 instanceof a.Array?_4.ArrayEnumerator(b2):w.Equals(typeof b2,"string")?_4.StringEnumerator(b2):"GetEnumerator0"in b2?b2.GetEnumerator0():b2.GetEnumerator();};n.ofList=function(b2){var b3,b4;b4=[];b3=b2;while(!(b3.$==0)){b4.push(h.head(b3));b3=h.tail(b3);}return b4;};n.sortInPlaceBy=function(b2,b3){n.mapInPlace(function(b4){return b4[0];},n.mapiInPlace(function(b4,b5){return[b5,[b2(b5),b4]];},b3).sort(function(b4,b5){return w.Compare(b4[1],b5[1]);}));};n.choose=function(b2,b3){var b4,b5,b6,b7;b4=[];for(b5=0,b6=b3.length-1;b5<=b6;b5++){b7=b2(b3[b5]);if(b7==null);else b4.push(b7.$0);}return b4;};n.ofSeq=function(b2){var b3,b4;if(b2 instanceof a.Array)return b2.slice();else if(b2 instanceof B)return n.ofList(b2);else{b3=[];b4=_4.Get(b2);try{while(b4.MoveNext())b3.push(b4.Current());return b3;}finally{if(typeof b4=="object"&&"Dispose"in b4)b4.Dispose();}}};n.tryFindIndex=function(b2,b3){var b4,b5;b4=null;b5=0;while(b5<b3.length&&b4==null){b2(b3[b5])?b4={$:1,$0:b5}:void 0;b5=b5+1;}return b4;};n.tryPick=function(b2,b3){var b4,b5,b6;b4=null;b5=0;while(b5<b3.length&&b4==null){b6=b2(b3[b5]);if(b6!=null&&b6.$==1)b4=b6;b5=b5+1;}return b4;};n.exists=function(b2,b3){var b4,b5,b6,b7;b4=false;b5=0;b7=n.length(b3);while(!b4&&b5<b7)if(b2(b3[b5]))b4=true;else b5=b5+1;return b4;};n.concat=function(b2){return a.Array.prototype.concat.apply([],n.ofSeq(b2));};n.iter=function(b2,b3){var b4,b5;for(b4=0,b5=b3.length-1;b4<=b5;b4++)b2(b3[b4]);};n.foldBack=function(b2,b3,b4){var b5,b6,b7,b8,b9;b5=b4;b7=b3.length;for(b8=1,b9=b7;b8<=b9;b8++)b5=b2(b3[b7-b8],b5);return b5;};n.map=function(b2,b3){var b4,b5,b6;b4=new a.Array(b3.length);for(b5=0,b6=b3.length-1;b5<=b6;b5++)b4[b5]=b2(b3[b5]);return b4;};n.filter=function(b2,b3){var b4,b5,b6;b4=[];for(b5=0,b6=b3.length-1;b5<=b6;b5++)if(b2(b3[b5]))b4.push(b3[b5]);return b4;};n.pick=function(b2,b3){var b4;b4=n.tryPick(b2,b3);return b4==null?i.FailWith("KeyNotFoundException"):b4.$0;};n.sortInPlace=function(b2){n.mapInPlace(function(b3){return b3[0];},n.mapiInPlace(function(b3,b4){return[b4,b3];},b2).sort(w.Compare));};n.forall=function(b2,b3){var b4,b5,b6,b7;b4=true;b5=0;b7=n.length(b3);while(b4&&b5<b7)if(b2(b3[b5]))b5=b5+1;else b4=false;return b4;};n.create=function(b2,b3){var b4,b5,b6;b4=new a.Array(b2);for(b5=0,b6=b2-1;b5<=b6;b5++)b4[b5]=b3;return b4;};n.init=function(b2,b3){var b4,b5,b6;if(b2<0)i.FailWith("Negative size given.");else null;b4=new a.Array(b2);for(b5=0,b6=b2-1;b5<=b6;b5++)b4[b5]=b3(b5);return b4;};_5=L.HashSet=bZ.Class({SAdd:function(b2){return this.add(b2);},Contains:function(b2){var b3;b3=this.data[this.hash(b2)];return b3==null?false:this.arrContains(b2,b3);},add:function(b2){var b3,b4;b3=this.hash(b2);b4=this.data[b3];return b4==null?(this.data[b3]=[b2],this.count=this.count+1,true):this.arrContains(b2,b4)?false:(b4.push(b2),this.count=this.count+1,true);},arrContains:function(b2,b3){var b4,b5,b6,b7;b4=true;b5=0;b7=b3.length;while(b4&&b5<b7)if(this.equals.apply(null,[b3[b5],b2]))b4=false;else b5=b5+1;return!b4;},GetEnumerator:function(){return _4.Get(bC.concat(this.data));},ExceptWith:function(b2){var b3;b3=_4.Get(b2);try{while(b3.MoveNext())this.Remove(b3.Current());}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}},Count:function(){return this.count;},IntersectWith:function(b2){var b3,b4,b5,b6,b7;b3=new _5.New$4(b2,this.equals,this.hash);b4=bC.concat(this.data);for(b5=0,b6=b4.length-1;b5<=b6;b5++){b7=b4[b5];if(!b3.Contains(b7))this.Remove(b7);}},Remove:function(b2){var b3;b3=this.data[this.hash(b2)];return b3==null?false:this.arrRemove(b2,b3)&&(this.count=this.count-1,true);},CopyTo:function(b2,b3){var b4,b5,b6;b4=bC.concat(this.data);for(b5=0,b6=b4.length-1;b5<=b6;b5++)n.set(b2,b5+b3,b4[b5]);},arrRemove:function(b2,b3){var b4,b5,b6,b7;b4=true;b5=0;b7=b3.length;while(b4&&b5<b7)if(this.equals.apply(null,[b3[b5],b2])){b3.splice.apply(b3,[b5,1]);b4=false;}else b5=b5+1;return!b4;}},e,_5);_5.New$3=bZ.Ctor(function(){_5.New$4.call(this,[],w.Equals,w.Hash);},_5);_5.New$4=bZ.Ctor(function(b2,b3,b4){var b5;e.New.call(this);this.equals=b3;this.hash=b4;this.data=[];this.count=0;b5=_4.Get(b2);try{while(b5.MoveNext())this.add(b5.Current());}finally{if(typeof b5=="object"&&"Dispose"in b5)b5.Dispose();}},_5);_5.New$2=bZ.Ctor(function(b2){_5.New$4.call(this,b2,w.Equals,w.Hash);},_5);_6.$cctor=function(){_6.$cctor=a.ignore;_6.initialized=new V.New$5();};_6=l.TemplateInitializer=bZ.Class({},e,_6);_6.GetOrAddHoleFor=function(b2,b3,b4){var b5,b6,b7,b8;_6.$cctor();b5=_6.GetHolesFor(b2);b6=(b7=null,[b5.TryGetValue(b3,{get:function(){return b7;},set:function(b9){b7=b9;}}),b7]);return b6[0]?b6[1]:(b8=b4(),(b5.set_Item(b3,b8),b8));};_6.GetHolesFor=function(b2){var b3,b4,b5;_6.$cctor();b3=(b4=null,[_6.initialized.TryGetValue(b2,{get:function(){return b4;},set:function(b6){b4=b6;}}),b4]);return b3[0]?b3[1]:(b5=new V.New$5(),(_6.initialized.set_Item(b2,b5),b5));};_7=_4.T=bZ.Class({MoveNext:function(){var b2;b2=this.n(this);this.e=b2?1:2;return b2;},Current:function(){return this.e===1?this.c:this.e===0?i.FailWith("Enumeration has not started. Call MoveNext."):i.FailWith("Enumeration already finished.");},Dispose:function(){if(this.d)this.d(this);}},e,_7);_7.New=bZ.Ctor(function(b2,b3,b4,b5){e.New.call(this);this.s=b2;this.c=b3;this.n=b4;this.d=b5;this.e=0;},_7);_9=f.CheckedInput=bZ.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,_9);_=f.DynamicAttrNode=bZ.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(b2){return bm.get_Empty();},NGetEnterAnim:function(b2){return bm.get_Empty();},NGetChangeAnim:function(b2){return bm.get_Empty();},NSync:function(b2){if(this.dirty){(this.push(b2))(this.value);this.dirty=false;}}},e,_);_.New=bZ.Ctor(function(b2,b3){var b4;b4=this;e.New.call(this);this.push=b3;this.value=void 0;this.dirty=false;this.updates=q.Map(function(b5){b4.value=b5;b4.dirty=true;},b2);},_);n.groupBy=function(b2,b3){var b4,b5,b6,b7,b8,b9;b4=new V.New$5();b5=[];for(b6=0,b7=n.length(b3)-1;b6<=b7;b6++){b8=b3[b6];b9=b2(b8);if(b4.ContainsKey(b9))b4.Item(b9).push(b8);else{b5.push(b9);b4.DAdd(b9,[b8]);}}n.mapInPlace(function(b_){return[b_,b4.Item(b_)];},b5);return b5;};n.mapInPlace=function(b2,b3){var b4,b5;for(b4=0,b5=b3.length-1;b4<=b5;b4++)b3[b4]=b2(b3[b4]);};n.mapiInPlace=function(b2,b3){var b4,b5;for(b4=0,b5=b3.length-1;b4<=b5;b4++)b3[b4]=b2(b4,b3[b4]);return b3;};Y.insufficient=function(){return i.FailWith("The input sequence has an insufficient number of elements.");};Y.nonNegative=function(){return i.FailWith("The input must be non-negative.");};$.New=function(b2,b3,b4,b5,b6){return{Node:b2,Left:b3,Right:b4,Height:b5,Count:b6};};ba.CreateEmbedNode=function(){return{Current:null,Dirty:false};};ba.UpdateEmbedNode=function(b2,b3){b2.Current=b3;b2.Dirty=true;};ba.LinkElement=function(b2,b3){ba.InsertDoc(b2,b3,null);};ba.InsertDoc=function(b2,b3,b4){var b5,b6,b7;while(true)if(b3!=null&&b3.$==1)return ba.InsertNode(b2,b3.$0.El,b4);else if(b3!=null&&b3.$==2){b5=b3.$0;b5.Dirty=false;b3=b5.Current;}else if(b3==null)return b4;else if(b3!=null&&b3.$==4)return ba.InsertNode(b2,b3.$0.Text,b4);else if(b3!=null&&b3.$==5)return ba.InsertNode(b2,b3.$0,b4);else if(b3!=null&&b3.$==6)return n.foldBack(function(b8,b9){return(((bZ.Curried3(function(b_,b$,ca){return b$==null||b$.constructor===_1?ba.InsertDoc(b_,b$,ca):ba.InsertNode(b_,b$,ca);}))(b2))(b8))(b9);},b3.$0.Els,b4);else{b6=b3.$1;b7=b3.$0;b3=b7;b4=ba.InsertDoc(b2,b6,b4);}};ba.CreateRunState=function(b2,b3){return bx.New(by.get_Empty(),ba.CreateElemNode(b2,X.EmptyAttr(),b3));};ba.PerformAnimatedUpdate=function(b2,b3,b4){var b5;return bm.get_UseAnimations()?(b5=null,bz.Delay(function(){var b6,b7,b8;b6=by.FindAll(b4);b7=ba.ComputeChangeAnim(b3,b6);b8=ba.ComputeEnterAnim(b3,b6);return bz.Bind(bm.Play(bm.Append(b7,ba.ComputeExitAnim(b3,b6))),function(){return bz.Bind(ba.SyncElemNodesNextFrame(b2,b3),function(){return bz.Bind(bm.Play(b8),function(){b3.PreviousNodes=b6;return bz.Return(null);});});});})):ba.SyncElemNodesNextFrame(b2,b3);};ba.PerformSyncUpdate=function(b2,b3,b4){var b5;b5=by.FindAll(b4);ba.SyncElemNode(b2,b3.Top);b3.PreviousNodes=b5;};ba.CreateElemNode=function(b2,b3,b4){var b5;ba.LinkElement(b2,b4);b5=X.Insert(b2,b3);return bf.New(b5,b4,null,b2,U.Int(),bZ.GetOptional(b5.OnAfterRender));};ba.InsertBeforeDelim=function(b2,b3){var b4,b5;b4=b2.parentNode;b5=self.document.createTextNode("");b4.insertBefore(b5,b2);ba.LinkPrevElement(b2,b3);return b5;};ba.InsertNode=function(b2,b3,b4){bb.InsertAt(b2,b4,b3);return b3;};ba.SyncElemNodesNextFrame=function(b2,b3){function b4(b5){a.requestAnimationFrame(function(){ba.SyncElemNode(b2,b3.Top);b5();});}return bn.BatchUpdatesEnabled()?bz.FromContinuations(function(b5,b6,b7){return b4.apply(null,[b5,b6,b7]);}):(ba.SyncElemNode(b2,b3.Top),bz.Return(null));};ba.ComputeExitAnim=function(b2,b3){return bm.Concat(n.map(function(b4){return X.GetExitAnim(b4.Attr);},by.ToArray(by.Except(b3,by.Filter(function(b4){return X.HasExitAnim(b4.Attr);},b2.PreviousNodes)))));};ba.ComputeEnterAnim=function(b2,b3){return bm.Concat(n.map(function(b4){return X.GetEnterAnim(b4.Attr);},by.ToArray(by.Except(b2.PreviousNodes,by.Filter(function(b4){return X.HasEnterAnim(b4.Attr);},b3)))));};ba.ComputeChangeAnim=function(b2,b3){var b4;function b5(b6){return X.HasChangeAnim(b6.Attr);}b4=function(b6){return by.Filter(b5,b6);};return bm.Concat(n.map(function(b6){return X.GetChangeAnim(b6.Attr);},by.ToArray(by.Intersect(b4(b2.PreviousNodes),b4(b3)))));};ba.SyncElemNode=function(b2,b3){!b2?ba.SyncElement(b3):void 0;ba.Sync(b3.Children);ba.AfterRender(b3);};ba.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};ba.UpdateTextNode=function(b2,b3){b2.Value=b3;b2.Dirty=true;};ba.LinkPrevElement=function(b2,b3){ba.InsertDoc(b2.parentNode,b3,b2);};ba.SyncElement=function(b2){function b3(b4){function b5(b6){var b7,b8,b9,b_;while(true){if(b6!=null&&b6.$==0){b8=b6.$1;b9=b6.$0;if(b5(b9))return true;else b6=b8;}else if(b6!=null&&b6.$==2){b_=b6.$0;if(b_.Dirty)return true;else b6=b_.Current;}else return b6!=null&&b6.$==6&&(b7=b6.$0,b7.Dirty||n.exists(b3,b7.Holes));}}return b5(b4.Children);}X.Sync(b2.El,b2.Attr);if(b3(b2))ba.DoSyncElement(b2);};ba.Sync=function(b2){var b3,b4,b5,b6,b7;while(true){if(b2!=null&&b2.$==1)return ba.SyncElemNode(false,b2.$0);else if(b2!=null&&b2.$==2){b5=b2.$0;b2=b5.Current;}else if(b2==null)return null;else if(b2!=null&&b2.$==5)return null;else if(b2!=null&&b2.$==4){b3=b2.$0;return b3.Dirty?(b3.Text.nodeValue=b3.Value,b3.Dirty=false):null;}else if(b2!=null&&b2.$==6){b4=b2.$0;n.iter(function(b8){ba.SyncElemNode(false,b8);},b4.Holes);n.iter(function(b8){X.Sync(b8[0],b8[1]);},b4.Attrs);return ba.AfterRender(b4);}else{b6=b2.$1;b7=b2.$0;ba.Sync(b7);b2=b6;}}};ba.AfterRender=function(b2){var b3;b3=bZ.GetOptional(b2.Render);if(b3!=null&&b3.$==1){b3.$0(b2.El);bZ.SetOptional(b2,"Render",null);}};ba.DoSyncElement=function(b2){var b3,b4,b5;function b6(b7,b8){var b9,b_,b$,ca;while(true){if(b7!=null&&b7.$==1)return b7.$0.El;else if(b7!=null&&b7.$==2){b_=b7.$0;if(b_.Dirty){b_.Dirty=false;return ba.InsertDoc(b3,b_.Current,b8);}else b7=b_.Current;}else if(b7==null)return b8;else if(b7!=null&&b7.$==4)return b7.$0.Text;else if(b7!=null&&b7.$==5)return b7.$0;else if(b7!=null&&b7.$==6){b9=b7.$0;b9.Dirty?b9.Dirty=false:void 0;return n.foldBack(function(cb,cc){return cb==null||cb.constructor===_1?b6(cb,cc):cb;},b9.Els,b8);}else{b$=b7.$1;ca=b7.$0;b7=ca;b8=b6(b$,b8);}}}b3=b2.El;bS.Iter((b4=b2.El,function(b7){bb.RemoveNode(b4,b7);}),bS.Except(bS.DocChildren(b2),bS.Children(b2.El,bZ.GetOptional(b2.Delimiters))));b6(b2.Children,(b5=bZ.GetOptional(b2.Delimiters),b5!=null&&b5.$==1?b5.$0[1]:null));};bb.ParseHTMLIntoFakeRoot=function(b2){var b3,b4,b5,b6,b7;function b8(b9,b_){var b$;while(true)if(b_===0)return b9;else{b$=b_;b9=b9.lastChild;b_=b$-1;}}b3=self.document.createElement("div");return!bb.rhtml().test(b2)?(b3.appendChild(self.document.createTextNode(b2)),b3):(b4=(b5=bb.rtagName().exec(b2),w.Equals(b5,null)?"":n.get(b5,1).toLowerCase()),(b6=(b7=(bb.wrapMap())[b4],b7?b7:bb.defaultWrap()),(b3.innerHTML=b6[1]+b2.replace(bb.rxhtmlTag(),"<$1></$2>")+b6[2],b8(b3,b6[0]))));};bb.ChildrenArray=function(b2){var b3,b4,b5;b3=[];for(b4=0,b5=b2.childNodes.length-1;b4<=b5;b4++)b3.push(b2.childNodes[b4]);return b3;};bb.rhtml=function(){bG.$cctor();return bG.rhtml;};bb.wrapMap=function(){bG.$cctor();return bG.wrapMap;};bb.defaultWrap=function(){bG.$cctor();return bG.defaultWrap;};bb.rxhtmlTag=function(){bG.$cctor();return bG.rxhtmlTag;};bb.rtagName=function(){bG.$cctor();return bG.rtagName;};bb.IterSelector=function(b2,b3,b4){var b5,b6,b7;b5=b2.querySelectorAll(b3);for(b6=0,b7=b5.length-1;b6<=b7;b6++)b4(b5[b6]);};bb.IterSelectorDoc=function(b2,b3){var b4,b5,b6;b4=self.document.querySelectorAll(b2);for(b5=0,b6=b4.length-1;b5<=b6;b5++)b3(b4[b5]);};bb.InsertAt=function(b2,b3,b4){var b5;if(!(b4.parentNode===b2&&b3===(b5=b4.nextSibling,w.Equals(b5,null)?null:b5)))b2.insertBefore(b4,b3);};bb.RemoveNode=function(b2,b3){if(b3.parentNode===b2)b2.removeChild(b3);};bc.notPresent=function(){throw new bJ.New();};bc.alreadyAdded=function(){throw new bK.New$2("An item with the same key has already been added.");};bd.$cctor=function(){bd.$cctor=a.ignore;bd.LoadedTemplates=new V.New$5();bd.LocalTemplatesLoaded=false;bd.GlobalHoles=new V.New$5();bd.TextHoleRE="\\${([^}]+)}";bd.RenderedFullDocTemplate=null;};be.$cctor=function(){be.$cctor=a.ignore;be.counter=0;};bf=f.DocElemNode=bZ.Class({Equals:function(b2){return this.ElKey===b2.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bf);bf.New=function(b2,b3,b4,b5,b6,b7){var b8;return new bf((b8={Attr:b2,Children:b3,El:b5,ElKey:b6},(bZ.SetOptional(b8,"Delimiters",b4),bZ.SetOptional(b8,"Render",b7),b8)));};bh.$cctor=function(){var b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd;bh.$cctor=a.ignore;bh.EmptyAttr=null;bh.BoolCheckedApply=function(ce){function cf(cg,ch){return ch!=null&&ch.$==1?void(cg.checked=ch.$0):null;}return[function(cg){cg.addEventListener("change",function(){return!w.Equals(ce.Get(),cg.checked)?ce.Set(cg.checked):null;});},function(cg){return function(ch){return cf(cg,ch);};},q.Map(function(cg){return{$:1,$0:cg};},ce.get_View())];};bh.StringSet=function(ce){return function(cf){ce.value=cf;};};bh.StringGet=function(ce){return{$:1,$0:ce.value};};bh.StringApply=(b2=br.StringGet(),(b3=br.StringSet(),function(ce){return br.ApplyValue(b2,b3,ce);}));bh.DateTimeSetUnchecked=function(ce){return function(cf){ce.value=(new a.Date(cf)).toLocaleString();};};bh.DateTimeGetUnchecked=function(ce){var cf,cg,ch,ci;cf=ce.value;return bs.isBlank(cf)?{$:1,$0:-8640000000000000}:(cg=(ch=0,[(ci=bE.TryParse(cf),ci!=null&&ci.$==1&&(ch=ci.$0,true)),ch]),cg[0]?{$:1,$0:cg[1]}:null);};bh.DateTimeApplyUnchecked=(b4=br.DateTimeGetUnchecked(),(b5=br.DateTimeSetUnchecked(),function(ce){return br.ApplyValue(b4,b5,ce);}));bh.FileSetUnchecked=function(){return function(){return null;};};bh.FileGetUnchecked=function(ce){var cf;cf=ce.files;return{$:1,$0:n.ofSeq(Y.delay(function(){return Y.map(function(cg){return cf.item(cg);},i.range(0,cf.length-1));}))};};bh.FileApplyUnchecked=(b6=br.FileGetUnchecked(),(b7=br.FileSetUnchecked(),function(ce){return br.FileApplyValue(b6,b7,ce);}));bh.IntSetUnchecked=function(ce){return function(cf){ce.value=a.String(cf);};};bh.IntGetUnchecked=function(ce){var cf,cg;cf=ce.value;return bs.isBlank(cf)?{$:1,$0:0}:(cg=+cf,cg!==cg>>0?null:{$:1,$0:cg});};bh.IntApplyUnchecked=(b8=br.IntGetUnchecked(),(b9=br.IntSetUnchecked(),function(ce){return br.ApplyValue(b8,b9,ce);}));bh.IntSetChecked=function(ce){return function(cf){var cg;cg=cf.get_Input();return ce.value!==cg?void(ce.value=cg):null;};};bh.IntGetChecked=function(ce){var cf,cg,ch;cf=ce.value;return{$:1,$0:bs.isBlank(cf)?(ce.checkValidity?ce.checkValidity():true)?new _9({$:2,$0:cf}):new _9({$:1,$0:cf}):(cg=(ch=0,[_0.TryParseInt32(cf,{get:function(){return ch;},set:function(ci){ch=ci;}}),ch]),cg[0]?new _9({$:0,$0:cg[1],$1:cf}):new _9({$:1,$0:cf}))};};bh.IntApplyChecked=(b_=br.IntGetChecked(),(b$=br.IntSetChecked(),function(ce){return br.ApplyValue(b_,b$,ce);}));bh.FloatSetUnchecked=function(ce){return function(cf){ce.value=a.String(cf);};};bh.FloatGetUnchecked=function(ce){var cf,cg;cf=ce.value;return bs.isBlank(cf)?{$:1,$0:0}:(cg=+cf,a.isNaN(cg)?null:{$:1,$0:cg});};bh.FloatApplyUnchecked=(ca=br.FloatGetUnchecked(),(cb=br.FloatSetUnchecked(),function(ce){return br.ApplyValue(ca,cb,ce);}));bh.FloatSetChecked=function(ce){return function(cf){var cg;cg=cf.get_Input();return ce.value!==cg?void(ce.value=cg):null;};};bh.FloatGetChecked=function(ce){var cf,cg;cf=ce.value;return{$:1,$0:bs.isBlank(cf)?(ce.checkValidity?ce.checkValidity():true)?new _9({$:2,$0:cf}):new _9({$:1,$0:cf}):(cg=+cf,a.isNaN(cg)?new _9({$:1,$0:cf}):new _9({$:0,$0:cg,$1:cf}))};};bh.FloatApplyChecked=(cc=br.FloatGetChecked(),(cd=br.FloatSetChecked(),function(ce){return br.ApplyValue(cc,cd,ce);}));};bi=f.Elt=bZ.Class({},P,bi);bi.New=function(b2,b3,b4){var b5,b6;b5=ba.CreateElemNode(b2,b3,b4.docNode);b6=bt.Create(b4.updates);return new bi.New$1({$:1,$0:b5},q.Map2Unit(X.Updates(b5.Attr),b6.v),b2,b6);};bi.TreeNode=function(b2,b3){var b4,b5;function b6(b7,b8){return X.Updates(b8);}b4=bt.Create(b3);return new bi.New$1({$:6,$0:b2},q.Map2Unit((b5=n.map(function(b7){return b6(b7[0],b7[1]);},b2.Attrs),W.TreeReduce(q.Const(),q.Map2Unit,b5)),b4.v),n.get(b2.Els,0),b4);};bi.New$1=bZ.Ctor(function(b2,b3,b4,b5){P.New.call(this,b2,b3);this.docNode$1=b2;this.updates$1=b3;this.elt=b4;this.rvUpdates=b5;},bi);bj.convertTextNode=function(b2){var b3,b4,b5,b6,b7,b8;b3=null;b4=0;b6=b2.textContent;b7=new a.RegExp(S.TextHoleRE(),"g");while(b3=b7.exec(b6),b3!==null){b2.parentNode.insertBefore(self.document.createTextNode(bk.string(b6,{$:1,$0:b4},{$:1,$0:b7.lastIndex-n.get(b3,0).length-1})),b2);b4=b7.lastIndex;b8=self.document.createElement("span");b8.setAttribute("ws-replace",n.get(b3,1).toLowerCase());b2.parentNode.insertBefore(b8,b2);}b7.lastIndex=0;b2.textContent=bk.string(b6,{$:1,$0:b4},null);};bj.failNotLoaded=function(b2){b0.warn("Instantiating non-loaded template",b2);};bj.fillTextHole=function(b2,b3,b4){var b5;b5=b2.querySelector("[ws-replace]");return w.Equals(b5,null)?(b0.warn("Filling non-existent text hole",b4),null):(b5.parentNode.replaceChild(self.document.createTextNode(b3),b5),{$:1,$0:b5.getAttribute("ws-replace")});};bj.removeHolesExcept=function(b2,b3){function b4(b5){S.foreachNotPreserved(b2,"["+b5+"]",function(b6){if(!b3.Contains(b6.getAttribute(b5)))b6.removeAttribute(b5);});}b4("ws-attr");b4("ws-onafterrender");b4("ws-var");S.foreachNotPreserved(b2,"[ws-hole]",function(b5){if(!b3.Contains(b5.getAttribute("ws-hole"))){b5.removeAttribute("ws-hole");while(b5.hasChildNodes())b5.removeChild(b5.lastChild);}});S.foreachNotPreserved(b2,"[ws-replace]",function(b5){if(!b3.Contains(b5.getAttribute("ws-replace")))b5.parentNode.removeChild(b5);});S.foreachNotPreserved(b2,"[ws-on]",function(b5){b5.setAttribute("ws-on",bu.concat(" ",n.filter(function(b6){return b3.Contains(n.get(bu.SplitChars(b6,[":"],1),1));},bu.SplitChars(b5.getAttribute("ws-on"),[" "],1))));});S.foreachNotPreserved(b2,"[ws-attr-holes]",function(b5){var b6,b7,b8,b9,b_;b6=bu.SplitChars(b5.getAttribute("ws-attr-holes"),[" "],1);for(b7=0,b8=b6.length-1;b7<=b8;b7++){b9=n.get(b6,b7);b5.setAttribute(b9,(b_=new a.RegExp(S.TextHoleRE(),"g"),b5.getAttribute(b9).replace(b_,function(b$,ca){return b3.Contains(ca)?b$:"";})));}});};bj.fillInstanceAttrs=function(b2,b3){var b4,b5,b6,b7,b8;bj.convertAttrs(b3);b4=b3.nodeName.toLowerCase();b5=b2.querySelector("[ws-attr="+b4+"]");if(w.Equals(b5,null))b0.warn("Filling non-existent attr hole",b4);else{b5.removeAttribute("ws-attr");for(b6=0,b7=b3.attributes.length-1;b6<=b7;b6++){b8=b3.attributes.item(b6);if(b8.name==="class"&&b5.hasAttribute("class"))b5.setAttribute("class",b5.getAttribute("class")+" "+b8.nodeValue);else b5.setAttribute(b8.name,b8.nodeValue);}}};bj.mapHoles=function(b2,b3){function b4(b5){S.foreachNotPreserved(b2,"["+b5+"]",function(b6){var b7,b8;b7=(b8=null,[b3.TryGetValue(b6.getAttribute(b5).toLowerCase(),{get:function(){return b8;},set:function(b9){b8=b9;}}),b8]);if(b7[0])b6.setAttribute(b5,b7[1]);});}b4("ws-hole");b4("ws-replace");b4("ws-attr");b4("ws-onafterrender");b4("ws-var");S.foreachNotPreserved(b2,"[ws-on]",function(b5){b5.setAttribute("ws-on",bu.concat(" ",n.map(function(b6){var b7,b8,b9;b7=bu.SplitChars(b6,[":"],1);b8=(b9=null,[b3.TryGetValue(n.get(b7,1),{get:function(){return b9;},set:function(b_){b9=b_;}}),b9]);return b8[0]?n.get(b7,0)+":"+b8[1]:b6;},bu.SplitChars(b5.getAttribute("ws-on"),[" "],1))));});S.foreachNotPreserved(b2,"[ws-attr-holes]",function(b5){var b6,b7,b8;b6=bu.SplitChars(b5.getAttribute("ws-attr-holes"),[" "],1);for(b7=0,b8=b6.length-1;b7<=b8;b7++)(function(){var b9;function b_(b$,ca){var cb;cb=i.KeyValue(ca);return b$.replace(new a.RegExp("\\${"+cb[0]+"}","ig"),"${"+cb[1]+"}");}b9=n.get(b6,b7);return b5.setAttribute(b9,(((bZ.Curried3(Y.fold))(b_))(b5.getAttribute(b9)))(b3));}());});};bj.fill=function(b2,b3,b4){while(true)if(b2.hasChildNodes())b4=b3.insertBefore(b2.lastChild,b4);else return null;};bj.convertAttrs=function(b2){var b4,b5,b6,b7,b8,b9,b_,b$;function b3(ca){var cb;cb=b2.getAttribute(ca);if(cb===null);else b2.setAttribute(ca,cb.toLowerCase());}b4=b2.attributes;b5=[];b6=[];b7=[];for(b8=0,b9=b4.length-1;b8<=b9;b8++){b_=b4.item(b8);if(bu.StartsWith(b_.nodeName,"ws-on")&&b_.nodeName!=="ws-onafterrender"&&b_.nodeName!=="ws-on"){b5.push(b_.nodeName);b6.push(bk.string(b_.nodeName,{$:1,$0:"ws-on".length},null)+":"+b_.nodeValue.toLowerCase());}else!bu.StartsWith(b_.nodeName,"ws-")&&(new a.RegExp(S.TextHoleRE())).test(b_.nodeValue)?(b_.nodeValue=(b$=new a.RegExp(S.TextHoleRE(),"g"),b_.nodeValue.replace(b$,function(ca,cb){return"${"+cb.toLowerCase()+"}";})),b7.push(b_.nodeName)):void 0;}if(!(b6.length==0))b2.setAttribute("ws-on",bu.concat(" ",b6));if(!(b7.length==0))b2.setAttribute("ws-attr-holes",bu.concat(" ",b7));b3("ws-hole");b3("ws-replace");b3("ws-attr");b3("ws-onafterrender");b3("ws-var");n.iter(function(ca){b2.removeAttribute(ca);},b5);};bk.string=function(b2,b3,b4){var b5,b6;return b3==null?b4!=null&&b4.$==1?(b5=b4.$0,b5<0?"":b2.slice(0,b5+1)):"":b4==null?b2.slice(b3.$0):(b6=b4.$0,b6<0?"":b2.slice(b3.$0,b6+1));};bl=L.KeyCollection=bZ.Class({GetEnumerator:function(){return _4.Get(Y.map(function(b2){return b2.K;},this.d));}},e,bl);bl.New=bZ.Ctor(function(b2){e.New.call(this);this.d=b2;},bl);bm.get_UseAnimations=function(){return bA.UseAnimations();};bm.Play=function(b2){var b3;b3=null;return bz.Delay(function(){return bz.Bind(bm.Run(a.ignore,bA.Actions(b2)),function(){bA.Finalize(b2);return bz.Return(null);});});};bm.Append=function(b2,b3){return{$:0,$0:bI.Append(b2.$0,b3.$0)};};bm.Run=function(b2,b3){var b4;function b5(b6){function b7(b8){return function(b9){var b_;b_=b9-b8;b3.Compute(b_);b2();return b_<=b4?void a.requestAnimationFrame(function(b$){(b7(b8))(b$);}):b6();};}a.requestAnimationFrame(function(b8){(b7(b8))(b8);});}b4=b3.Duration;return b4===0?bz.Zero():bz.FromContinuations(function(b6,b7,b8){return b5.apply(null,[b6,b7,b8]);});};bm.Concat=function(b2){return{$:0,$0:bI.Concat(Y.map(bA.List,b2))};};bm.get_Empty=function(){return{$:0,$0:bI.Empty()};};bn.BatchUpdatesEnabled=function(){bB.$cctor();return bB.BatchUpdatesEnabled;};bo.StartProcessor=function(b2){var b3;function b4(){var b5;b5=null;return bz.Delay(function(){return bz.Bind(b2,function(){var b6;b6=b3[0];return w.Equals(b6,1)?(b3[0]=0,bz.Zero()):w.Equals(b6,2)?(b3[0]=1,b4()):bz.Zero();});});}b3=[0];return function(){var b5;b5=b3[0];if(w.Equals(b5,0)){b3[0]=1;bz.Start(b4(),null);}else w.Equals(b5,1)?b3[0]=2:void 0;};};bq.New=function(b2,b3,b4,b5){var b6;b6={DynElem:b2,DynFlags:b3,DynNodes:b4};bZ.SetOptional(b6,"OnAfterRender",b5);return b6;};br.ApplyValue=function(b2,b3,b4){var b5;function b6(b7,b8){return b8==null?null:b7(b8.$0);}b5=null;return[function(b7){function b8(){b4.UpdateMaybe(function(b9){var b_;b5=b2(b7);return b5!=null&&b5.$==1&&(!w.Equals(b5.$0,b9)&&(b_=[b5,b5.$0],true))?b_[0]:null;});}b7.addEventListener("change",b8);b7.addEventListener("input",b8);b7.addEventListener("keypress",b8);},function(b7){var b8;b8=b3(b7);return function(b9){return b6(b8,b9);};},q.Map(function(b7){var b8;return b5!=null&&b5.$==1&&(w.Equals(b5.$0,b7)&&(b8=b5.$0,true))?null:{$:1,$0:b7};},b4.get_View())];};br.StringSet=function(){bh.$cctor();return bh.StringSet;};br.StringGet=function(){bh.$cctor();return bh.StringGet;};br.DateTimeSetUnchecked=function(){bh.$cctor();return bh.DateTimeSetUnchecked;};br.DateTimeGetUnchecked=function(){bh.$cctor();return bh.DateTimeGetUnchecked;};br.FileApplyValue=function(b2,b3,b4){var b5;function b6(b7,b8){return b8==null?null:b7(b8.$0);}b5=null;return[function(b7){b7.addEventListener("change",function(){b4.UpdateMaybe(function(b8){var b9;b5=b2(b7);return b5!=null&&b5.$==1&&(b5.$0!==b8&&(b9=[b5,b5.$0],true))?b9[0]:null;});});},function(b7){var b8;b8=b3(b7);return function(b9){return b6(b8,b9);};},q.Map(function(b7){var b8;return b5!=null&&b5.$==1&&(w.Equals(b5.$0,b7)&&(b8=b5.$0,true))?null:{$:1,$0:b7};},b4.get_View())];};br.FileSetUnchecked=function(){bh.$cctor();return bh.FileSetUnchecked;};br.FileGetUnchecked=function(){bh.$cctor();return bh.FileGetUnchecked;};br.IntSetUnchecked=function(){bh.$cctor();return bh.IntSetUnchecked;};br.IntGetUnchecked=function(){bh.$cctor();return bh.IntGetUnchecked;};br.IntSetChecked=function(){bh.$cctor();return bh.IntSetChecked;};br.IntGetChecked=function(){bh.$cctor();return bh.IntGetChecked;};br.FloatSetUnchecked=function(){bh.$cctor();return bh.FloatSetUnchecked;};br.FloatGetUnchecked=function(){bh.$cctor();return bh.FloatGetUnchecked;};br.FloatSetChecked=function(){bh.$cctor();return bh.FloatSetChecked;};br.FloatGetChecked=function(){bh.$cctor();return bh.FloatGetChecked;};br.StringApply=function(){bh.$cctor();return bh.StringApply;};br.BoolCheckedApply=function(){bh.$cctor();return bh.BoolCheckedApply;};br.DateTimeApplyUnchecked=function(){bh.$cctor();return bh.DateTimeApplyUnchecked;};br.FileApplyUnchecked=function(){bh.$cctor();return bh.FileApplyUnchecked;};br.IntApplyChecked=function(){bh.$cctor();return bh.IntApplyChecked;};br.IntApplyUnchecked=function(){bh.$cctor();return bh.IntApplyUnchecked;};br.FloatApplyChecked=function(){bh.$cctor();return bh.FloatApplyChecked;};br.FloatApplyUnchecked=function(){bh.$cctor();return bh.FloatApplyUnchecked;};bs.isBlank=function(b2){return bu.forall(bD.IsWhiteSpace,b2);};bt=f.Updates=bZ.Class({},null,bt);bt.Create=function(b2){var b3;b3=null;b3=bt.New(b2,null,function(){var b4;b4=b3.s;return b4===null?(b4=E.Copy(b3.c()),b3.s=b4,E.WhenObsoleteRun(b4,function(){b3.s=null;}),b4):b4;});return b3;};bt.New=function(b2,b3,b4){return new bt({c:b2,s:b3,v:b4});};bu.concat=function(b2,b3){return n.ofSeq(b3).join(b2);};bu.SplitChars=function(b2,b3,b4){return bu.Split(b2,new a.RegExp("["+bu.RegexEscape(b3.join(""))+"]"),b4);};bu.StartsWith=function(b2,b3){return b2.substring(0,b3.length)==b3;};bu.forall=function(b2,b3){return Y.forall(b2,bu.protect(b3));};bu.Split=function(b2,b3,b4){return b4===1?n.filter(function(b5){return b5!=="";},bu.SplitWith(b2,b3)):bu.SplitWith(b2,b3);};bu.RegexEscape=function(b2){return b2.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};bu.protect=function(b2){return b2===null?"":b2;};bu.SplitWith=function(b2,b3){return b2.split(b3);};bv=L.ValueCollection=bZ.Class({GetEnumerator:function(){return _4.Get(Y.map(function(b2){return b2.V;},this.d));}},e,bv);bv.New=bZ.Ctor(function(b2){e.New.call(this);this.d=b2;},bv);bx.New=function(b2,b3){return{PreviousNodes:b2,Top:b3};};by.get_Empty=function(){return{$:0,$0:new _5.New$3()};};by.FindAll=function(b2){var b3;function b4(b7,b8){var b9,b_,b$,ca,cb;while(true)switch(b7){case 0:if(b8!=null&&b8.$==0){b_=b8.$1;b$=b8.$0;b4(0,b$);b8=b_;}else if(b8!=null&&b8.$==1){ca=b8.$0;b8=ca;b7=1;}else if(b8!=null&&b8.$==2){cb=b8.$0;b8=cb.Current;}else return b8!=null&&b8.$==6?(b9=b8.$0.Holes,(function(cc){return function(cd){n.iter(cc,cd);};}(b6))(b9)):null;break;case 1:b3.push(b8);b8=b8.Children;b7=0;break;}}function b5(b7){return b4(0,b7);}function b6(b7){return b4(1,b7);}b3=[];b5(b2);return{$:0,$0:new _5.New$2(b3)};};by.Filter=function(b2,b3){return{$:0,$0:bQ.Filter(b2,b3.$0)};};by.Except=function(b2,b3){return{$:0,$0:bQ.Except(b2.$0,b3.$0)};};by.ToArray=function(b2){return bQ.ToArray(b2.$0);};by.Intersect=function(b2,b3){return{$:0,$0:bQ.Intersect(b2.$0,b3.$0)};};bz.Delay=function(b2){return function(b3){try{(b2(null))(b3);}catch(b4){b3.k({$:1,$0:b4});}};};bz.Bind=function(b2,b3){return bz.checkCancel(function(b4){b2(bN.New(function(b5){var b6;if(b5.$==0){b6=b5.$0;bz.scheduler().Fork(function(){try{(b3(b6))(b4);}catch(b7){b4.k({$:1,$0:b7});}});}else bz.scheduler().Fork(function(){b4.k(b5);});},b4.ct));});};bz.Zero=function(){bO.$cctor();return bO.Zero;};bz.Start=function(b2,b3){var b4,b5;b4=(b5=(bz.defCTS())[0],b3==null?b5:b3.$0);bz.scheduler().Fork(function(){if(!b4.c)b2(bN.New(function(b6){if(b6.$==1)bz.UncaughtAsyncError(b6.$0);},b4));});};bz.Return=function(b2){return function(b3){b3.k({$:0,$0:b2});};};bz.scheduler=function(){bO.$cctor();return bO.scheduler;};bz.checkCancel=function(b2){return function(b3){if(b3.ct.c)bz.cancel(b3);else b2(b3);};};bz.defCTS=function(){bO.$cctor();return bO.defCTS;};bz.UncaughtAsyncError=function(b2){b0.log("WebSharper: Uncaught asynchronous exception",b2);};bz.FromContinuations=function(b2){return function(b3){var b4;function b5(b6){if(b4[0])i.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{b4[0]=true;bz.scheduler().Fork(b6);}}b4=[false];b2(function(b6){b5(function(){b3.k({$:0,$0:b6});});},function(b6){b5(function(){b3.k({$:1,$0:b6});});},function(b6){b5(function(){b3.k({$:2,$0:b6});});});};};bz.cancel=function(b2){b2.k({$:2,$0:new bT.New(b2.ct)});};bA.UseAnimations=function(){bH.$cctor();return bH.UseAnimations;};bA.Actions=function(b2){return bA.ConcatActions(n.choose(function(b3){return b3.$==1?{$:1,$0:b3.$0}:null;},bI.ToArray(b2.$0)));};bA.Finalize=function(b2){n.iter(function(b3){if(b3.$==0)b3.$0();},bI.ToArray(b2.$0));};bA.ConcatActions=function(b2){var b3,b4,b5,b6;b3=W.ofSeqNonCopying(b2);b4=n.length(b3);return b4===0?bA.Const():b4===1?n.get(b3,0):(b5=Y.max(Y.map(function(b7){return b7.Duration;},b3)),(b6=n.map(function(b7){return bA.Prolong(b5,b7);},b3),bA.Def(b5,function(b7){n.iter(function(b8){b8.Compute(b7);},b6);})));};bA.List=function(b2){return b2.$0;};bA.Const=function(b2){return bA.Def(0,function(){return b2;});};bA.Def=function(b2,b3){return{Compute:b3,Duration:b2};};bA.Prolong=function(b2,b3){var b4,b5,b6;b4=b3.Compute;b5=b3.Duration;b6=bU.Create(function(){return b3.Compute(b3.Duration);});return{Compute:function(b7){return b7>=b5?b6.f():b4(b7);},Duration:b2};};bB.$cctor=function(){bB.$cctor=a.ignore;bB.BatchUpdatesEnabled=true;};bC.concat=function(b2){var b3,b4;b3=[];for(var b5 in b2)b3.push.apply(b3,b2[b5]);return b3;};bD.IsWhiteSpace=function(b2){return b2.match(new a.RegExp("\\s"))!==null;};bE.TryParse=function(b2){var b3;b3=b1.parse(b2);return a.isNaN(b3)?null:{$:1,$0:b3};};_0.TryParse=function(b2,b3,b4,b5){var b6,b7;b6=+b2;b7=b6===b6-b6%1&&b6>=b3&&b6<=b4;if(b7)b5.set(b6);return b7;};bF.Clear=function(b2){b2.splice(0,n.length(b2));};bG.$cctor=function(){var b2;bG.$cctor=a.ignore;bG.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bG.rtagName=new a.RegExp("<([\\w:]+)");bG.rhtml=new a.RegExp("<|&#?\\w+;");bG.wrapMap=(b2=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:b2,tbody:b2,tfoot:b2,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bG.defaultWrap=[0,"",""];};bH.$cctor=function(){bH.$cctor=a.ignore;bH.CubicInOut=bM.Custom(function(b2){var b3;b3=b2*b2;return 3*b3-2*(b3*b2);});bH.UseAnimations=true;};bI.Append=function(b2,b3){return b2.$==0?b3:b3.$==0?b2:{$:2,$0:b2,$1:b3};};bI.ToArray=function(b2){var b3;function b4(b5){var b6,b7;while(true)if(b5.$==1)return b3.push(b5.$0);else if(b5.$==2){b6=b5.$1;b7=b5.$0;b4(b7);b5=b6;}else return b5.$==3?n.iter(function(b8){b3.push(b8);},b5.$0):null;}b3=[];b4(b2);return b3.slice(0);};bI.Concat=function(b2){var b3;b3=W.ofSeqNonCopying(b2);return W.TreeReduce(bI.Empty(),bI.Append,b3);};bI.Empty=function(){bV.$cctor();return bV.Empty;};bJ=d.KeyNotFoundException=bZ.Class({},N,bJ);bJ.New=bZ.Ctor(function(){bJ.New$1.call(this,"The given key was not present in the dictionary.");},bJ);bJ.New$1=bZ.Ctor(function(b2){this.message=b2;_1.setPrototypeOf(this,bJ.prototype);},bJ);bK=d.ArgumentException=bZ.Class({},N,bK);bK.New$2=bZ.Ctor(function(b2){this.message=b2;_1.setPrototypeOf(this,bK.prototype);},bK);bL=bz.Scheduler=bZ.Class({Fork:function(b2){var b3;b3=this;this.robin.push(b2);if(this.idle){this.idle=false;a.setTimeout(function(){b3.tick();},0);}},tick:function(){var b2,b3,b4;b3=this;b4=b1.now();b2=true;while(b2)if(this.robin.length===0){this.idle=true;b2=false;}else{(this.robin.shift())();b1.now()-b4>40?(a.setTimeout(function(){b3.tick();},0),b2=false):void 0;}}},e,bL);bL.New=bZ.Ctor(function(){e.New.call(this);this.idle=true;this.robin=[];},bL);bM=f.Easing=bZ.Class({},e,bM);bM.Custom=function(b2){return new bM.New(b2);};bM.New=bZ.Ctor(function(b2){e.New.call(this);this.transformTime=b2;},bM);bN.New=function(b2,b3){return{k:b2,ct:b3};};bO.$cctor=function(){bO.$cctor=a.ignore;bO.noneCT=bP.New(false,[]);bO.scheduler=new bL.New();bO.defCTS=[new bR.New()];bO.Zero=bz.Return();bO.GetCT=function(b2){b2.k({$:0,$0:b2.ct});};};bP.New=function(b2,b3){return{c:b2,r:b3};};bQ.Filter=function(b2,b3){return new _5.New$2(n.filter(b2,bQ.ToArray(b3)));};bQ.Except=function(b2,b3){var b4;b4=new _5.New$2(bQ.ToArray(b3));b4.ExceptWith(bQ.ToArray(b2));return b4;};bQ.ToArray=function(b2){var b3;b3=n.create(b2.Count(),void 0);b2.CopyTo(b3,0);return b3;};bQ.Intersect=function(b2,b3){var b4;b4=new _5.New$2(bQ.ToArray(b2));b4.IntersectWith(bQ.ToArray(b3));return b4;};bR=d.CancellationTokenSource=bZ.Class({},e,bR);bR.New=bZ.Ctor(function(){e.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bR);bS.Children=function(b2,b3){var b4,b5,b6;if(b3!=null&&b3.$==1){b6=[];b4=b3.$0[0].nextSibling;while(b4!==b3.$0[1]){b6.push(b4);b4=b4.nextSibling;}return{$:0,$0:b6};}else return{$:0,$0:n.init(b2.childNodes.length,(b5=b2.childNodes,function(b7){return b5[b7];}))};};bS.Except=function(b2,b3){var b4;b4=b2.$0;return{$:0,$0:n.filter(function(b5){return n.forall(function(b6){return!(b5===b6);},b4);},b3.$0)};};bS.Iter=function(b2,b3){n.iter(b2,b3.$0);};bS.DocChildren=function(b2){var b3;function b4(b5){var b6,b7,b8,b9;while(true){if(b5!=null&&b5.$==2){b7=b5.$0;b5=b7.Current;}else if(b5!=null&&b5.$==1)return b3.push(b5.$0.El);else if(b5==null)return null;else if(b5!=null&&b5.$==5)return b3.push(b5.$0);else if(b5!=null&&b5.$==4)return b3.push(b5.$0.Text);else if(b5!=null&&b5.$==6){b6=b5.$0.Els;return(function(b_){return function(b$){n.iter(b_,b$);};}(function(b_){if(b_==null||b_.constructor===_1)b4(b_);else b3.push(b_);}))(b6);}else{b8=b5.$1;b9=b5.$0;b4(b9);b5=b8;}}}b3=[];b4(b2.Children);return{$:0,$0:W.ofSeqNonCopying(b3)};};bT=d.OperationCanceledException=bZ.Class({},N,bT);bT.New=bZ.Ctor(function(b2){bT.New$1.call(this,"The operation was canceled.",null,b2);},bT);bT.New$1=bZ.Ctor(function(b2,b3,b4){this.message=b2;this.inner=b3;_1.setPrototypeOf(this,bT.prototype);this.ct=b4;},bT);bU.Create=function(b2){return bX.New(false,b2,bU.forceLazy);};bU.forceLazy=function(){var b2;b2=this.v();this.c=true;this.v=b2;this.f=bU.cachedLazy;return b2;};bU.cachedLazy=function(){return this.v;};bV.$cctor=function(){bV.$cctor=a.ignore;bV.Empty={$:0};};bX.New=function(b2,b3,b4){return{c:b2,v:b3,f:b4};};bZ.OnLoad(function(){c.Main();});}(self));


if (typeof WebSharper !=='undefined') {
  WebSharper.Runtime.ScriptBasePath = '/Content/';
  WebSharper.Runtime.Start();
}
