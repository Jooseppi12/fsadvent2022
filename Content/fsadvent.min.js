(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.WebSharper={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return WebSharper.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:WebSharper.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},MarkResizable:function(n){return Object.defineProperty(n,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},MarkReadOnly:function(n){return Object.defineProperty(n,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.WebSharper.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW;b=a.fsadvent=a.fsadvent||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.Obj=d.Obj||{};f=d.UI=d.UI||{};g=f.Var$1=f.Var$1||{};h=d.List=d.List||{};i=h.T=h.T||{};j=d.Operators=d.Operators||{};k=f.Templating=f.Templating||{};l=k.Runtime=k.Runtime||{};m=l.Server=l.Server||{};n=m.TemplateInstance=m.TemplateInstance||{};o=d.Arrays=d.Arrays||{};p=m.ProviderBuilder=m.ProviderBuilder||{};q=f.Var=f.Var||{};r=f.View=f.View||{};s=d.JavaScript=d.JavaScript||{};t=s.JS=s.JS||{};u=a.EventTarget;v=a.Node;w=a.Element;x=a.HTMLElement;y=s.Pervasives=s.Pervasives||{};z=c.Dart=c.Dart||{};A=m.Handler=m.Handler||{};B=d.Unchecked=d.Unchecked||{};C=a.fsadvent_Templates=a.fsadvent_Templates||{};D=f.ConcreteVar=f.ConcreteVar||{};E=f.Snap=f.Snap||{};F=f.AttrProxy=f.AttrProxy||{};G=a.System=a.System||{};H=G.Guid=G.Guid||{};I=f.AttrModule=f.AttrModule||{};J=a.StartupCode$fsadvent$Client=a.StartupCode$fsadvent$Client||{};K=d.Collections=d.Collections||{};L=K.FSharpMap=K.FSharpMap||{};M=f.Doc=f.Doc||{};N=d.Utils=d.Utils||{};O=f.Client=f.Client||{};P=O.Templates=O.Templates||{};Q=f.Abbrev=f.Abbrev||{};R=Q.Fresh=Q.Fresh||{};S=K.Dictionary=K.Dictionary||{};T=f.Array=f.Array||{};U=f.Attrs=f.Attrs||{};V=d.Seq=d.Seq||{};W=K.Map=K.Map||{};X=a.WindowOrWorkerGlobalScope;Y=d.Numeric=d.Numeric||{};Z=a.Object;_0=K.Pair=K.Pair||{};_1=K.BalancedTree=K.BalancedTree||{};_2=d.Enumerator=d.Enumerator||{};_3=K.HashSet=K.HashSet||{};_4=m.TemplateInitializer=m.TemplateInitializer||{};_5=_2.T=_2.T||{};_6=f.CheckedInput=f.CheckedInput||{};_7=f.DynamicAttrNode=f.DynamicAttrNode||{};_8=_1.Tree=_1.Tree||{};_9=K.DictionaryUtil=K.DictionaryUtil||{};_=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};$=f.Docs=f.Docs||{};ba=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bb=f.DocElemNode=f.DocElemNode||{};bc=a.CharacterData;bd=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};be=f.DomUtility=f.DomUtility||{};bf=f.Elt=f.Elt||{};bg=P.Prepare=P.Prepare||{};bh=d.Slice=d.Slice||{};bi=K.KeyCollection=K.KeyCollection||{};bj=f.An=f.An||{};bk=O.Settings=O.Settings||{};bl=Q.Mailbox=Q.Mailbox||{};bm=O.Attrs=O.Attrs||{};bn=bm.Dyn=bm.Dyn||{};bo=f.BindVar=f.BindVar||{};bp=f.String=f.String||{};bq=d.Strings=d.Strings||{};br=f.Updates=f.Updates||{};bs=K.ValueCollection=K.ValueCollection||{};bt=O.Docs=O.Docs||{};bu=bt.RunState=bt.RunState||{};bv=bt.NodeSet=bt.NodeSet||{};bw=d.Concurrency=d.Concurrency||{};bx=f.Anims=f.Anims||{};by=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bz=K.HashSetUtil=K.HashSetUtil||{};bA=d.Char=d.Char||{};bB=d.Queue=d.Queue||{};bC=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bD=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bE=f.AppendList=f.AppendList||{};bF=bw.Scheduler=bw.Scheduler||{};bG=f.Easing=f.Easing||{};bH=bw.AsyncBody=bw.AsyncBody||{};bI=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bJ=bw.CT=bw.CT||{};bK=Q.HashSet=Q.HashSet||{};bL=d.CancellationTokenSource=d.CancellationTokenSource||{};bM=bt.DomNodes=bt.DomNodes||{};bN=a.Error;bO=d.OperationCanceledException=d.OperationCanceledException||{};bP=d.Lazy=d.Lazy||{};bQ=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bR=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};bS=bR.LazyRecord=bR.LazyRecord||{};bT=a.Math;bU=d&&d.Runtime;bV=a.console;bW=a.Date;c.Main=function(){var bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf;bX=g.Create$1(null);bY=g.Create$1(1);bZ=g.Create$1(false);b0=g.Create$1(i.Empty);b1=(b2=(b3=M.SelectDynOptional([],"None",function(cg){return c.PrettyPrintDartsSet(cg[0],cg[1],cg[2]);},b0.get_View(),bX),(b4=(b5=(b6=r.Map(function(cg){return cg!=null&&cg.$==1?z.AsDartNotation(cg.$0[2]):"";},bX.get_View()),(b7=(b8=r.Map(function(cg){return cg!=null&&cg.$==1?z.AsDartNotation(cg.$0[1]):"";},bX.get_View()),(b9=(b_=r.Map(function(cg){return cg!=null&&cg.$==1?z.AsDartNotation(cg.$0[0]):"";},bX.get_View()),(b$=(ca=(cb=(cc=h.ofArray([I.DynamicCustom(function(cg){return function(ch){r.Get(function(ci){if(ci!=null&&ci.$==1){a.clearInterval(ci.$0);c.animationHandle().Set(null);}},c.animationHandle().get_View());return c.highlightDartboard(cg.getContext("2d"),ch);};},bX.get_View()),I.OnAfterRender(function(cg){c.drawDartboard(cg.getContext("2d"),z.Nil);})]),(cd=new p.New$1(),(cd.h.push({$:3,$0:"canvasattr",$1:F.Concat(cc)}),cd))),(cb.h.push({$:11,$0:"isitcheckout",$1:bZ}),cb)),(ca.h.push({$:13,$0:"selectednumber",$1:bY}),ca)),(b$.h.push({$:2,$0:"selected1",$1:b_}),b$))),(b9.h.push({$:2,$0:"selected2",$1:b8}),b9))),(b7.h.push({$:2,$0:"selected3",$1:b6}),b7))),(b5.h.push(A.EventQ2(b5.k,"calculate",function(){return b5.i;},function(){r.Get(function(cg){r.Get(function(ch){var ci;r.Get(function(cj){if(cj!=null&&cj.$==1){a.clearInterval(cj.$0);c.animationHandle().Set(null);}},c.animationHandle().get_View());ci=c.getCombinationsFor(cg,ch);if(ci.get_Length()===0)a.alert(a.String(cg)+" cannot be reached with 3 darts! Please try a different number.");b0.Set(ci);bX.Set(null);},bZ.get_View());},bY.get_View());})),b5)),(b4.h.push({$:0,$0:"selectionbox",$1:b3}),b4))),(ce=A.CompleteHoles(b2.k,b2.h,[["selectednumber",1,null],["isitcheckout",2,null]]),(cf=new n.New(ce[1],C.main(ce[0])),b2.i=cf,cf))).get_Doc();P.LoadLocalTemplates("");M.RunById("main",b1);};c.animationHandle=function(){J.$cctor();return J.animationHandle;};c.highlightDartboard=function(bX,bY){var bZ,b0,b1,b2;if(bY!=null&&bY.$==1){bZ=bY.$0[2];b0=bY.$0[1];b1=bY.$0[0];b2=1;c.animationHandle().Set({$:1,$0:a.setInterval(function(){var b3;b3=self.document.querySelector("span.highlighted");if(b3!==null)b3.classList.remove("highlighted");c.drawDartboard(bX,b2===1?b1:b2===2?b0:bZ);self.document.getElementById("dart"+a.String(b2)).classList.add("highlighted");if(b2===3)b2=1;else b2=b2+1;},1000)});}else c.drawDartboard(bX,z.Nil);};c.drawDartboard=function(bX,bY){var bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd;b2="#61bff9";c.resetBoard(bX);b3=c.WIDTH()/2-10;b4=b3*0.75;c.renderCircle(bX,b3,"#11191f");b5=h.indexed(c.dartRingNumbers());b6=_2.Get(b5);try{while(b6.MoveNext()){b7=b6.Current();b8=b7[1];b9=b7[0];b_=bY.$==1&&(b8===bY.$0&&(b$=bY.$0,true))?b2:b9%2===0?"#e63322":"#389536";ca=bY.$==0&&(b8===bY.$0&&(cb=bY.$0,true))?b2:b9%2===0?"#e63322":"#389536";cc=bY.$==2&&(b8===bY.$0&&(cd=bY.$0,true))?b2:b9%2===0?"#171918":"#f7e0b6";c.renderSector(bX,b4,b_,b9);c.renderSector(bX,b4*0.953,cc,b9);c.renderSector(bX,b4*0.694,ca,b9);c.renderSector(bX,b4*0.629,cc,b9);c.renderLabel(bX,b8,b9);}}finally{if(typeof b6=="object"&&"Dispose"in b6)b6.Dispose();}b0=B.Equals(bY,{$:2,$0:25})?b2:"#389536";b1=B.Equals(bY,{$:1,$0:25})?b2:"#e63322";c.renderCircle(bX,b4*0.094,b0);c.renderCircle(bX,b4*0.037,b1);};c.getCombinationsFor=function(bX,bY){function bZ(b1,b2,b3){var b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd;b8=(b4=null,[c.scoringValues().TryGetValue(b1,{get:function(){return b4;},set:function(ce){b4=ce;}}),b4]);b9=(b5=null,[c.scoringValues().TryGetValue(b2,{get:function(){return b5;},set:function(ce){b5=ce;}}),b5]);b_=(b6=null,[c.scoringValues().TryGetValue(b3,{get:function(){return b6;},set:function(ce){b6=ce;}}),b6]);switch(b8[0]?b9[0]?b9[1].$==1?b9[1].$0.$==3?b9[1].$1.$==0?b_[0]?b_[1].$==1?b_[1].$0.$==3?b_[1].$1.$==0?(b7=b8[1],0):(b7=[b8[1],b9[1],b_[1]],2):(b7=[b8[1],b9[1],b_[1]],2):(b7=[b8[1],b9[1],b_[1]],2):3:b_[0]?b_[1].$==1?b_[1].$0.$==3?b_[1].$1.$==0?(b7=[b8[1],b9[1]],1):(b7=[b8[1],b9[1],b_[1]],2):(b7=[b8[1],b9[1],b_[1]],2):(b7=[b8[1],b9[1],b_[1]],2):3:b_[0]?b_[1].$==1?b_[1].$0.$==3?b_[1].$1.$==0?(b7=[b8[1],b9[1]],1):(b7=[b8[1],b9[1],b_[1]],2):(b7=[b8[1],b9[1],b_[1]],2):(b7=[b8[1],b9[1],b_[1]],2):3:b_[0]?b_[1].$==1?b_[1].$0.$==3?b_[1].$1.$==0?(b7=[b8[1],b9[1]],1):(b7=[b8[1],b9[1],b_[1]],2):(b7=[b8[1],b9[1],b_[1]],2):(b7=[b8[1],b9[1],b_[1]],2):3:3:3){case 0:return bY?h.map(function(ce){return[ce,z.Nil,z.Nil];},h.filter(z.IsCheckout,b7)):h.map(function(ce){return[ce,z.Nil,z.Nil];},b7);case 1:b$=b7[0];ca=b7[1];return bY?h.collect(function(ce){return h.map(function(cf){return[ce,cf,z.Nil];},h.filter(z.IsCheckout,ca));},b$):h.collect(function(ce){return h.map(function(cf){return[ce,cf,z.Nil];},ca);},b$);case 2:cb=b7[0];cc=b7[1];cd=b7[2];return bY?h.collect(function(ce){return h.collect(function(cf){return h.map(function(cg){return[ce,cf,cg];},h.filter(z.IsCheckout,cd));},cc);},cb):h.collect(function(ce){return h.collect(function(cf){return h.map(function(cg){return[ce,cf,cg];},cd);},cc);},cb);case 3:return i.Empty;}}function b0(b1,b2){return h.choose(function(b3){return b3===0&&b2!==0?null:b2-b3<0?null:b2-b3===0&&bY&&b3%2===0?{$:1,$0:[b1,b3,b2-b3]}:b2-b3===0&&bY?null:c.scoringValues().ContainsKey(b2-b3)&&(!bY||(b2-b3)%2===0)?{$:1,$0:[b1,b3,b2-b3]}:null;},h.ofSeq(c.scoringValues().get_Keys()));}return h.collect(function(b1){return bZ(b1[0],b1[1],b1[2]);},h.collect(function(b1){return b0(b1[0],b1[1]);},h.choose(function(b1){return b1===0&&bX!==0?null:bX-b1<0?null:bY&&bX-b1===0&&b1%2===0?{$:1,$0:[b1,bX-b1]}:bY&&bX-b1===0?null:{$:1,$0:[b1,bX-b1]};},h.ofSeq(c.scoringValues().get_Keys()))));};c.PrettyPrintDartsSet=function(bX,bY,bZ){var b0;switch(bY.$==3?bZ.$==3?0:(b0=[bX,bY,bZ],2):bZ.$==3?1:(b0=[bX,bY,bZ],2)){case 0:return N.toSafe(z.AsDartNotation(bX));case 1:return N.toSafe(z.AsDartNotation(bX))+" - "+N.toSafe(z.AsDartNotation(bY));case 2:return N.toSafe(z.AsDartNotation(b0[0]))+" - "+N.toSafe(z.AsDartNotation(b0[1]))+" - "+N.toSafe(z.AsDartNotation(b0[2]));}};c.resetBoard=function(bX){bX.clearRect(0,0,c.WIDTH(),c.HEIGHT());};c.WIDTH=function(){J.$cctor();return J.WIDTH;};c.renderCircle=function(bX,bY,bZ){bX.beginPath();bX.arc(c.WIDTH()/2,c.HEIGHT()/2,bY,0,2*bT.PI,false);bX.lineWidth=1;bX.strokeStyle=bZ;bX.fillStyle=bZ;bX.fill();bX.stroke();};c.renderSector=function(bX,bY,bZ,b0){var b1,b2,b3;b1=-99+b0*18;b2=c.convertToRadian(b1);b3=c.convertToRadian(b1+18);bX.beginPath();bX.moveTo(c.WIDTH()/2,c.HEIGHT()/2);bX.arc(c.WIDTH()/2,c.HEIGHT()/2,bY,b2,b3,false);bX.lineWidth=1;bX.strokeStyle=bZ;bX.lineTo(c.WIDTH()/2,c.HEIGHT()/2);bX.fillStyle=bZ;bX.fill();bX.stroke();};c.renderLabel=function(bX,bY,bZ){bX.save();bX.strokeStyle="white";bX.fillStyle="white";bX.font="30px Arial";bX.textAlign="center";bX.translate(c.WIDTH()/2,c.HEIGHT()/2);bZ>5&&bZ<10?bX.rotate(c.convertToRadian((20+bZ-10)*18)):bZ===10?bX.rotate(c.convertToRadian(0)):bZ>10&&bZ<15?bX.rotate(c.convertToRadian((bZ-10)*18)):bX.rotate(c.convertToRadian(bZ*18));bX.fillText(a.String(bY),0,bZ>5&&bZ<15?c.HEIGHT()/2*0.85+15:-c.HEIGHT()/2*0.85);bX.restore();};c.dartRingNumbers=function(){J.$cctor();return J.dartRingNumbers;};c.scoringValues=function(){J.$cctor();return J.scoringValues;};c.HEIGHT=function(){J.$cctor();return J.HEIGHT;};c.convertToRadian=function(bX){return bX*bT.PI/180;};e=d.Obj=bU.Class({Equals:function(bX){return this===bX;},GetHashCode:function(){return -1;}},null,e);e.New=bU.Ctor(function(){},e);g=f.Var$1=bU.Class({},e,g);g.Create$1=function(bX){return new D.New(false,E.New({$:2,$0:bX,$1:[]}),bX);};i=h.T=bU.Class({get_Length:function(){return h.length(this);},get_Item:function(bX){return V.nth(bX,this);},GetEnumerator:function(){return new _5.New(this,null,function(bX){var bY;bY=bX.s;return bY.$==0?false:(bX.c=bY.$0,bX.s=bY.$1,true);},void 0);}},null,i);i.Empty=new i({$:0});j.FailWith=function(bX){throw new bN(bX);};j.range=function(bX,bY){var bZ;bZ=1+bY-bX;return bZ<=0?[]:V.init(bZ,function(b0){return b0+bX;});};j.KeyValue=function(bX){return[bX.K,bX.V];};n=m.TemplateInstance=bU.Class({get_Doc:function(){return this.doc;}},e,n);n.New=bU.Ctor(function(bX,bY){e.New.call(this);this.doc=bY;this.allVars=bX.$==0?bX.$0:j.FailWith("Should not happen");},n);o.get=function(bX,bY){o.checkBounds(bX,bY);return bX[bY];};o.length=function(bX){return bX.dims===2?bX.length*bX.length:bX.length;};o.checkBounds=function(bX,bY){if(bY<0||bY>=bX.length)j.FailWith("Index was outside the bounds of the array.");};o.set=function(bX,bY,bZ){o.checkBounds(bX,bY);bX[bY]=bZ;};p=m.ProviderBuilder=bU.Class({},e,p);p.New$1=bU.Ctor(function(){var bX;e.New.call(this);this.i=null;this.k=(bX=H.NewGuid(),a.String(bX));this.h=bU.MarkResizable([]);bU.SetOptional(this,"s",null);},p);h.ofArray=function(bX){var bY,bZ,b0;bY=i.Empty;for(bZ=o.length(bX)-1,b0=0;bZ>=b0;bZ--)bY=new i({$:1,$0:o.get(bX,bZ),$1:bY});return bY;};h.indexed=function(bX){return h.mapi(function(bY,bZ){return[bY,bZ];},bX);};h.ofSeq=function(bX){var bY,bZ,b0,b1,b2,b3;if(bX instanceof i)return bX;else if(bX instanceof a.Array)return h.ofArray(bX);else{bY=_2.Get(bX);try{b0=bY.MoveNext();if(!b0)bZ=i.Empty;else{b2=new i({$:1});b1=b2;while(b0){b1.$0=bY.Current();if(bY.MoveNext())b1=(b3=new i({$:1}),b1.$1=b3,b3);else b0=false;}b1.$1=i.Empty;bZ=b2;}return bZ;}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}}};h.choose=function(bX,bY){return h.ofSeq(V.choose(bX,bY));};h.collect=function(bX,bY){return h.ofSeq(V.collect(bX,bY));};h.filter=function(bX,bY){var bZ,b0,b1,b2,b3,b4;if(bY.$==0)return bY;else{bZ=i.Empty;b0=bZ;b1=bY;b2=true;while(b2){if(bX(b1.$0)){bZ.$==0?(bZ=new i({$:1}),b0=bZ):b0=(b3=new i({$:1}),b0.$1=b3,b3);b4=b1.$0;b0.$=1;b0.$0=b4;}b1=b1.$1;if(b1.$==0)b2=false;}if(!(bZ.$==0))b0.$1=i.Empty;return bZ;}};h.map=function(bX,bY){var bZ,b0,b1,b2,b3;if(bY.$==0)return bY;else{b2=new i({$:1});bZ=b2;b0=bY;b1=true;while(b1){bZ.$0=bX(b0.$0);b0=b0.$1;if(b0.$==0)b1=false;else bZ=(b3=new i({$:1}),bZ.$1=b3,b3);}bZ.$1=i.Empty;return b2;}};h.length=function(bX){var bY,bZ;bY=bX;bZ=0;while(bY.$==1){bY=h.tail(bY);bZ=bZ+1;}return bZ;};h.groupBy=function(bX,bY){var bZ;function b0(b1,b2){return[b1,h.ofArray(b2)];}bZ=o.groupBy(bX,o.ofList(bY));o.mapInPlace(function(b1){return b0(b1[0],b1[1]);},bZ);return h.ofArray(bZ);};h.mapi=function(bX,bY){var bZ,b0,b1,b2,b3,b4;if(bY.$==0)return bY;else{b3=new i({$:1});bZ=b3;b0=bY;b1=0;b2=true;while(b2){bZ.$0=bX(b1,b0.$0);b0=b0.$1;if(b0.$==0)b2=false;else{bZ=(b4=new i({$:1}),bZ.$1=b4,b4);b1=b1+1;}}bZ.$1=i.Empty;return b3;}};h.tail=function(bX){return bX.$==1?bX.$1:h.listEmpty();};h.listEmpty=function(){return j.FailWith("The input list was empty.");};h.head=function(bX){return bX.$==1?bX.$0:h.listEmpty();};q=f.Var=bU.Class({},e,q);q.New=bU.Ctor(function(){e.New.call(this);},q);r.Get=function(bX,bY){var bZ;function b0(){E.WhenRun(bY(),function(b1){if(!bZ[0]){bZ[0]=true;bX(b1);}},function(){if(!bZ[0])b0();});}bZ=[false];b0();};r.Map=function(bX,bY){return r.CreateLazy(function(){return E.Map(bX,bY());});};r.CreateLazy=function(bX){var bY;bY={c:null,o:bX};return function(){var bZ,b0;bZ=bY.c;return bZ===null?(bZ=bY.o(),bY.c=bZ,(b0=bZ.s,b0!=null&&b0.$==0)?bY.o=null:E.WhenObsoleteRun(bZ,function(){bY.c=null;}),bZ):bZ;};};r.MapSeqCached=function(bX,bY){return r.MapSeqCachedBy(a.id,bX,bY);};r.Const=function(bX){var bY;bY=E.New({$:0,$0:bX});return function(){return bY;};};r.Sink=function(bX,bY){function bZ(){E.WhenRun(bY(),bX,function(){bw.scheduler().Fork(bZ);});}bw.scheduler().Fork(bZ);};r.MapSeqCachedBy=function(bX,bY,bZ){var b0;b0=[new S.New$5()];return r.Map(function(b1){var b2,b3,b4;b2=b0[0];b3=new S.New$5();b4=T.mapInPlace(function(b5){var b6,b7;b6=bX(b5);b7=b2.ContainsKey(b6)?b2.Item(b6):bY(b5);b3.set_Item(b6,b7);return b7;},o.ofSeq(b1));b0[0]=b3;return b4;},bZ);};r.Map3=function(bX,bY,bZ,b0){return r.CreateLazy(function(){return E.Map3(bX,bY(),bZ(),b0());});};r.Sequence=function(bX){return r.CreateLazy(function(){return E.Sequence(V.map(function(bY){return bY();},bX));});};r.Map2=function(bX,bY,bZ){return r.CreateLazy(function(){return E.Map2(bX,bY(),bZ());});};r.Map2Unit=function(bX,bY){return r.CreateLazy(function(){return E.Map2Unit(bX(),bY());});};r.Bind=function(bX,bY){return r.Join(r.Map(bX,bY));};r.Join=function(bX){return r.CreateLazy(function(){return E.Join(bX());});};t.GetFieldValues=function(bX){var bY,bZ;bY=[];for(var b0 in bX)bY.push(bX[b0]);return bY;};y.NewFromSeq=function(bX){var bY,bZ,b0;bY={};bZ=_2.Get(bX);try{while(bZ.MoveNext()){b0=bZ.Current();bY[b0[0]]=b0[1];}}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}return bY;};z.Nil={$:3};z.AsDartNotation=function(bX){var bY;return bX.$==1?(bY=bX.$0,bY===25?"Bull":"D"+a.String(bY)):bX.$==2?a.String(bX.$0):bX.$==3?"":"T"+a.String(bX.$0);};z.IsCheckout=function(bX){return bX.$==1;};z.AsScore=function(bX){return bX.$==1?2*bX.$0:bX.$==2?bX.$0:bX.$==3?0:3*bX.$0;};r=f.View=bU.Class({},null,r);A.EventQ2=function(bX,bY,bZ,b0){return{$:5,$0:bY,$1:function(b1){return function(b2){return b0({Vars:bZ(),Target:b1,Event:b2});};}};};A.CompleteHoles=function(bX,bY,bZ){var b1,b2,b3,b4,b5;function b0(b6,b7,b8){var b9;return b2.Contains(b6)?null:(b9=B.Equals(b7,0)?_4.GetOrAddHoleFor(bX,b6,function(){return{$:10,$0:b6,$1:g.Create$1("")};}):B.Equals(b7,1)?_4.GetOrAddHoleFor(bX,b6,function(){return{$:15,$0:b6,$1:g.Create$1(0)};}):B.Equals(b7,2)?_4.GetOrAddHoleFor(bX,b6,function(){return{$:11,$0:b6,$1:g.Create$1(false)};}):j.FailWith("Invalid value type"),(b1.set_Item(b6,b9),{$:1,$0:b9}));}b1=new S.New$5();b2=new _3.New$3();b3=_2.Get(bY);try{while(b3.MoveNext()){b4=b3.Current();b5=b4.$0;b2.SAdd(b5);b1.set_Item(b5,b4);}}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}return[V.append(bY,o.choose(function(b6){return b0(b6[0],b6[1],b6[2]);},bZ)),{$:0,$0:b1}];};B.Equals=function(bX,bY){var bZ,b0,b1,b2;if(bX===bY)return true;else{bZ=typeof bX;if(bZ=="object"){if(bX===null||bX===void 0||bY===null||bY===void 0||!B.Equals(typeof bY,"object"))return false;else if("Equals"in bX)return bX.Equals(bY);else if("Equals"in bY)return false;else if(bX instanceof a.Array&&bY instanceof a.Array)return B.arrayEquals(bX,bY);else if(bX instanceof a.Date&&bY instanceof a.Date)return B.dateEquals(bX,bY);else{b0=[true];for(var b3 in bX)if(function(b4){b0[0]=!bX.hasOwnProperty(b4)||bY.hasOwnProperty(b4)&&B.Equals(bX[b4],bY[b4]);return!b0[0];}(b3))break;if(b0[0]){for(var b4 in bY)if(function(b5){b0[0]=!bY.hasOwnProperty(b5)||bX.hasOwnProperty(b5);return!b0[0];}(b4))break;}return b0[0];}}else return bZ=="function"&&("$Func"in bX?bX.$Func===bY.$Func&&bX.$Target===bY.$Target:"$Invokes"in bX&&"$Invokes"in bY&&B.arrayEquals(bX.$Invokes,bY.$Invokes));}};B.arrayEquals=function(bX,bY){var bZ,b0;if(o.length(bX)===o.length(bY)){bZ=true;b0=0;while(bZ&&b0<o.length(bX)){!B.Equals(o.get(bX,b0),o.get(bY,b0))?bZ=false:void 0;b0=b0+1;}return bZ;}else return false;};B.dateEquals=function(bX,bY){return bX.getTime()===bY.getTime();};B.Hash=function(bX){var bY;bY=typeof bX;return bY=="function"?0:bY=="boolean"?bX?1:0:bY=="number"?bX:bY=="string"?B.hashString(bX):bY=="object"?bX==null?0:bX instanceof a.Array?B.hashArray(bX):B.hashObject(bX):0;};B.Compare=function(bX,bY){var bZ,b0,b1,b2,b3,b4;if(bX===bY)return 0;else{b0=typeof bX;switch(b0=="function"?1:b0=="boolean"?2:b0=="number"?2:b0=="string"?2:b0=="object"?3:0){case 0:return typeof bY=="undefined"?0:-1;case 1:return j.FailWith("Cannot compare function values.");case 2:return bX<bY?-1:1;case 3:if(bX===null)b1=-1;else if(bY===null)b1=1;else if("CompareTo"in bX)b1=bX.CompareTo(bY);else if("CompareTo0"in bX)b1=bX.CompareTo0(bY);else if(bX instanceof a.Array&&bY instanceof a.Array)b1=B.compareArrays(bX,bY);else if(bX instanceof a.Date&&bY instanceof a.Date)b1=B.compareDates(bX,bY);else{b2=[0];for(var b5 in bX)if(function(b6){return!bX.hasOwnProperty(b6)?false:!bY.hasOwnProperty(b6)?(b2[0]=1,true):(b2[0]=B.Compare(bX[b6],bY[b6]),b2[0]!==0);}(b5))break;if(b2[0]===0){for(var b6 in bY)if(function(b7){return!bY.hasOwnProperty(b7)?false:!bX.hasOwnProperty(b7)&&(b2[0]=-1,true);}(b6))break;}b1=b2[0];}return b1;}}};B.hashString=function(bX){var bY,bZ,b0;if(bX===null)return 0;else{bY=5381;for(bZ=0,b0=bX.length-1;bZ<=b0;bZ++)bY=B.hashMix(bY,bX[bZ].charCodeAt());return bY;}};B.hashArray=function(bX){var bY,bZ,b0;bY=-34948909;for(bZ=0,b0=o.length(bX)-1;bZ<=b0;bZ++)bY=B.hashMix(bY,B.Hash(o.get(bX,bZ)));return bY;};B.hashObject=function(bX){var bY,bZ;if("GetHashCode"in bX)return bX.GetHashCode();else{bY=[0];for(var b0 in bX)if(function(b1){bY[0]=B.hashMix(B.hashMix(bY[0],B.hashString(b1)),B.Hash(bX[b1]));return false;}(b0))break;return bY[0];}};B.compareArrays=function(bX,bY){var bZ,b0;if(o.length(bX)<o.length(bY))return -1;else if(o.length(bX)>o.length(bY))return 1;else{bZ=0;b0=0;while(bZ===0&&b0<o.length(bX)){bZ=B.Compare(o.get(bX,b0),o.get(bY,b0));b0=b0+1;}return bZ;}};B.compareDates=function(bX,bY){return B.Compare(bX.getTime(),bY.getTime());};B.hashMix=function(bX,bY){return(bX<<5)+bX+bY;};C.main=function(bX){P.LoadLocalTemplates("index");return bX?P.NamedTemplate("index",{$:1,$0:"main"},bX):void 0;};D=f.ConcreteVar=bU.Class({get_View:function(){return this.view;},Set:function(bX){if(this.isConst)(function(bY){return bY("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(bY){bV.log(bY);}));else{E.Obsolete(this.snap);this.current=bX;this.snap=E.New({$:2,$0:bX,$1:[]});}},Get:function(){return this.current;},UpdateMaybe:function(bX){var bY;bY=bX(this.Get());if(bY!=null&&bY.$==1)this.Set(bY.$0);}},q,D);D.New=bU.Ctor(function(bX,bY,bZ){var b0;b0=this;q.New.call(this);this.isConst=bX;this.current=bZ;this.snap=bY;this.view=function(){return b0.snap;};this.id=R.Int();},D);E.WhenRun=function(bX,bY,bZ){var b0;b0=bX.s;if(b0==null)bZ();else b0!=null&&b0.$==2?(b0.$1.push(bZ),bY(b0.$0)):b0!=null&&b0.$==3?(b0.$0.push(bY),b0.$1.push(bZ)):bY(b0.$0);};E.Map=function(bX,bY){var bZ,b0;bZ=bY.s;return bZ!=null&&bZ.$==0?E.New({$:0,$0:bX(bZ.$0)}):(b0=E.New({$:3,$0:[],$1:[]}),(E.When(bY,function(b1){E.MarkDone(b0,bY,bX(b1));},b0),b0));};E.WhenObsoleteRun=function(bX,bY){var bZ;bZ=bX.s;if(bZ==null)bY();else bZ!=null&&bZ.$==2?bZ.$1.push(bY):bZ!=null&&bZ.$==3?bZ.$1.push(bY):void 0;};E.When=function(bX,bY,bZ){var b0;b0=bX.s;if(b0==null)E.Obsolete(bZ);else b0!=null&&b0.$==2?(E.EnqueueSafe(b0.$1,bZ),bY(b0.$0)):b0!=null&&b0.$==3?(b0.$0.push(bY),E.EnqueueSafe(b0.$1,bZ)):bY(b0.$0);};E.MarkDone=function(bX,bY,bZ){var b0;if(b0=bY.s,b0!=null&&b0.$==0)E.MarkForever(bX,bZ);else E.MarkReady(bX,bZ);};E.EnqueueSafe=function(bX,bY){var bZ,b0,b1,b2;bX.push(bY);if(bX.length%20===0){bZ=bX.slice(0);bB.Clear(bX);for(b0=0,b1=o.length(bZ)-1;b0<=b1;b0++){b2=o.get(bZ,b0);if(typeof b2=="object")(function(b3){if(b3.s)bX.push(b3);}(b2));else(function(b3){bX.push(b3);}(b2));}}else void 0;};E.MarkForever=function(bX,bY){var bZ,b0,b1,b2;bZ=bX.s;if(bZ!=null&&bZ.$==3){bX.s={$:0,$0:bY};b0=bZ.$0;for(b1=0,b2=o.length(b0)-1;b1<=b2;b1++)(o.get(b0,b1))(bY);}else void 0;};E.MarkReady=function(bX,bY){var bZ,b0,b1,b2;bZ=bX.s;if(bZ!=null&&bZ.$==3){bX.s={$:2,$0:bY,$1:bZ.$1};b0=bZ.$0;for(b1=0,b2=o.length(b0)-1;b1<=b2;b1++)(o.get(b0,b1))(bY);}else void 0;};E.Map3=function(bX,bY,bZ,b0){var b1,b2,b3,b4;function b5(b6){var b7,b8,b9,b_;if(!(b7=b4.s,b7!=null&&b7.$==0||b7!=null&&b7.$==2)){b8=E.ValueAndForever(bY);b9=E.ValueAndForever(bZ);b_=E.ValueAndForever(b0);if(b8!=null&&b8.$==1)b9!=null&&b9.$==1?b_!=null&&b_.$==1?b8.$0[1]&&b9.$0[1]&&b_.$0[1]?E.MarkForever(b4,bX(b8.$0[0],b9.$0[0],b_.$0[0])):E.MarkReady(b4,bX(b8.$0[0],b9.$0[0],b_.$0[0])):void 0:void 0;}}b1=bY.s;b2=bZ.s;b3=b0.s;return b1!=null&&b1.$==0?b2!=null&&b2.$==0?b3!=null&&b3.$==0?E.New({$:0,$0:bX(b1.$0,b2.$0,b3.$0)}):E.Map3Opt1(bX,b1.$0,b2.$0,b0):b3!=null&&b3.$==0?E.Map3Opt2(bX,b1.$0,b3.$0,bZ):E.Map3Opt3(bX,b1.$0,bZ,b0):b2!=null&&b2.$==0?b3!=null&&b3.$==0?E.Map3Opt4(bX,b2.$0,b3.$0,bY):E.Map3Opt5(bX,b2.$0,bY,b0):b3!=null&&b3.$==0?E.Map3Opt6(bX,b3.$0,bY,bZ):(b4=E.New({$:3,$0:[],$1:[]}),(E.When(bY,b5,b4),E.When(bZ,b5,b4),E.When(b0,b5,b4),b4));};E.Sequence=function(bX){var bY,bZ,b0;function b1(b2){var b3;if(b0[0]===0){b3=o.map(function(b4){var b5;b5=b4.s;return b5!=null&&b5.$==0?b5.$0:b5!=null&&b5.$==2?b5.$0:j.FailWith("value not found by View.Sequence");},bY);if(o.forall(function(b4){var b5;b5=b4.s;return b5!=null&&b5.$==0;},bY))E.MarkForever(bZ,b3);else E.MarkReady(bZ,b3);}else b0[0]=b0[0]-1;}bY=o.ofSeq(bX);return bY.length==0?E.New({$:0,$0:[]}):(bZ=E.New({$:3,$0:[],$1:[]}),(b0=[o.length(bY)-1],(o.iter(function(b2){E.When(b2,b1,bZ);},bY),bZ)));};E.Map2=function(bX,bY,bZ){var b0,b1,b2;function b3(b4){var b5,b6,b7;if(!(b5=b2.s,b5!=null&&b5.$==0||b5!=null&&b5.$==2)){b6=E.ValueAndForever(bY);b7=E.ValueAndForever(bZ);if(b6!=null&&b6.$==1)b7!=null&&b7.$==1?b6.$0[1]&&b7.$0[1]?E.MarkForever(b2,bX(b6.$0[0],b7.$0[0])):E.MarkReady(b2,bX(b6.$0[0],b7.$0[0])):void 0;}}b0=bY.s;b1=bZ.s;return b0!=null&&b0.$==0?b1!=null&&b1.$==0?E.New({$:0,$0:bX(b0.$0,b1.$0)}):E.Map2Opt1(bX,b0.$0,bZ):b1!=null&&b1.$==0?E.Map2Opt2(bX,b1.$0,bY):(b2=E.New({$:3,$0:[],$1:[]}),(E.When(bY,b3,b2),E.When(bZ,b3,b2),b2));};E.Map2Unit=function(bX,bY){var bZ,b0,b1;function b2(){var b3,b4,b5;if(!(b3=b1.s,b3!=null&&b3.$==0||b3!=null&&b3.$==2)){b4=E.ValueAndForever(bX);b5=E.ValueAndForever(bY);if(b4!=null&&b4.$==1)b5!=null&&b5.$==1?b4.$0[1]&&b5.$0[1]?E.MarkForever(b1,null):E.MarkReady(b1,null):void 0;}}bZ=bX.s;b0=bY.s;return bZ!=null&&bZ.$==0?b0!=null&&b0.$==0?E.New({$:0,$0:null}):bY:b0!=null&&b0.$==0?bX:(b1=E.New({$:3,$0:[],$1:[]}),(E.When(bX,b2,b1),E.When(bY,b2,b1),b1));};E.Copy=function(bX){var bY,bZ,b0;bY=bX.s;return bY==null?bX:bY!=null&&bY.$==2?(bZ=E.New({$:2,$0:bY.$0,$1:[]}),(E.WhenObsolete(bX,bZ),bZ)):bY!=null&&bY.$==3?(b0=E.New({$:3,$0:[],$1:[]}),(E.When(bX,function(b1){E.MarkDone(b0,bX,b1);},b0),b0)):bX;};E.Map3Opt1=function(bX,bY,bZ,b0){return E.Map(function(b1){return bX(bY,bZ,b1);},b0);};E.Map3Opt2=function(bX,bY,bZ,b0){return E.Map(function(b1){return bX(bY,b1,bZ);},b0);};E.Map3Opt3=function(bX,bY,bZ,b0){return E.Map2(function(b1,b2){return bX(bY,b1,b2);},bZ,b0);};E.Map3Opt4=function(bX,bY,bZ,b0){return E.Map(function(b1){return bX(b1,bY,bZ);},b0);};E.Map3Opt5=function(bX,bY,bZ,b0){return E.Map2(function(b1,b2){return bX(b1,bY,b2);},bZ,b0);};E.Map3Opt6=function(bX,bY,bZ,b0){return E.Map2(function(b1,b2){return bX(b1,b2,bY);},bZ,b0);};E.ValueAndForever=function(bX){var bY;bY=bX.s;return bY!=null&&bY.$==0?{$:1,$0:[bY.$0,true]}:bY!=null&&bY.$==2?{$:1,$0:[bY.$0,false]}:null;};E.Map2Opt1=function(bX,bY,bZ){return E.Map(function(b0){return bX(bY,b0);},bZ);};E.Map2Opt2=function(bX,bY,bZ){return E.Map(function(b0){return bX(b0,bY);},bZ);};E.WhenObsolete=function(bX,bY){var bZ;bZ=bX.s;if(bZ==null)E.Obsolete(bY);else bZ!=null&&bZ.$==2?E.EnqueueSafe(bZ.$1,bY):bZ!=null&&bZ.$==3?E.EnqueueSafe(bZ.$1,bY):void 0;};E.Join=function(bX){var bY;bY=E.New({$:3,$0:[],$1:[]});E.When(bX,function(bZ){var b0;b0=bZ();E.When(b0,function(b1){var b2,b3;if((b2=b0.s,b2!=null&&b2.$==0)&&(b3=bX.s,b3!=null&&b3.$==0))E.MarkForever(bY,b1);else E.MarkReady(bY,b1);},bY);},bY);return bY;};F=f.AttrProxy=bU.Class({},null,F);F.Concat=function(bX){var bY;bY=T.ofSeqNonCopying(bX);return T.TreeReduce(U.EmptyAttr(),F.Append,bY);};F.Append=function(bX,bY){return U.AppendTree(bX,bY);};F.Create=function(bX,bY){return U.Static(function(bZ){bZ.setAttribute(bX,bY);});};F.Handler=function(bX,bY){return F.HandlerImpl(bX,bY);};F.HandlerImpl=function(bX,bY){return U.Static(function(bZ){bZ.addEventListener(bX,function(b0){return(bY(bZ))(b0);},false);});};H.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(bX){var bY,bZ;bY=bT.random()*16|0;bZ=bX=="x"?bY:bY&3|8;return bZ.toString(16);});};I.DynamicCustom=function(bX,bY){return U.Dynamic(bY,bX);};I.OnAfterRender=function(bX){return new F({$:4,$0:bX});};I.Handler=function(bX,bY){return U.Static(function(bZ){bZ.addEventListener(bX,function(b0){return(bY(bZ))(b0);},false);});};I.Value=function(bX){return I.ValueWith(bo.StringApply(),bX);};I.Checked=function(bX){return I.ValueWith(bo.BoolCheckedApply(),bX);};I.IntValue=function(bX){return I.ValueWith(bo.IntApplyChecked(),bX);};I.IntValueUnchecked=function(bX){return I.ValueWith(bo.IntApplyUnchecked(),bX);};I.FloatValue=function(bX){return I.ValueWith(bo.FloatApplyChecked(),bX);};I.FloatValueUnchecked=function(bX){return I.ValueWith(bo.FloatApplyUnchecked(),bX);};I.Dynamic=function(bX,bY){return U.Dynamic(bY,function(bZ){return function(b0){return bZ.setAttribute(bX,b0);};});};I.ValueWith=function(bX,bY){var bZ;bZ=bX(bY);return F.Append(U.Static(bZ[0]),I.DynamicCustom(bZ[1],bZ[2]));};J.$cctor=function(){J.$cctor=a.ignore;J.WIDTH=600;J.HEIGHT=600;J.animationHandle=g.Create$1(null);J.scoringValues=W.OfArray(o.ofSeq(h.groupBy(z.AsScore,h.ofSeq(V.delay(function(){return V.append(V.collect(function(bX){return V.append([{$:0,$0:bX}],V.delay(function(){return V.append([{$:1,$0:bX}],V.delay(function(){return[{$:2,$0:bX}];}));}));},j.range(1,20)),V.delay(function(){return V.append([{$:2,$0:25}],V.delay(function(){return V.append([{$:1,$0:25}],V.delay(function(){return[z.Nil];}));}));}));})))));J.dartRingNumbers=h.ofArray([20,1,18,4,13,6,10,15,2,17,3,19,7,16,8,11,14,9,12,5]);};L=K.FSharpMap=bU.Class({get_Keys:function(){return bU.MarkResizable(o.ofSeq(V.map(function(bX){return bX.Key;},_1.Enumerate(false,this.get_Tree()))));},ContainsKey:function(bX){return _1.Contains(_0.New(bX,void 0),this.tree);},TryGetValue:function(bX,bY){var bZ;bZ=this.TryFind(bX);return bZ!=null&&bZ.$==1&&(bY.set(bZ.$0),true);},get_Tree:function(){return this.tree;},TryFind:function(bX){var bY;bY=_1.TryFind(_0.New(bX,void 0),this.tree);return bY==null?null:{$:1,$0:bY.$0.Value};},GetEnumerator:function(){return _2.Get(V.map(function(bX){return{K:bX.Key,V:bX.Value};},_1.Enumerate(false,this.tree)));},Equals:function(bX){return this.Count()===bX.Count()&&V.forall2(B.Equals,this,bX);},Count:function(){var bX;bX=this.tree;return bX==null?0:bX.Count;},GetHashCode:function(){return B.Hash(o.ofSeq(this));},CompareTo0:function(bX){return V.compareWith(B.Compare,this,bX);}},e,L);L.New$1=bU.Ctor(function(bX){e.New.call(this);this.tree=bX;},L);M=f.Doc=bU.Class({},e,M);M.SelectDynOptional=function(bX,bY,bZ,b0,b1){return M.SelectDyn(bX,function(b2){return b2!=null&&b2.$==1?bZ(b2.$0):bY;},r.Map(function(b2){return new i({$:1,$0:null,$1:h.map(function(b3){return{$:1,$0:b3};},b2)});},b0),b1);};M.RunById=function(bX,bY){var bZ;bZ=self.document.getElementById(bX);if(B.Equals(bZ,null))j.FailWith("invalid id: "+bX);else M.Run(bZ,bY);};M.SelectDyn=function(bX,bY,bZ,b0){return M.SelectImpl(bX,bY,function(b1){function b2(b3,b4){return M.Element("option",h.ofArray([F.Create("value",a.String(b3))]),h.ofArray([M.TextNode(bY(b4))]));}return M.Convert(function(b3){return b2(b3[0],b3[1]);},r.Map(function(b3){b1[0]=b3;return V.mapi(function(b4,b5){return[b4,b5];},b3);},bZ));},b0);};M.Run=function(bX,bY){$.LinkElement(bX,bY.docNode);M.RunInPlace(false,bX,bY);};M.SelectImpl=function(bX,bY,bZ,b0){var b1,b2,b3,b4;function b5(b_){return b_.selectedIndex;}function b6(b_,b$){b_.selectedIndex=b$;}function b7(b_){var b$;b$=b5(b_);return b1[0].get_Item(b$);}function b8(b_){return V.findIndex(function(b$){return B.Equals(b_,b$);},b1[0]);}function b9(b_,b$){return b6(b_,b8(b$));}b1=[i.Empty];b2=self.document.createElement("select");b3=I.DynamicCustom(function(b_){return function(b$){return b9(b_,b$);};},b0.get_View());b2.addEventListener("change",function(){b0.UpdateMaybe(function(b_){var b$;b$=b7(b2);return B.Equals(b_,b$)?null:{$:1,$0:b$};});},false);return bf.New(b2,(b4=F.Append(b3,F.Concat(bX)),F.Append(I.OnAfterRender(function(b_){b9(b_,b0.Get());}),b4)),bZ(b1));};M.Convert=function(bX,bY){return M.Flatten(r.MapSeqCached(bX,bY));};M.Element=function(bX,bY,bZ){var b0,b1;b0=F.Concat(bY);b1=M.Concat(bZ);return bf.New(self.document.createElement(bX),b0,b1);};M.TextNode=function(bX){return M.Mk({$:5,$0:self.document.createTextNode(bX)},r.Const());};M.get_Empty=function(){return M.Mk(null,r.Const());};M.RunInPlace=function(bX,bY,bZ){var b0;b0=$.CreateRunState(bY,bZ.docNode);r.Sink(bj.get_UseAnimations()||bk.BatchUpdatesEnabled()?bl.StartProcessor($.PerformAnimatedUpdate(bX,b0,bZ.docNode)):function(){$.PerformSyncUpdate(bX,b0,bZ.docNode);},bZ.updates);};M.Flatten=function(bX){return M.EmbedView(r.Map(M.Concat,bX));};M.Concat=function(bX){var bY;bY=T.ofSeqNonCopying(bX);return T.TreeReduce(M.get_Empty(),M.Append,bY);};M.Mk=function(bX,bY){return new M.New(bX,bY);};M.EmbedView=function(bX){var bY;bY=$.CreateEmbedNode();return M.Mk({$:2,$0:bY},r.Map(a.ignore,r.Bind(function(bZ){$.UpdateEmbedNode(bY,bZ.docNode);return bZ.updates;},bX)));};M.Append=function(bX,bY){return M.Mk({$:0,$0:bX.docNode,$1:bY.docNode},r.Map2Unit(bX.updates,bY.updates));};M.TextView=function(bX){var bY;bY=$.CreateTextNode();return M.Mk({$:4,$0:bY},r.Map(function(bZ){$.UpdateTextNode(bY,bZ);},bX));};M.New=bU.Ctor(function(bX,bY){e.New.call(this);this.docNode=bX;this.updates=bY;},M);N.toSafe=function(bX){return bX==null?"":bX;};P.LoadLocalTemplates=function(bX){!P.LocalTemplatesLoaded()?(P.set_LocalTemplatesLoaded(true),P.LoadNestedTemplates(self.document.body,"")):void 0;P.LoadedTemplates().set_Item(bX,P.LoadedTemplateFile(""));};P.NamedTemplate=function(bX,bY,bZ){var b0,b1;b0=(b1=null,[P.LoadedTemplateFile(bX).TryGetValue(bY==null?"":bY.$0,{get:function(){return b1;},set:function(b2){b1=b2;}}),b1]);return b0[0]?P.ChildrenTemplate(b0[1].cloneNode(true),bZ):(bV.warn("Local template doesn't exist",bY),M.get_Empty());};P.LocalTemplatesLoaded=function(){_.$cctor();return _.LocalTemplatesLoaded;};P.set_LocalTemplatesLoaded=function(bX){_.$cctor();_.LocalTemplatesLoaded=bX;};P.LoadNestedTemplates=function(bX,bY){var b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca;function bZ(cb){var cc,cd;if(!b0.ContainsKey(cb)){cc=(cd=null,[b1.TryGetValue(cb,{get:function(){return cd;},set:function(ce){cd=ce;}}),cd]);if(cc[0]){ca.SAdd(cb);b1.RemoveKey(cb);P.PrepareTemplateStrict(bY,{$:1,$0:cb},cc[1],{$:1,$0:bZ});}else bV.warn(ca.Contains(cb)?"Encountered loop when instantiating "+cb:"Local template does not exist: "+cb);}}b0=P.LoadedTemplateFile(bY);b1=new S.New$5();b2=bX.querySelectorAll("[ws-template]");for(b3=0,b4=b2.length-1;b3<=b4;b3++){b5=b2[b3];b6=b5.getAttribute("ws-template").toLowerCase();b5.removeAttribute("ws-template");b1.set_Item(b6,P.FakeRootSingle(b5));}b7=bX.querySelectorAll("[ws-children-template]");for(b8=0,b9=b7.length-1;b8<=b9;b8++){b_=b7[b8];b$=b_.getAttribute("ws-children-template").toLowerCase();b_.removeAttribute("ws-children-template");b1.set_Item(b$,P.FakeRoot(b_));}ca=new _3.New$3();while(b1.count>0)bZ(V.head(b1.Keys()));};P.LoadedTemplates=function(){_.$cctor();return _.LoadedTemplates;};P.LoadedTemplateFile=function(bX){var bY,bZ,b0;bY=(bZ=null,[P.LoadedTemplates().TryGetValue(bX,{get:function(){return bZ;},set:function(b1){bZ=b1;}}),bZ]);return bY[0]?bY[1]:(b0=new S.New$5(),(P.LoadedTemplates().set_Item(bX,b0),b0));};P.ChildrenTemplate=function(bX,bY){var bZ,b0,b1,b2,b3;bZ=P.InlineTemplate(bX,V.append(bY,P.GlobalHoles().Values()));b0=bZ[1];b1=bZ[0];b2=b1.Els;return!B.Equals(b2,null)&&b2.length===1&&(o.get(b2,0)instanceof v&&(B.Equals(o.get(b2,0).nodeType,v.ELEMENT_NODE)&&(b3=o.get(b2,0),true)))?bf.TreeNode(b1,b0):M.Mk({$:6,$0:b1},b0);};P.FakeRootSingle=function(bX){var bY,bZ,b0,b1;bX.removeAttribute("ws-template");bY=bX.getAttribute("ws-replace");if(bY===null);else{bX.removeAttribute("ws-replace");bZ=bX.parentNode;B.Equals(bZ,null)?void 0:(b0=self.document.createElement(bX.tagName),b0.setAttribute("ws-replace",bY),bZ.replaceChild(b0,bX));}b1=self.document.createElement("div");b1.appendChild(bX);return b1;};P.FakeRoot=function(bX){var bY;bY=self.document.createElement("div");while(bX.hasChildNodes())bY.appendChild(bX.firstChild);return bY;};P.PrepareTemplateStrict=function(bX,bY,bZ,b0){var b1;function b2(b8,b9){var b_,b$,ca,cb,cc,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy;function cd(cz){}while(true)switch(b8){case 0:if(b9!==null){b_=b9.nextSibling;if(B.Equals(b9.nodeType,v.TEXT_NODE))bg.convertTextNode(b9);else if(B.Equals(b9.nodeType,v.ELEMENT_NODE))b4(b9);b9=b_;}else return null;break;case 1:ce=bh.string(b9.nodeName,{$:1,$0:3},null).toLowerCase();cf=(b$=ce.indexOf("."),b$===-1?[bX,ce]:[bh.string(ce,null,{$:1,$0:b$-1}),bh.string(ce,{$:1,$0:b$+1},null)]);cg=cf[1];ch=cf[0];if(ch!==""&&!P.LoadedTemplates().ContainsKey(ch))return bg.failNotLoaded(cg);else{if(ch===""&&b0!=null)b0.$0(cg);ci=P.LoadedTemplates().Item(ch);if(!ci.ContainsKey(cg))return bg.failNotLoaded(cg);else{cj=ci.Item(cg);ck=cj.cloneNode(true);cl=new _3.New$3();cm=new S.New$5();cn=b9.attributes;for(co=0,cp=cn.length-1;co<=cp;co++){cq=cn.item(co).name.toLowerCase();cm.set_Item(cq,(cr=cn.item(co).nodeValue,cr===""?cq:cr.toLowerCase()));if(!cl.SAdd(cq))bV.warn("Hole mapped twice",cq);}for(cs=0,ct=b9.childNodes.length-1;cs<=ct;cs++){cu=b9.childNodes[cs];if(B.Equals(cu.nodeType,v.ELEMENT_NODE))!cl.SAdd(cu.nodeName.toLowerCase())?bV.warn("Hole filled twice",cg):void 0;}cv=b9.childNodes.length===1&&B.Equals(b9.firstChild.nodeType,v.TEXT_NODE);if(cv){cb=bg.fillTextHole(ck,b9.firstChild.textContent,cg);((function(cz){return function(cA){if(cA!=null)cz(cA.$0);};}((cc=function(cz){return function(cA){return cz.SAdd(cA);};}(cl),function(cz){return cd(cc(cz));})))(cb));}bg.removeHolesExcept(ck,cl);if(!cv){for(cw=0,cx=b9.childNodes.length-1;cw<=cx;cw++){cy=b9.childNodes[cw];if(B.Equals(cy.nodeType,v.ELEMENT_NODE))cy.hasAttributes()?bg.fillInstanceAttrs(ck,cy):b3(ck,cy);}}bg.mapHoles(ck,cm);bg.fill(ck,b9.parentNode,b9);b9.parentNode.removeChild(b9);return;}}break;}}function b3(b8,b9){var b_,ca,cb;function b$(cc,cd){var ce;if(ca==="title"&&b9.hasChildNodes()){ce=be.ParseHTMLIntoFakeRoot(b9.textContent);b9.removeChild(b9.firstChild);while(ce.hasChildNodes())b9.appendChild(ce.firstChild);}else null;b4(b9);return bg.fill(b9,cc,cd);}ca=b9.nodeName.toLowerCase();P.foreachNotPreserved(b8,"[ws-attr-holes]",function(cc){var cd,ce,cf,cg,ch;cd=bq.SplitChars(cc.getAttribute("ws-attr-holes"),[" "],1);for(ce=0,cf=cd.length-1;ce<=cf;ce++){cg=o.get(cd,ce);cc.setAttribute(cg,(ch=new a.RegExp("\\${"+ca+"}","ig"),cc.getAttribute(cg).replace(ch,b9.textContent)));}});cb=b8.querySelector("[ws-hole="+ca+"]");if(B.Equals(cb,null)){b_=b8.querySelector("[ws-replace="+ca+"]");return B.Equals(b_,null)?null:(b$(b_.parentNode,b_),void b_.parentNode.removeChild(b_));}else{while(cb.hasChildNodes())cb.removeChild(cb.lastChild);cb.removeAttribute("ws-hole");return b$(cb,null);}}function b4(b8){if(!b8.hasAttribute("ws-preserve"))if(bq.StartsWith(b8.nodeName.toLowerCase(),"ws-"))b6(b8);else{bg.convertAttrs(b8);b5(b8.firstChild);}}function b5(b8){return b2(0,b8);}function b6(b8){return b2(1,b8);}function b7(b8){var b9,b_,b$,ca;while(true){b9=b8.querySelector("[ws-template]");if(B.Equals(b9,null)){b_=b8.querySelector("[ws-children-template]");if(B.Equals(b_,null))return null;else{b$=b_.getAttribute("ws-children-template");b_.removeAttribute("ws-children-template");P.PrepareTemplateStrict(bX,{$:1,$0:b$},b_,null);b8=b8;}}else{ca=b9.getAttribute("ws-template");(P.PrepareSingleTemplate(bX,{$:1,$0:ca},b9))(null);b8=b8;}}}b1=(bY==null?"":bY.$0).toLowerCase();P.LoadedTemplateFile(bX).set_Item(b1,bZ);if(bZ.hasChildNodes()){b7(bZ);b5(bZ.firstChild);}};P.InlineTemplate=function(bX,bY){var bZ,b0,b1,b2,b5,b6,b7,b8,b9,b_,b$;function b3(ca,cb){var cc,cd,ce;cc=U.Insert(ca,cb);b6.push(U.Updates(cc));b7.push([ca,cc]);cd=bU.GetOptional(cc.OnAfterRender);return cd==null?null:(ce=cd.$0,void b8.push(function(){ce(ca);}));}function b4(ca){var cb,cc;cb=(cc=null,[b9.TryGetValue(ca,{get:function(){return cc;},set:function(cd){cc=cd;}}),cc]);return cb[0]?cb[1].$==0?{$:1,$0:cb[1].$1}:cb[1].$==1?{$:1,$0:M.TextNode(cb[1].$1)}:cb[1].$==2?{$:1,$0:M.TextView(cb[1].$1)}:cb[1].$==10?{$:1,$0:M.TextView(cb[1].$1.get_View())}:cb[1].$==11?{$:1,$0:M.TextView(r.Map(a.String,cb[1].$1.get_View()))}:cb[1].$==12?{$:1,$0:M.TextView(r.Map(function(cd){return cd.get_Input();},cb[1].$1.get_View()))}:cb[1].$==13?{$:1,$0:M.TextView(r.Map(a.String,cb[1].$1.get_View()))}:cb[1].$==14?{$:1,$0:M.TextView(r.Map(function(cd){return cd.get_Input();},cb[1].$1.get_View()))}:cb[1].$==15?{$:1,$0:M.TextView(r.Map(a.String,cb[1].$1.get_View()))}:(bV.warn("Content hole filled with attribute data",ca),null):null;}b5=[];b6=[];b7=[];b8=[];b9=new S.New$5();b_=_2.Get(bY);try{while(b_.MoveNext()){b$=b_.Current();b9.set_Item(b$.$0,b$);}}finally{if(typeof b_=="object"&&"Dispose"in b_)b_.Dispose();}bZ=be.ChildrenArray(bX);P.foreachNotPreserved(bX,"[ws-hole]",function(ca){var cb,cc,cd;cd=ca.getAttribute("ws-hole");ca.removeAttribute("ws-hole");while(ca.hasChildNodes())ca.removeChild(ca.lastChild);cb=b4(cd);if(cb!=null&&cb.$==1){cc=cb.$0;$.LinkElement(ca,cc.docNode);b5.push(bb.New(U.Empty(ca),cc.docNode,null,ca,R.Int(),null));b6.push(cc.updates);}});P.foreachNotPreserved(bX,"[ws-replace]",function(ca){var cb,cc,cd,ce,cf,cg;cb=b4(ca.getAttribute("ws-replace"));if(cb!=null&&cb.$==1){cc=cb.$0;cd=ca.parentNode;ce=self.document.createTextNode("");cd.replaceChild(ce,ca);cf=$.InsertBeforeDelim(ce,cc.docNode);cg=o.tryFindIndex(function(ch){return ca===ch;},bZ);cg==null?void 0:o.set(bZ,cg.$0,cc.docNode);b5.push(bb.New(U.Empty(cd),cc.docNode,{$:1,$0:[cf,ce]},cd,R.Int(),null));b6.push(cc.updates);}});P.foreachNotPreserved(bX,"[ws-attr]",function(ca){var cb,cc,cd;cb=ca.getAttribute("ws-attr");ca.removeAttribute("ws-attr");cc=(cd=null,[b9.TryGetValue(cb,{get:function(){return cd;},set:function(ce){cd=ce;}}),cd]);if(cc[0])cc[1].$==3?b3(ca,cc[1].$1):bV.warn("Attribute hole filled with non-attribute data",cb);});P.foreachNotPreserved(bX,"[ws-on]",function(ca){b3(ca,F.Concat(o.choose(function(cb){var cc,cd,ce;cc=bq.SplitChars(cb,[":"],1);cd=(ce=null,[b9.TryGetValue(o.get(cc,1),{get:function(){return ce;},set:function(cf){ce=cf;}}),ce]);return cd[0]?cd[1].$==4?{$:1,$0:I.Handler(o.get(cc,0),cd[1].$1)}:cd[1].$==5?{$:1,$0:F.Handler(o.get(cc,0),cd[1].$1)}:(bV.warn("Event hole on"+o.get(cc,0)+" filled with non-event data",o.get(cc,1)),null):null;},bq.SplitChars(ca.getAttribute("ws-on"),[" "],1))));ca.removeAttribute("ws-on");});P.foreachNotPreserved(bX,"[ws-onafterrender]",function(ca){var cb,cc,cd;cb=ca.getAttribute("ws-onafterrender");cc=(cd=null,[b9.TryGetValue(cb,{get:function(){return cd;},set:function(ce){cd=ce;}}),cd]);if(cc[0])cc[1].$==7?(ca.removeAttribute("ws-onafterrender"),b3(ca,I.OnAfterRender(cc[1].$1))):cc[1].$==8?(ca.removeAttribute("ws-onafterrender"),b3(ca,I.OnAfterRender(cc[1].$1))):bV.warn("onafterrender hole filled with non-onafterrender data",cb);});P.foreachNotPreserved(bX,"[ws-var]",function(ca){var cb,cc,cd;cb=ca.getAttribute("ws-var");ca.removeAttribute("ws-var");cc=(cd=null,[b9.TryGetValue(cb,{get:function(){return cd;},set:function(ce){cd=ce;}}),cd]);if(cc[0])cc[1].$==10?b3(ca,I.Value(cc[1].$1)):cc[1].$==11?b3(ca,I.Checked(cc[1].$1)):cc[1].$==12?b3(ca,I.IntValue(cc[1].$1)):cc[1].$==13?b3(ca,I.IntValueUnchecked(cc[1].$1)):cc[1].$==14?b3(ca,I.FloatValue(cc[1].$1)):cc[1].$==15?b3(ca,I.FloatValueUnchecked(cc[1].$1)):bV.warn("Var hole filled with non-Var data",cb);});P.foreachNotPreserved(bX,"[ws-attr-holes]",function(ca){var cb,cc,cd,ce;cb=new a.RegExp(P.TextHoleRE(),"g");cc=bq.SplitChars(ca.getAttribute("ws-attr-holes"),[" "],1);ca.removeAttribute("ws-attr-holes");for(cd=0,ce=cc.length-1;cd<=ce;cd++)(function(){var cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr;co=o.get(cc,cd);cp=ca.getAttribute(co);cf=null;cg=0;cq=[];while(cf=cb.exec(cp),cf!==null){cr=bh.string(cp,{$:1,$0:cg},{$:1,$0:cb.lastIndex-o.get(cf,0).length-1});cg=cb.lastIndex;cq.push([cr,o.get(cf,1)]);}ci=bh.string(cp,{$:1,$0:cg},null);cb.lastIndex=0;cj=o.foldBack(function(cs,ct){return(function(cu){var cv,cw;cv=cu[0];cw=cu[1];return function(cx){var cy,cz,cA,cB,cC;cy=cx[0];cz=cx[1];cA=(cB=(cC=null,[b9.TryGetValue(cw,{get:function(){return cC;},set:function(cD){cC=cD;}}),cC]),cB[0]?cB[1].$==1?{$:0,$0:cB[1].$1}:cB[1].$==2?{$:1,$0:cB[1].$1}:cB[1].$==10?{$:1,$0:cB[1].$1.get_View()}:cB[1].$==11?{$:1,$0:r.Map(a.String,cB[1].$1.get_View())}:cB[1].$==12?{$:1,$0:r.Map(function(cD){return cD.get_Input();},cB[1].$1.get_View())}:cB[1].$==13?{$:1,$0:r.Map(a.String,cB[1].$1.get_View())}:cB[1].$==14?{$:1,$0:r.Map(function(cD){return cD.get_Input();},cB[1].$1.get_View())}:cB[1].$==15?{$:1,$0:r.Map(a.String,cB[1].$1.get_View())}:(bV.warn("Attribute value hole filled with non-text data",cw),{$:0,$0:""}):{$:0,$0:""});return cA.$==1?[cv,new i({$:1,$0:cy===""?cA.$0:r.Map(function(cD){return cD+cy;},cA.$0),$1:cz})]:[cv+cA.$0+cy,cz];};}(cs))(ct);},cq,[ci,i.Empty]);return b3(ca,cj[1].$==1?cj[1].$1.$==1?cj[1].$1.$1.$==1?cj[1].$1.$1.$1.$==0?(ck=cj[0],I.Dynamic(co,r.Map3(function(cs,ct,cu){return ck+cs+ct+cu;},cj[1].$0,cj[1].$1.$0,cj[1].$1.$1.$0))):(cl=cj[0],I.Dynamic(co,r.Map(function(cs){return cl+bq.concat("",cs);},r.Sequence(cj[1])))):(cm=cj[0],I.Dynamic(co,r.Map2(function(cs,ct){return cm+cs+ct;},cj[1].$0,cj[1].$1.$0))):cj[0]===""?I.Dynamic(co,cj[1].$0):(cn=cj[0],I.Dynamic(co,r.Map(function(cs){return cn+cs;},cj[1].$0))):F.Create(co,cj[0]));}());});return[bU.DeleteEmptyFields({Els:bZ,Dirty:true,Holes:b5,Attrs:b7,Render:(b0=b8.length==0?null:{$:1,$0:function(ca){o.iter(function(cb){cb(ca);},b8);}},b0?b0.$0:void 0),El:(b1=!B.Equals(bZ,null)&&bZ.length===1&&(o.get(bZ,0)instanceof v&&(o.get(bZ,0)instanceof w&&(b2=o.get(bZ,0),true)))?{$:1,$0:b2}:null,b1?b1.$0:void 0)},["Render","El"]),T.TreeReduce(r.Const(),r.Map2Unit,b6)];};P.GlobalHoles=function(){_.$cctor();return _.GlobalHoles;};P.foreachNotPreserved=function(bX,bY,bZ){be.IterSelector(bX,bY,function(b0){if(b0.closest("[ws-preserve]")==null)bZ(b0);});};P.PrepareSingleTemplate=function(bX,bY,bZ){var b0;b0=P.FakeRootSingle(bZ);return function(b1){P.PrepareTemplateStrict(bX,bY,b0,b1);};};P.TextHoleRE=function(){_.$cctor();return _.TextHoleRE;};R.Int=function(){R.set_counter(R.counter()+1);return R.counter();};R.set_counter=function(bX){ba.$cctor();ba.counter=bX;};R.counter=function(){ba.$cctor();return ba.counter;};S=K.Dictionary=bU.Class({set_Item:function(bX,bY){this.set(bX,bY);},set:function(bX,bY){var bZ,b0,b1,b2;bZ=this;b0=this.hash(bX);b1=this.data[b0];if(b1==null){this.count=this.count+1;this.data[b0]=new a.Array({K:bX,V:bY});}else{b2=o.tryFindIndex(function(b3){return bZ.equals.apply(null,[(j.KeyValue(b3))[0],bX]);},b1);b2==null?(this.count=this.count+1,b1.push({K:bX,V:bY})):b1[b2.$0]={K:bX,V:bY};}},TryGetValue:function(bX,bY){var bZ,b0,b1;bZ=this;b0=this.data[this.hash(bX)];return b0==null?false:(b1=o.tryPick(function(b2){var b3;b3=j.KeyValue(b2);return bZ.equals.apply(null,[b3[0],bX])?{$:1,$0:b3[1]}:null;},b0),b1!=null&&b1.$==1&&(bY.set(b1.$0),true));},ContainsKey:function(bX){var bY,bZ;bY=this;bZ=this.data[this.hash(bX)];return bZ==null?false:o.exists(function(b0){return bY.equals.apply(null,[(j.KeyValue(b0))[0],bX]);},bZ);},RemoveKey:function(bX){return this.remove(bX);},Keys:function(){return new bi.New(this);},GetEnumerator:function(){return _2.Get0(o.concat(t.GetFieldValues(this.data)));},Item:function(bX){return this.get(bX);},DAdd:function(bX,bY){this.add(bX,bY);},Values:function(){return new bs.New(this);},remove:function(bX){var bY,bZ,b0,b1;bY=this;bZ=this.hash(bX);b0=this.data[bZ];return b0==null?false:(b1=o.filter(function(b2){return!bY.equals.apply(null,[(j.KeyValue(b2))[0],bX]);},b0),o.length(b1)<b0.length&&(this.count=this.count-1,this.data[bZ]=b1,true));},get:function(bX){var bY,bZ;bY=this;bZ=this.data[this.hash(bX)];return bZ==null?_9.notPresent():o.pick(function(b0){var b1;b1=j.KeyValue(b0);return bY.equals.apply(null,[b1[0],bX])?{$:1,$0:b1[1]}:null;},bZ);},add:function(bX,bY){var bZ,b0,b1;bZ=this;b0=this.hash(bX);b1=this.data[b0];if(b1==null){this.count=this.count+1;this.data[b0]=new a.Array({K:bX,V:bY});}else{o.exists(function(b2){return bZ.equals.apply(null,[(j.KeyValue(b2))[0],bX]);},b1)?_9.alreadyAdded():void 0;this.count=this.count+1;b1.push({K:bX,V:bY});}}},e,S);S.New$5=bU.Ctor(function(){S.New$6.call(this,[],B.Equals,B.Hash);},S);S.New$6=bU.Ctor(function(bX,bY,bZ){var b0,b1;e.New.call(this);this.equals=bY;this.hash=bZ;this.count=0;this.data=[];b0=_2.Get(bX);try{while(b0.MoveNext()){b1=b0.Current();this.set(b1.K,b1.V);}}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}},S);T.ofSeqNonCopying=function(bX){var bY,bZ;if(bX instanceof a.Array)return bX;else if(bX instanceof i)return o.ofList(bX);else if(bX===null)return[];else{bY=[];bZ=_2.Get(bX);try{while(bZ.MoveNext())bY.push(bZ.Current());return bY;}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}}};T.TreeReduce=function(bX,bY,bZ){var b0;function b1(b2){return function(b3){var b4,b5;switch(b3<=0?0:b3===1?b2>=0&&b2<b0?1:(b4=b3,2):(b4=b3,2)){case 0:return bX;case 1:return o.get(bZ,b2);case 2:b5=b3/2>>0;return bY((b1(b2))(b5),(b1(b2+b5))(b3-b5));}};}b0=o.length(bZ);return(b1(0))(b0);};T.mapInPlace=function(bX,bY){var bZ,b0;for(bZ=0,b0=bY.length-1;bZ<=b0;bZ++)bY[bZ]=bX(bY[bZ]);return bY;};T.MapTreeReduce=function(bX,bY,bZ,b0){var b1;function b2(b3){return function(b4){var b5,b6;switch(b4<=0?0:b4===1?b3>=0&&b3<b1?1:(b5=b4,2):(b5=b4,2)){case 0:return bY;case 1:return bX(o.get(b0,b3));case 2:b6=b4/2>>0;return bZ((b2(b3))(b6),(b2(b3+b6))(b4-b6));}};}b1=o.length(b0);return(b2(0))(b1);};U.Dynamic=function(bX,bY){return new F({$:1,$0:new _7.New(bX,bY)});};U.AppendTree=function(bX,bY){var bZ;return bX===null?bY:bY===null?bX:(bZ=new F({$:2,$0:bX,$1:bY}),(U.SetFlags(bZ,U.Flags(bX)|U.Flags(bY)),bZ));};U.EmptyAttr=function(){bd.$cctor();return bd.EmptyAttr;};U.SetFlags=function(bX,bY){bX.flags=bY;};U.Flags=function(bX){return bX!==null&&bX.hasOwnProperty("flags")?bX.flags:0;};U.Static=function(bX){return new F({$:3,$0:bX});};U.Insert=function(bX,bY){var bZ,b0,b1;function b2(b3){var b4,b5;while(true)if(!(b3===null)){if(b3!=null&&b3.$==1)return bZ.push(b3.$0);else if(b3!=null&&b3.$==2){b4=b3.$1;b5=b3.$0;b2(b5);b3=b4;}else return b3!=null&&b3.$==3?b3.$0(bX):b3!=null&&b3.$==4?b0.push(b3.$0):null;}else return null;}bZ=[];b0=[];b2(bY);b1=bZ.slice(0);return bn.New(bX,U.Flags(bY),b1,b0.length===0?null:{$:1,$0:function(b3){V.iter(function(b4){b4(b3);},b0);}});};U.Updates=function(bX){return T.MapTreeReduce(function(bY){return bY.NChanged();},r.Const(),r.Map2Unit,bX.DynNodes);};U.Empty=function(bX){return bn.New(bX,0,[],null);};U.HasExitAnim=function(bX){var bY;bY=2;return(bX.DynFlags&bY)===bY;};U.GetExitAnim=function(bX){return U.GetAnim(bX,function(bY,bZ){return bY.NGetExitAnim(bZ);});};U.HasEnterAnim=function(bX){var bY;bY=1;return(bX.DynFlags&bY)===bY;};U.GetEnterAnim=function(bX){return U.GetAnim(bX,function(bY,bZ){return bY.NGetEnterAnim(bZ);});};U.HasChangeAnim=function(bX){var bY;bY=4;return(bX.DynFlags&bY)===bY;};U.GetChangeAnim=function(bX){return U.GetAnim(bX,function(bY,bZ){return bY.NGetChangeAnim(bZ);});};U.GetAnim=function(bX,bY){return bj.Concat(o.map(function(bZ){return bY(bZ,bX.DynElem);},bX.DynNodes));};U.Sync=function(bX,bY){o.iter(function(bZ){bZ.NSync(bX);},bY.DynNodes);};V.delay=function(bX){return{GetEnumerator:function(){return _2.Get(bX());}};};V.append=function(bX,bY){return{GetEnumerator:function(){var bZ,b0;bZ=_2.Get(bX);b0=[true];return new _5.New(bZ,null,function(b1){var b2;return b1.s.MoveNext()?(b1.c=b1.s.Current(),true):(b2=b1.s,!B.Equals(b2,null)?b2.Dispose():void 0,b1.s=null,b0[0]&&(b0[0]=false,b1.s=_2.Get(bY),b1.s.MoveNext()?(b1.c=b1.s.Current(),true):(b1.s.Dispose(),b1.s=null,false)));},function(b1){var b2;b2=b1.s;if(!B.Equals(b2,null))b2.Dispose();});}};};V.collect=function(bX,bY){return V.concat(V.map(bX,bY));};V.map=function(bX,bY){return{GetEnumerator:function(){var bZ;bZ=_2.Get(bY);return new _5.New(null,null,function(b0){return bZ.MoveNext()&&(b0.c=bX(bZ.Current()),true);},function(){bZ.Dispose();});}};};V.choose=function(bX,bY){return V.collect(function(bZ){var b0;b0=bX(bZ);return b0==null?i.Empty:h.ofArray([b0.$0]);},bY);};V.concat=function(bX){return{GetEnumerator:function(){var bY;function bZ(b0){var b1;while(true){b1=b0.s;if(B.Equals(b1,null)){if(bY.MoveNext()){b0.s=_2.Get(bY.Current());b0=b0;}else{bY.Dispose();return false;}}else if(b1.MoveNext()){b0.c=b1.Current();return true;}else{b0.Dispose();b0.s=null;b0=b0;}}}bY=_2.Get(bX);return new _5.New(null,null,bZ,function(b0){var b1;b1=b0.s;if(!B.Equals(b1,null))b1.Dispose();if(!B.Equals(bY,null))bY.Dispose();});}};};V.init=function(bX,bY){return V.take(bX,V.initInfinite(bY));};V.mapi=function(bX,bY){return V.map2(bX,V.initInfinite(a.id),bY);};V.head=function(bX){var bY;bY=_2.Get(bX);try{return bY.MoveNext()?bY.Current():V.insufficient();}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}};V.take=function(bX,bY){bX<0?V.nonNegative():void 0;return{GetEnumerator:function(){var bZ;bZ=[_2.Get(bY)];return new _5.New(0,null,function(b0){var b1;b0.s=b0.s+1;return b0.s>bX?false:(b1=bZ[0],B.Equals(b1,null)?V.insufficient():b1.MoveNext()?(b0.c=b1.Current(),b0.s===bX?(b1.Dispose(),bZ[0]=null):void 0,true):(b1.Dispose(),bZ[0]=null,V.insufficient()));},function(){var b0;b0=bZ[0];if(!B.Equals(b0,null))b0.Dispose();});}};};V.initInfinite=function(bX){return{GetEnumerator:function(){return new _5.New(0,null,function(bY){bY.c=bX(bY.s);bY.s=bY.s+1;return true;},void 0);}};};V.unfold=function(bX,bY){return{GetEnumerator:function(){return new _5.New(bY,null,function(bZ){var b0;b0=bX(bZ.s);return b0==null?false:(bZ.c=b0.$0[0],bZ.s=b0.$0[1],true);},void 0);}};};V.map2=function(bX,bY,bZ){return{GetEnumerator:function(){var b0,b1;b0=_2.Get(bY);b1=_2.Get(bZ);return new _5.New(null,null,function(b2){return b0.MoveNext()&&b1.MoveNext()&&(b2.c=bX(b0.Current(),b1.Current()),true);},function(){b0.Dispose();b1.Dispose();});}};};V.forall2=function(bX,bY,bZ){return!V.exists2(function(b0,b1){return!bX(b0,b1);},bY,bZ);};V.findIndex=function(bX,bY){var bZ;bZ=V.tryFindIndex(bX,bY);return bZ==null?j.FailWith("KeyNotFoundException"):bZ.$0;};V.fold=function(bX,bY,bZ){var b0,b1;b0=bY;b1=_2.Get(bZ);try{while(b1.MoveNext())b0=bX(b0,b1.Current());return b0;}finally{if(typeof b1=="object"&&"Dispose"in b1)b1.Dispose();}};V.exists2=function(bX,bY,bZ){var b0,b1,b2,b3;b0=_2.Get(bY);try{b2=_2.Get(bZ);try{b3=false;while(!b3&&b0.MoveNext()&&b2.MoveNext())b3=bX(b0.Current(),b2.Current());b1=b3;}finally{if(typeof b2=="object"&&"Dispose"in b2)b2.Dispose();}return b1;}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}};V.distinct=function(bX){return V.distinctBy(a.id,bX);};V.tryFindIndex=function(bX,bY){var bZ,b0,b1;bZ=_2.Get(bY);try{b0=true;b1=0;while(b0&&bZ.MoveNext())if(bX(bZ.Current()))b0=false;else b1=b1+1;return b0?null:{$:1,$0:b1};}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}};V.iter=function(bX,bY){var bZ;bZ=_2.Get(bY);try{while(bZ.MoveNext())bX(bZ.Current());}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}};V.forall=function(bX,bY){return!V.exists(function(bZ){return!bX(bZ);},bY);};V.distinctBy=function(bX,bY){return{GetEnumerator:function(){var bZ,b0;bZ=_2.Get(bY);b0=new _3.New$3();return new _5.New(null,null,function(b1){var b2,b3;if(bZ.MoveNext()){b2=bZ.Current();b3=b0.SAdd(bX(b2));while(!b3&&bZ.MoveNext()){b2=bZ.Current();b3=b0.SAdd(bX(b2));}return b3&&(b1.c=b2,true);}else return false;},function(){bZ.Dispose();});}};};V.nth=function(bX,bY){var bZ,b0;if(bX<0)j.FailWith("negative index requested");bZ=-1;b0=_2.Get(bY);try{while(bZ<bX){!b0.MoveNext()?V.insufficient():void 0;bZ=bZ+1;}return b0.Current();}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}};V.compareWith=function(bX,bY,bZ){var b0,b1,b2,b3,b4;b0=_2.Get(bY);try{b2=_2.Get(bZ);try{b3=0;b4=true;while(b4&&b3===0)if(b0.MoveNext())b3=b2.MoveNext()?bX(b0.Current(),b2.Current()):1;else if(b2.MoveNext())b3=-1;else b4=false;b1=b3;}finally{if(typeof b2=="object"&&"Dispose"in b2)b2.Dispose();}return b1;}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}};V.exists=function(bX,bY){var bZ,b0;bZ=_2.Get(bY);try{b0=false;while(!b0&&bZ.MoveNext())b0=bX(bZ.Current());return b0;}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}};V.max=function(bX){var bY,bZ,b0;bY=_2.Get(bX);try{if(!bY.MoveNext())V.seqEmpty();bZ=bY.Current();while(bY.MoveNext()){b0=bY.Current();if(B.Compare(b0,bZ)===1)bZ=b0;}return bZ;}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}};V.seqEmpty=function(){return j.FailWith("The input sequence was empty.");};W.OfArray=function(bX){return new L.New$1(_1.OfSeq(V.map(function(bY){return _0.New(bY[0],bY[1]);},bX)));};E.Obsolete=function(bX){var bY,bZ,b0,b1,b2;bZ=bX.s;if(bZ==null||(bZ!=null&&bZ.$==2?(bY=bZ.$1,false):bZ!=null&&bZ.$==3?(bY=bZ.$1,false):true))void 0;else{bX.s=null;for(b0=0,b1=o.length(bY)-1;b0<=b1;b0++){b2=o.get(bY,b0);if(typeof b2=="object")(function(b3){E.Obsolete(b3);}(b2));else b2();}}};E.New=function(bX){return{s:bX};};Y.TryParseInt32=function(bX,bY){return Y.TryParse(bX,-2147483648,2147483647,bY);};_0=K.Pair=bU.Class({Equals:function(bX){return B.Equals(this.Key,bX.Key);},GetHashCode:function(){return B.Hash(this.Key);},CompareTo0:function(bX){return B.Compare(this.Key,bX.Key);}},null,_0);_0.New=function(bX,bY){return new _0({Key:bX,Value:bY});};_1.Contains=function(bX,bY){return!((_1.Lookup(bX,bY))[0]==null);};_1.Enumerate=function(bX,bY){function bZ(b0,b1){var b2;while(true)if(b0==null)return b1.$==1?{$:1,$0:[b1.$0[0],[b1.$0[1],b1.$1]]}:null;else if(bX){b2=b0;b0=b2.Right;b1=new i({$:1,$0:[b2.Node,b2.Left],$1:b1});}else{b2=b0;b0=b2.Left;b1=new i({$:1,$0:[b2.Node,b2.Right],$1:b1});}}return V.unfold(function(b0){return bZ(b0[0],b0[1]);},[bY,i.Empty]);};_1.Lookup=function(bX,bY){var bZ,b0,b1,b2;bZ=[];b0=bY;b1=true;while(b1)if(b0==null)b1=false;else{b2=B.Compare(bX,b0.Node);if(b2===0)b1=false;else b2===1?(bZ.unshift([true,b0.Node,b0.Left]),b0=b0.Right):(bZ.unshift([false,b0.Node,b0.Right]),b0=b0.Left);}return[b0,bZ];};_1.TryFind=function(bX,bY){var bZ;bZ=(_1.Lookup(bX,bY))[0];return bZ==null?null:{$:1,$0:bZ.Node};};_1.OfSeq=function(bX){var bY;bY=o.ofSeq(V.distinct(bX));o.sortInPlace(bY);return _1.Build(bY,0,bY.length-1);};_1.Build=function(bX,bY,bZ){var b0,b1,b2;return bZ-bY+1<=0?null:(b0=(bY+bZ)/2>>0,(b1=_1.Build(bX,bY,b0-1),(b2=_1.Build(bX,b0+1,bZ),_1.Branch(o.get(bX,b0),b1,b2))));};_1.Branch=function(bX,bY,bZ){var b0,b1;return _8.New(bX,bY,bZ,1+(b0=bY==null?0:bY.Height,(b1=bZ==null?0:bZ.Height,B.Compare(b0,b1)===1?b0:b1)),1+(bY==null?0:bY.Count)+(bZ==null?0:bZ.Count));};_2.Get=function(bX){return bX instanceof a.Array?_2.ArrayEnumerator(bX):B.Equals(typeof bX,"string")?_2.StringEnumerator(bX):bX.GetEnumerator();};_2.ArrayEnumerator=function(bX){return new _5.New(0,null,function(bY){var bZ;bZ=bY.s;return bZ<o.length(bX)&&(bY.c=o.get(bX,bZ),bY.s=bZ+1,true);},void 0);};_2.StringEnumerator=function(bX){return new _5.New(0,null,function(bY){var bZ;bZ=bY.s;return bZ<bX.length&&(bY.c=bX[bZ],bY.s=bZ+1,true);},void 0);};_2.Get0=function(bX){return bX instanceof a.Array?_2.ArrayEnumerator(bX):B.Equals(typeof bX,"string")?_2.StringEnumerator(bX):"GetEnumerator0"in bX?bX.GetEnumerator0():bX.GetEnumerator();};_3=K.HashSet=bU.Class({SAdd:function(bX){return this.add(bX);},Contains:function(bX){var bY;bY=this.data[this.hash(bX)];return bY==null?false:this.arrContains(bX,bY);},add:function(bX){var bY,bZ;bY=this.hash(bX);bZ=this.data[bY];return bZ==null?(this.data[bY]=[bX],this.count=this.count+1,true):this.arrContains(bX,bZ)?false:(bZ.push(bX),this.count=this.count+1,true);},arrContains:function(bX,bY){var bZ,b0,b1,b2;bZ=true;b0=0;b2=bY.length;while(bZ&&b0<b2)if(this.equals.apply(null,[bY[b0],bX]))bZ=false;else b0=b0+1;return!bZ;},GetEnumerator:function(){return _2.Get(bz.concat(this.data));},ExceptWith:function(bX){var bY;bY=_2.Get(bX);try{while(bY.MoveNext())this.Remove(bY.Current());}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}},Count:function(){return this.count;},IntersectWith:function(bX){var bY,bZ,b0,b1,b2;bY=new _3.New$4(bX,this.equals,this.hash);bZ=bz.concat(this.data);for(b0=0,b1=bZ.length-1;b0<=b1;b0++){b2=bZ[b0];if(!bY.Contains(b2))this.Remove(b2);}},Remove:function(bX){var bY;bY=this.data[this.hash(bX)];return bY==null?false:this.arrRemove(bX,bY)&&(this.count=this.count-1,true);},CopyTo:function(bX,bY){var bZ,b0,b1;bZ=bz.concat(this.data);for(b0=0,b1=bZ.length-1;b0<=b1;b0++)o.set(bX,b0+bY,bZ[b0]);},arrRemove:function(bX,bY){var bZ,b0,b1,b2;bZ=true;b0=0;b2=bY.length;while(bZ&&b0<b2)if(this.equals.apply(null,[bY[b0],bX])){bY.splice.apply(bY,[b0,1]);bZ=false;}else b0=b0+1;return!bZ;}},e,_3);_3.New$3=bU.Ctor(function(){_3.New$4.call(this,[],B.Equals,B.Hash);},_3);_3.New$4=bU.Ctor(function(bX,bY,bZ){var b0;e.New.call(this);this.equals=bY;this.hash=bZ;this.data=[];this.count=0;b0=_2.Get(bX);try{while(b0.MoveNext())this.add(b0.Current());}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}},_3);_3.New$2=bU.Ctor(function(bX){_3.New$4.call(this,bX,B.Equals,B.Hash);},_3);o.choose=function(bX,bY){var bZ,b0,b1,b2;bZ=[];for(b0=0,b1=bY.length-1;b0<=b1;b0++){b2=bX(bY[b0]);if(b2==null);else bZ.push(b2.$0);}return bZ;};o.ofList=function(bX){var bY,bZ;bZ=[];bY=bX;while(!(bY.$==0)){bZ.push(h.head(bY));bY=h.tail(bY);}return bZ;};o.ofSeq=function(bX){var bY,bZ;if(bX instanceof a.Array)return bX.slice();else if(bX instanceof i)return o.ofList(bX);else{bY=[];bZ=_2.Get(bX);try{while(bZ.MoveNext())bY.push(bZ.Current());return bY;}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}}};o.tryFindIndex=function(bX,bY){var bZ,b0;bZ=null;b0=0;while(b0<bY.length&&bZ==null){bX(bY[b0])?bZ={$:1,$0:b0}:void 0;b0=b0+1;}return bZ;};o.tryPick=function(bX,bY){var bZ,b0,b1;bZ=null;b0=0;while(b0<bY.length&&bZ==null){b1=bX(bY[b0]);if(b1!=null&&b1.$==1)bZ=b1;b0=b0+1;}return bZ;};o.exists=function(bX,bY){var bZ,b0,b1,b2;bZ=false;b0=0;b2=o.length(bY);while(!bZ&&b0<b2)if(bX(bY[b0]))bZ=true;else b0=b0+1;return bZ;};o.concat=function(bX){return a.Array.prototype.concat.apply([],o.ofSeq(bX));};o.foldBack=function(bX,bY,bZ){var b0,b1,b2,b3,b4;b0=bZ;b2=bY.length;for(b3=1,b4=b2;b3<=b4;b3++)b0=bX(bY[b2-b3],b0);return b0;};o.iter=function(bX,bY){var bZ,b0;for(bZ=0,b0=bY.length-1;bZ<=b0;bZ++)bX(bY[bZ]);};o.map=function(bX,bY){var bZ,b0,b1;bZ=new a.Array(bY.length);for(b0=0,b1=bY.length-1;b0<=b1;b0++)bZ[b0]=bX(bY[b0]);return bZ;};o.filter=function(bX,bY){var bZ,b0,b1;bZ=[];for(b0=0,b1=bY.length-1;b0<=b1;b0++)if(bX(bY[b0]))bZ.push(bY[b0]);return bZ;};o.pick=function(bX,bY){var bZ;bZ=o.tryPick(bX,bY);return bZ==null?j.FailWith("KeyNotFoundException"):bZ.$0;};o.sortInPlace=function(bX){o.mapInPlace(function(bY){return bY[0];},o.mapiInPlace(function(bY,bZ){return[bZ,bY];},bX).sort(B.Compare));};o.forall=function(bX,bY){var bZ,b0,b1,b2;bZ=true;b0=0;b2=o.length(bY);while(bZ&&b0<b2)if(bX(bY[b0]))b0=b0+1;else bZ=false;return bZ;};o.create=function(bX,bY){var bZ,b0,b1;bZ=new a.Array(bX);for(b0=0,b1=bX-1;b0<=b1;b0++)bZ[b0]=bY;return bZ;};o.init=function(bX,bY){var bZ,b0,b1;if(bX<0)j.FailWith("Negative size given.");else null;bZ=new a.Array(bX);for(b0=0,b1=bX-1;b0<=b1;b0++)bZ[b0]=bY(b0);return bZ;};_4.$cctor=function(){_4.$cctor=a.ignore;_4.initialized=new S.New$5();};_4=m.TemplateInitializer=bU.Class({},e,_4);_4.GetOrAddHoleFor=function(bX,bY,bZ){var b0,b1,b2,b3;_4.$cctor();b0=_4.GetHolesFor(bX);b1=(b2=null,[b0.TryGetValue(bY,{get:function(){return b2;},set:function(b4){b2=b4;}}),b2]);return b1[0]?b1[1]:(b3=bZ(),(b0.set_Item(bY,b3),b3));};_4.GetHolesFor=function(bX){var bY,bZ,b0;_4.$cctor();bY=(bZ=null,[_4.initialized.TryGetValue(bX,{get:function(){return bZ;},set:function(b1){bZ=b1;}}),bZ]);return bY[0]?bY[1]:(b0=new S.New$5(),(_4.initialized.set_Item(bX,b0),b0));};_5=_2.T=bU.Class({MoveNext:function(){var bX;bX=this.n(this);this.e=bX?1:2;return bX;},Current:function(){return this.e===1?this.c:this.e===0?j.FailWith("Enumeration has not started. Call MoveNext."):j.FailWith("Enumeration already finished.");},Dispose:function(){if(this.d)this.d(this);}},e,_5);_5.New=bU.Ctor(function(bX,bY,bZ,b0){e.New.call(this);this.s=bX;this.c=bY;this.n=bZ;this.d=b0;this.e=0;},_5);_6=f.CheckedInput=bU.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,_6);_7=f.DynamicAttrNode=bU.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(bX){return bj.get_Empty();},NGetEnterAnim:function(bX){return bj.get_Empty();},NGetChangeAnim:function(bX){return bj.get_Empty();},NSync:function(bX){if(this.dirty){(this.push(bX))(this.value);this.dirty=false;}}},e,_7);_7.New=bU.Ctor(function(bX,bY){var bZ;bZ=this;e.New.call(this);this.push=bY;this.value=void 0;this.dirty=false;this.updates=r.Map(function(b0){bZ.value=b0;bZ.dirty=true;},bX);},_7);o.groupBy=function(bX,bY){var bZ,b0,b1,b2,b3,b4;bZ=new S.New$5();b0=[];for(b1=0,b2=o.length(bY)-1;b1<=b2;b1++){b3=bY[b1];b4=bX(b3);if(bZ.ContainsKey(b4))bZ.Item(b4).push(b3);else{b0.push(b4);bZ.DAdd(b4,[b3]);}}o.mapInPlace(function(b5){return[b5,bZ.Item(b5)];},b0);return b0;};o.mapInPlace=function(bX,bY){var bZ,b0;for(bZ=0,b0=bY.length-1;bZ<=b0;bZ++)bY[bZ]=bX(bY[bZ]);};V.insufficient=function(){return j.FailWith("The input sequence has an insufficient number of elements.");};V.nonNegative=function(){return j.FailWith("The input must be non-negative.");};o.mapiInPlace=function(bX,bY){var bZ,b0;for(bZ=0,b0=bY.length-1;bZ<=b0;bZ++)bY[bZ]=bX(bZ,bY[bZ]);return bY;};_8.New=function(bX,bY,bZ,b0,b1){return{Node:bX,Left:bY,Right:bZ,Height:b0,Count:b1};};_9.notPresent=function(){return j.FailWith("The given key was not present in the dictionary.");};_9.alreadyAdded=function(){return j.FailWith("An item with the same key has already been added.");};_.$cctor=function(){_.$cctor=a.ignore;_.LoadedTemplates=new S.New$5();_.LocalTemplatesLoaded=false;_.GlobalHoles=new S.New$5();_.TextHoleRE="\\${([^}]+)}";_.RenderedFullDocTemplate=null;};$.LinkElement=function(bX,bY){$.InsertDoc(bX,bY,null);};$.InsertDoc=function(bX,bY,bZ){var b0,b1,b2;while(true)if(bY!=null&&bY.$==1)return $.InsertNode(bX,bY.$0.El,bZ);else if(bY!=null&&bY.$==2){b0=bY.$0;b0.Dirty=false;bY=b0.Current;}else if(bY==null)return bZ;else if(bY!=null&&bY.$==4)return $.InsertNode(bX,bY.$0.Text,bZ);else if(bY!=null&&bY.$==5)return $.InsertNode(bX,bY.$0,bZ);else if(bY!=null&&bY.$==6)return o.foldBack(function(b3,b4){return(((bU.Curried3(function(b5,b6,b7){return b6==null||b6.constructor===Z?$.InsertDoc(b5,b6,b7):$.InsertNode(b5,b6,b7);}))(bX))(b3))(b4);},bY.$0.Els,bZ);else{b1=bY.$1;b2=bY.$0;bY=b2;bZ=$.InsertDoc(bX,b1,bZ);}};$.CreateRunState=function(bX,bY){return bu.New(bv.get_Empty(),$.CreateElemNode(bX,U.EmptyAttr(),bY));};$.PerformAnimatedUpdate=function(bX,bY,bZ){var b0;return bj.get_UseAnimations()?(b0=null,bw.Delay(function(){var b1,b2,b3;b1=bv.FindAll(bZ);b2=$.ComputeChangeAnim(bY,b1);b3=$.ComputeEnterAnim(bY,b1);return bw.Bind(bj.Play(bj.Append(b2,$.ComputeExitAnim(bY,b1))),function(){return bw.Bind($.SyncElemNodesNextFrame(bX,bY),function(){return bw.Bind(bj.Play(b3),function(){bY.PreviousNodes=b1;return bw.Return(null);});});});})):$.SyncElemNodesNextFrame(bX,bY);};$.PerformSyncUpdate=function(bX,bY,bZ){var b0;b0=bv.FindAll(bZ);$.SyncElemNode(bX,bY.Top);bY.PreviousNodes=b0;};$.InsertBeforeDelim=function(bX,bY){var bZ,b0;bZ=bX.parentNode;b0=self.document.createTextNode("");bZ.insertBefore(b0,bX);$.LinkPrevElement(bX,bY);return b0;};$.InsertNode=function(bX,bY,bZ){be.InsertAt(bX,bZ,bY);return bY;};$.CreateElemNode=function(bX,bY,bZ){var b0;$.LinkElement(bX,bZ);b0=U.Insert(bX,bY);return bb.New(b0,bZ,null,bX,R.Int(),bU.GetOptional(b0.OnAfterRender));};$.SyncElemNodesNextFrame=function(bX,bY){function bZ(b0){a.requestAnimationFrame(function(){$.SyncElemNode(bX,bY.Top);b0();});}return bk.BatchUpdatesEnabled()?bw.FromContinuations(function(b0,b1,b2){return bZ.apply(null,[b0,b1,b2]);}):($.SyncElemNode(bX,bY.Top),bw.Return(null));};$.ComputeExitAnim=function(bX,bY){return bj.Concat(o.map(function(bZ){return U.GetExitAnim(bZ.Attr);},bv.ToArray(bv.Except(bY,bv.Filter(function(bZ){return U.HasExitAnim(bZ.Attr);},bX.PreviousNodes)))));};$.ComputeEnterAnim=function(bX,bY){return bj.Concat(o.map(function(bZ){return U.GetEnterAnim(bZ.Attr);},bv.ToArray(bv.Except(bX.PreviousNodes,bv.Filter(function(bZ){return U.HasEnterAnim(bZ.Attr);},bY)))));};$.ComputeChangeAnim=function(bX,bY){var bZ;function b0(b1){return U.HasChangeAnim(b1.Attr);}bZ=function(b1){return bv.Filter(b0,b1);};return bj.Concat(o.map(function(b1){return U.GetChangeAnim(b1.Attr);},bv.ToArray(bv.Intersect(bZ(bX.PreviousNodes),bZ(bY)))));};$.SyncElemNode=function(bX,bY){!bX?$.SyncElement(bY):void 0;$.Sync(bY.Children);$.AfterRender(bY);};$.CreateEmbedNode=function(){return{Current:null,Dirty:false};};$.UpdateEmbedNode=function(bX,bY){bX.Current=bY;bX.Dirty=true;};$.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};$.UpdateTextNode=function(bX,bY){bX.Value=bY;bX.Dirty=true;};$.LinkPrevElement=function(bX,bY){$.InsertDoc(bX.parentNode,bY,bX);};$.SyncElement=function(bX){function bY(bZ){function b0(b1){var b2,b3,b4,b5;while(true){if(b1!=null&&b1.$==0){b3=b1.$1;b4=b1.$0;if(b0(b4))return true;else b1=b3;}else if(b1!=null&&b1.$==2){b5=b1.$0;if(b5.Dirty)return true;else b1=b5.Current;}else return b1!=null&&b1.$==6&&(b2=b1.$0,b2.Dirty||o.exists(bY,b2.Holes));}}return b0(bZ.Children);}U.Sync(bX.El,bX.Attr);if(bY(bX))$.DoSyncElement(bX);};$.Sync=function(bX){var bY,bZ,b0,b1,b2;while(true){if(bX!=null&&bX.$==1)return $.SyncElemNode(false,bX.$0);else if(bX!=null&&bX.$==2){b0=bX.$0;bX=b0.Current;}else if(bX==null)return null;else if(bX!=null&&bX.$==5)return null;else if(bX!=null&&bX.$==4){bY=bX.$0;return bY.Dirty?(bY.Text.nodeValue=bY.Value,bY.Dirty=false):null;}else if(bX!=null&&bX.$==6){bZ=bX.$0;o.iter(function(b3){$.SyncElemNode(false,b3);},bZ.Holes);o.iter(function(b3){U.Sync(b3[0],b3[1]);},bZ.Attrs);return $.AfterRender(bZ);}else{b1=bX.$1;b2=bX.$0;$.Sync(b2);bX=b1;}}};$.AfterRender=function(bX){var bY;bY=bU.GetOptional(bX.Render);if(bY!=null&&bY.$==1){bY.$0(bX.El);bU.SetOptional(bX,"Render",null);}};$.DoSyncElement=function(bX){var bY,bZ,b0;function b1(b2,b3){var b4,b5,b6,b7;while(true){if(b2!=null&&b2.$==1)return b2.$0.El;else if(b2!=null&&b2.$==2){b5=b2.$0;if(b5.Dirty){b5.Dirty=false;return $.InsertDoc(bY,b5.Current,b3);}else b2=b5.Current;}else if(b2==null)return b3;else if(b2!=null&&b2.$==4)return b2.$0.Text;else if(b2!=null&&b2.$==5)return b2.$0;else if(b2!=null&&b2.$==6){b4=b2.$0;b4.Dirty?b4.Dirty=false:void 0;return o.foldBack(function(b8,b9){return b8==null||b8.constructor===Z?b1(b8,b9):b8;},b4.Els,b3);}else{b6=b2.$1;b7=b2.$0;b2=b7;b3=b1(b6,b3);}}}bY=bX.El;bM.Iter((bZ=bX.El,function(b2){be.RemoveNode(bZ,b2);}),bM.Except(bM.DocChildren(bX),bM.Children(bX.El,bU.GetOptional(bX.Delimiters))));b1(bX.Children,(b0=bU.GetOptional(bX.Delimiters),b0!=null&&b0.$==1?b0.$0[1]:null));};ba.$cctor=function(){ba.$cctor=a.ignore;ba.counter=0;};bb=f.DocElemNode=bU.Class({Equals:function(bX){return this.ElKey===bX.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bb);bb.New=function(bX,bY,bZ,b0,b1,b2){var b3;return new bb((b3={Attr:bX,Children:bY,El:b0,ElKey:b1},(bU.SetOptional(b3,"Delimiters",bZ),bU.SetOptional(b3,"Render",b2),b3)));};bd.$cctor=function(){var bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6;bd.$cctor=a.ignore;bd.EmptyAttr=null;bd.BoolCheckedApply=function(b7){function b8(b9,b_){return b_!=null&&b_.$==1?void(b9.checked=b_.$0):null;}return[function(b9){b9.addEventListener("change",function(){return!B.Equals(b7.Get(),b9.checked)?b7.Set(b9.checked):null;});},function(b9){return function(b_){return b8(b9,b_);};},r.Map(function(b9){return{$:1,$0:b9};},b7.get_View())];};bd.StringSet=function(b7){return function(b8){b7.value=b8;};};bd.StringGet=function(b7){return{$:1,$0:b7.value};};bd.StringApply=(bX=bo.StringGet(),(bY=bo.StringSet(),function(b7){return bo.ApplyValue(bX,bY,b7);}));bd.IntSetUnchecked=function(b7){return function(b8){b7.value=a.String(b8);};};bd.IntGetUnchecked=function(b7){var b8,b9;b8=b7.value;return bp.isBlank(b8)?{$:1,$0:0}:(b9=+b8,b9!==b9>>0?null:{$:1,$0:b9});};bd.IntApplyUnchecked=(bZ=bo.IntGetUnchecked(),(b0=bo.IntSetUnchecked(),function(b7){return bo.ApplyValue(bZ,b0,b7);}));bd.IntSetChecked=function(b7){return function(b8){var b9;b9=b8.get_Input();return b7.value!==b9?void(b7.value=b9):null;};};bd.IntGetChecked=function(b7){var b8,b9,b_;b8=b7.value;return{$:1,$0:bp.isBlank(b8)?(b7.checkValidity?b7.checkValidity():true)?new _6({$:2,$0:b8}):new _6({$:1,$0:b8}):(b9=(b_=0,[Y.TryParseInt32(b8,{get:function(){return b_;},set:function(b$){b_=b$;}}),b_]),b9[0]?new _6({$:0,$0:b9[1],$1:b8}):new _6({$:1,$0:b8}))};};bd.IntApplyChecked=(b1=bo.IntGetChecked(),(b2=bo.IntSetChecked(),function(b7){return bo.ApplyValue(b1,b2,b7);}));bd.FloatSetUnchecked=function(b7){return function(b8){b7.value=a.String(b8);};};bd.FloatGetUnchecked=function(b7){var b8,b9;b8=b7.value;return bp.isBlank(b8)?{$:1,$0:0}:(b9=+b8,a.isNaN(b9)?null:{$:1,$0:b9});};bd.FloatApplyUnchecked=(b3=bo.FloatGetUnchecked(),(b4=bo.FloatSetUnchecked(),function(b7){return bo.ApplyValue(b3,b4,b7);}));bd.FloatSetChecked=function(b7){return function(b8){var b9;b9=b8.get_Input();return b7.value!==b9?void(b7.value=b9):null;};};bd.FloatGetChecked=function(b7){var b8,b9;b8=b7.value;return{$:1,$0:bp.isBlank(b8)?(b7.checkValidity?b7.checkValidity():true)?new _6({$:2,$0:b8}):new _6({$:1,$0:b8}):(b9=+b8,a.isNaN(b9)?new _6({$:1,$0:b8}):new _6({$:0,$0:b9,$1:b8}))};};bd.FloatApplyChecked=(b5=bo.FloatGetChecked(),(b6=bo.FloatSetChecked(),function(b7){return bo.ApplyValue(b5,b6,b7);}));};be.ParseHTMLIntoFakeRoot=function(bX){var bY,bZ,b0,b1,b2;function b3(b4,b5){var b6;while(true)if(b5===0)return b4;else{b6=b5;b4=b4.lastChild;b5=b6-1;}}bY=self.document.createElement("div");return!be.rhtml().test(bX)?(bY.appendChild(self.document.createTextNode(bX)),bY):(bZ=(b0=be.rtagName().exec(bX),B.Equals(b0,null)?"":o.get(b0,1).toLowerCase()),(b1=(b2=(be.wrapMap())[bZ],b2?b2:be.defaultWrap()),(bY.innerHTML=b1[1]+bX.replace(be.rxhtmlTag(),"<$1></$2>")+b1[2],b3(bY,b1[0]))));};be.ChildrenArray=function(bX){var bY,bZ,b0;bY=[];for(bZ=0,b0=bX.childNodes.length-1;bZ<=b0;bZ++)bY.push(bX.childNodes[bZ]);return bY;};be.rhtml=function(){bC.$cctor();return bC.rhtml;};be.wrapMap=function(){bC.$cctor();return bC.wrapMap;};be.defaultWrap=function(){bC.$cctor();return bC.defaultWrap;};be.rxhtmlTag=function(){bC.$cctor();return bC.rxhtmlTag;};be.rtagName=function(){bC.$cctor();return bC.rtagName;};be.IterSelector=function(bX,bY,bZ){var b0,b1,b2;b0=bX.querySelectorAll(bY);for(b1=0,b2=b0.length-1;b1<=b2;b1++)bZ(b0[b1]);};be.InsertAt=function(bX,bY,bZ){var b0;if(!(bZ.parentNode===bX&&bY===(b0=bZ.nextSibling,B.Equals(b0,null)?null:b0)))bX.insertBefore(bZ,bY);};be.RemoveNode=function(bX,bY){if(bY.parentNode===bX)bX.removeChild(bY);};bf=f.Elt=bU.Class({},M,bf);bf.TreeNode=function(bX,bY){var bZ,b0;function b1(b2,b3){return U.Updates(b3);}bZ=br.Create(bY);return new bf.New$1({$:6,$0:bX},r.Map2Unit((b0=o.map(function(b2){return b1(b2[0],b2[1]);},bX.Attrs),T.TreeReduce(r.Const(),r.Map2Unit,b0)),bZ.v),o.get(bX.Els,0),bZ);};bf.New=function(bX,bY,bZ){var b0,b1;b0=$.CreateElemNode(bX,bY,bZ.docNode);b1=br.Create(bZ.updates);return new bf.New$1({$:1,$0:b0},r.Map2Unit(U.Updates(b0.Attr),b1.v),bX,b1);};bf.New$1=bU.Ctor(function(bX,bY,bZ,b0){M.New.call(this,bX,bY);this.docNode$1=bX;this.updates$1=bY;this.elt=bZ;this.rvUpdates=b0;},bf);bg.convertTextNode=function(bX){var bY,bZ,b0,b1,b2,b3;bY=null;bZ=0;b1=bX.textContent;b2=new a.RegExp(P.TextHoleRE(),"g");while(bY=b2.exec(b1),bY!==null){bX.parentNode.insertBefore(self.document.createTextNode(bh.string(b1,{$:1,$0:bZ},{$:1,$0:b2.lastIndex-o.get(bY,0).length-1})),bX);bZ=b2.lastIndex;b3=self.document.createElement("span");b3.setAttribute("ws-replace",o.get(bY,1).toLowerCase());bX.parentNode.insertBefore(b3,bX);}b2.lastIndex=0;bX.textContent=bh.string(b1,{$:1,$0:bZ},null);};bg.failNotLoaded=function(bX){bV.warn("Instantiating non-loaded template",bX);};bg.fillTextHole=function(bX,bY,bZ){var b0;b0=bX.querySelector("[ws-replace]");return B.Equals(b0,null)?(bV.warn("Filling non-existent text hole",bZ),null):(b0.parentNode.replaceChild(self.document.createTextNode(bY),b0),{$:1,$0:b0.getAttribute("ws-replace")});};bg.removeHolesExcept=function(bX,bY){function bZ(b0){P.foreachNotPreserved(bX,"["+b0+"]",function(b1){if(!bY.Contains(b1.getAttribute(b0)))b1.removeAttribute(b0);});}bZ("ws-attr");bZ("ws-onafterrender");bZ("ws-var");P.foreachNotPreserved(bX,"[ws-hole]",function(b0){if(!bY.Contains(b0.getAttribute("ws-hole"))){b0.removeAttribute("ws-hole");while(b0.hasChildNodes())b0.removeChild(b0.lastChild);}});P.foreachNotPreserved(bX,"[ws-replace]",function(b0){if(!bY.Contains(b0.getAttribute("ws-replace")))b0.parentNode.removeChild(b0);});P.foreachNotPreserved(bX,"[ws-on]",function(b0){b0.setAttribute("ws-on",bq.concat(" ",o.filter(function(b1){return bY.Contains(o.get(bq.SplitChars(b1,[":"],1),1));},bq.SplitChars(b0.getAttribute("ws-on"),[" "],1))));});P.foreachNotPreserved(bX,"[ws-attr-holes]",function(b0){var b1,b2,b3,b4,b5;b1=bq.SplitChars(b0.getAttribute("ws-attr-holes"),[" "],1);for(b2=0,b3=b1.length-1;b2<=b3;b2++){b4=o.get(b1,b2);b0.setAttribute(b4,(b5=new a.RegExp(P.TextHoleRE(),"g"),b0.getAttribute(b4).replace(b5,function(b6,b7){return bY.Contains(b7)?b6:"";})));}});};bg.fillInstanceAttrs=function(bX,bY){var bZ,b0,b1,b2,b3;bg.convertAttrs(bY);bZ=bY.nodeName.toLowerCase();b0=bX.querySelector("[ws-attr="+bZ+"]");if(B.Equals(b0,null))bV.warn("Filling non-existent attr hole",bZ);else{b0.removeAttribute("ws-attr");for(b1=0,b2=bY.attributes.length-1;b1<=b2;b1++){b3=bY.attributes.item(b1);if(b3.name==="class"&&b0.hasAttribute("class"))b0.setAttribute("class",b0.getAttribute("class")+" "+b3.nodeValue);else b0.setAttribute(b3.name,b3.nodeValue);}}};bg.mapHoles=function(bX,bY){function bZ(b0){P.foreachNotPreserved(bX,"["+b0+"]",function(b1){var b2,b3;b2=(b3=null,[bY.TryGetValue(b1.getAttribute(b0).toLowerCase(),{get:function(){return b3;},set:function(b4){b3=b4;}}),b3]);if(b2[0])b1.setAttribute(b0,b2[1]);});}bZ("ws-hole");bZ("ws-replace");bZ("ws-attr");bZ("ws-onafterrender");bZ("ws-var");P.foreachNotPreserved(bX,"[ws-on]",function(b0){b0.setAttribute("ws-on",bq.concat(" ",o.map(function(b1){var b2,b3,b4;b2=bq.SplitChars(b1,[":"],1);b3=(b4=null,[bY.TryGetValue(o.get(b2,1),{get:function(){return b4;},set:function(b5){b4=b5;}}),b4]);return b3[0]?o.get(b2,0)+":"+b3[1]:b1;},bq.SplitChars(b0.getAttribute("ws-on"),[" "],1))));});P.foreachNotPreserved(bX,"[ws-attr-holes]",function(b0){var b1,b2,b3;b1=bq.SplitChars(b0.getAttribute("ws-attr-holes"),[" "],1);for(b2=0,b3=b1.length-1;b2<=b3;b2++)(function(){var b4;function b5(b6,b7){var b8;b8=j.KeyValue(b7);return b6.replace(new a.RegExp("\\${"+b8[0]+"}","ig"),"${"+b8[1]+"}");}b4=o.get(b1,b2);return b0.setAttribute(b4,(((bU.Curried3(V.fold))(b5))(b0.getAttribute(b4)))(bY));}());});};bg.fill=function(bX,bY,bZ){while(true)if(bX.hasChildNodes())bZ=bY.insertBefore(bX.lastChild,bZ);else return null;};bg.convertAttrs=function(bX){var bZ,b0,b1,b2,b3,b4,b5,b6;function bY(b7){var b8;b8=bX.getAttribute(b7);if(b8===null);else bX.setAttribute(b7,b8.toLowerCase());}bZ=bX.attributes;b0=[];b1=[];b2=[];for(b3=0,b4=bZ.length-1;b3<=b4;b3++){b5=bZ.item(b3);if(bq.StartsWith(b5.nodeName,"ws-on")&&b5.nodeName!=="ws-onafterrender"&&b5.nodeName!=="ws-on"){b0.push(b5.nodeName);b1.push(bh.string(b5.nodeName,{$:1,$0:"ws-on".length},null)+":"+b5.nodeValue.toLowerCase());}else!bq.StartsWith(b5.nodeName,"ws-")&&(new a.RegExp(P.TextHoleRE())).test(b5.nodeValue)?(b5.nodeValue=(b6=new a.RegExp(P.TextHoleRE(),"g"),b5.nodeValue.replace(b6,function(b7,b8){return"${"+b8.toLowerCase()+"}";})),b2.push(b5.nodeName)):void 0;}if(!(b1.length==0))bX.setAttribute("ws-on",bq.concat(" ",b1));if(!(b2.length==0))bX.setAttribute("ws-attr-holes",bq.concat(" ",b2));bY("ws-hole");bY("ws-replace");bY("ws-attr");bY("ws-onafterrender");bY("ws-var");o.iter(function(b7){bX.removeAttribute(b7);},b0);};bh.string=function(bX,bY,bZ){var b0,b1;return bY==null?bZ!=null&&bZ.$==1?(b0=bZ.$0,b0<0?"":bX.slice(0,b0+1)):"":bZ==null?bX.slice(bY.$0):(b1=bZ.$0,b1<0?"":bX.slice(bY.$0,b1+1));};bi=K.KeyCollection=bU.Class({GetEnumerator:function(){return _2.Get(V.map(function(bX){return bX.K;},this.d));}},e,bi);bi.New=bU.Ctor(function(bX){e.New.call(this);this.d=bX;},bi);bj.get_UseAnimations=function(){return bx.UseAnimations();};bj.Play=function(bX){var bY;bY=null;return bw.Delay(function(){return bw.Bind(bj.Run(a.ignore,bx.Actions(bX)),function(){bx.Finalize(bX);return bw.Return(null);});});};bj.Append=function(bX,bY){return{$:0,$0:bE.Append(bX.$0,bY.$0)};};bj.Run=function(bX,bY){var bZ;function b0(b1){function b2(b3){return function(b4){var b5;b5=b4-b3;bY.Compute(b5);bX();return b5<=bZ?void a.requestAnimationFrame(function(b6){(b2(b3))(b6);}):b1();};}a.requestAnimationFrame(function(b3){(b2(b3))(b3);});}bZ=bY.Duration;return bZ===0?bw.Zero():bw.FromContinuations(function(b1,b2,b3){return b0.apply(null,[b1,b2,b3]);});};bj.Concat=function(bX){return{$:0,$0:bE.Concat(V.map(bx.List,bX))};};bj.get_Empty=function(){return{$:0,$0:bE.Empty()};};bk.BatchUpdatesEnabled=function(){by.$cctor();return by.BatchUpdatesEnabled;};bl.StartProcessor=function(bX){var bY;function bZ(){var b0;b0=null;return bw.Delay(function(){return bw.Bind(bX,function(){var b1;b1=bY[0];return B.Equals(b1,1)?(bY[0]=0,bw.Zero()):B.Equals(b1,2)?(bY[0]=1,bZ()):bw.Zero();});});}bY=[0];return function(){var b0;b0=bY[0];if(B.Equals(b0,0)){bY[0]=1;bw.Start(bZ(),null);}else B.Equals(b0,1)?bY[0]=2:void 0;};};bn.New=function(bX,bY,bZ,b0){var b1;b1={DynElem:bX,DynFlags:bY,DynNodes:bZ};bU.SetOptional(b1,"OnAfterRender",b0);return b1;};bo.ApplyValue=function(bX,bY,bZ){var b0;function b1(b2,b3){return b3==null?null:b2(b3.$0);}b0=null;return[function(b2){function b3(){bZ.UpdateMaybe(function(b4){var b5;b0=bX(b2);return b0!=null&&b0.$==1&&(!B.Equals(b0.$0,b4)&&(b5=[b0,b0.$0],true))?b5[0]:null;});}b2.addEventListener("change",b3);b2.addEventListener("input",b3);b2.addEventListener("keypress",b3);},function(b2){var b3;b3=bY(b2);return function(b4){return b1(b3,b4);};},r.Map(function(b2){var b3;return b0!=null&&b0.$==1&&(B.Equals(b0.$0,b2)&&(b3=b0.$0,true))?null:{$:1,$0:b2};},bZ.get_View())];};bo.StringSet=function(){bd.$cctor();return bd.StringSet;};bo.StringGet=function(){bd.$cctor();return bd.StringGet;};bo.IntSetUnchecked=function(){bd.$cctor();return bd.IntSetUnchecked;};bo.IntGetUnchecked=function(){bd.$cctor();return bd.IntGetUnchecked;};bo.IntSetChecked=function(){bd.$cctor();return bd.IntSetChecked;};bo.IntGetChecked=function(){bd.$cctor();return bd.IntGetChecked;};bo.FloatSetUnchecked=function(){bd.$cctor();return bd.FloatSetUnchecked;};bo.FloatGetUnchecked=function(){bd.$cctor();return bd.FloatGetUnchecked;};bo.FloatSetChecked=function(){bd.$cctor();return bd.FloatSetChecked;};bo.FloatGetChecked=function(){bd.$cctor();return bd.FloatGetChecked;};bo.StringApply=function(){bd.$cctor();return bd.StringApply;};bo.BoolCheckedApply=function(){bd.$cctor();return bd.BoolCheckedApply;};bo.IntApplyChecked=function(){bd.$cctor();return bd.IntApplyChecked;};bo.IntApplyUnchecked=function(){bd.$cctor();return bd.IntApplyUnchecked;};bo.FloatApplyChecked=function(){bd.$cctor();return bd.FloatApplyChecked;};bo.FloatApplyUnchecked=function(){bd.$cctor();return bd.FloatApplyUnchecked;};bp.isBlank=function(bX){return bq.forall(bA.IsWhiteSpace,bX);};bq.concat=function(bX,bY){return o.ofSeq(bY).join(bX);};bq.SplitChars=function(bX,bY,bZ){return bq.Split(bX,new a.RegExp("["+bq.RegexEscape(bY.join(""))+"]"),bZ);};bq.StartsWith=function(bX,bY){return bX.substring(0,bY.length)==bY;};bq.forall=function(bX,bY){return V.forall(bX,bq.protect(bY));};bq.Split=function(bX,bY,bZ){return bZ===1?o.filter(function(b0){return b0!=="";},bq.SplitWith(bX,bY)):bq.SplitWith(bX,bY);};bq.RegexEscape=function(bX){return bX.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};bq.protect=function(bX){return bX===null?"":bX;};bq.SplitWith=function(bX,bY){return bX.split(bY);};br=f.Updates=bU.Class({},null,br);br.Create=function(bX){var bY;bY=null;bY=br.New(bX,null,function(){var bZ;bZ=bY.s;return bZ===null?(bZ=E.Copy(bY.c()),bY.s=bZ,E.WhenObsoleteRun(bZ,function(){bY.s=null;}),bZ):bZ;});return bY;};br.New=function(bX,bY,bZ){return new br({c:bX,s:bY,v:bZ});};bs=K.ValueCollection=bU.Class({GetEnumerator:function(){return _2.Get(V.map(function(bX){return bX.V;},this.d));}},e,bs);bs.New=bU.Ctor(function(bX){e.New.call(this);this.d=bX;},bs);bu.New=function(bX,bY){return{PreviousNodes:bX,Top:bY};};bv.get_Empty=function(){return{$:0,$0:new _3.New$3()};};bv.FindAll=function(bX){var bY;function bZ(b2,b3){var b4,b5,b6,b7,b8;while(true)switch(b2){case 0:if(b3!=null&&b3.$==0){b5=b3.$1;b6=b3.$0;bZ(0,b6);b3=b5;}else if(b3!=null&&b3.$==1){b7=b3.$0;b3=b7;b2=1;}else if(b3!=null&&b3.$==2){b8=b3.$0;b3=b8.Current;}else return b3!=null&&b3.$==6?(b4=b3.$0.Holes,(function(b9){return function(b_){o.iter(b9,b_);};}(b1))(b4)):null;break;case 1:bY.push(b3);b3=b3.Children;b2=0;break;}}function b0(b2){return bZ(0,b2);}function b1(b2){return bZ(1,b2);}bY=[];b0(bX);return{$:0,$0:new _3.New$2(bY)};};bv.Filter=function(bX,bY){return{$:0,$0:bK.Filter(bX,bY.$0)};};bv.Except=function(bX,bY){return{$:0,$0:bK.Except(bX.$0,bY.$0)};};bv.ToArray=function(bX){return bK.ToArray(bX.$0);};bv.Intersect=function(bX,bY){return{$:0,$0:bK.Intersect(bX.$0,bY.$0)};};bw.Delay=function(bX){return function(bY){try{(bX(null))(bY);}catch(bZ){bY.k({$:1,$0:bZ});}};};bw.Bind=function(bX,bY){return bw.checkCancel(function(bZ){bX(bH.New(function(b0){var b1;if(b0.$==0){b1=b0.$0;bw.scheduler().Fork(function(){try{(bY(b1))(bZ);}catch(b2){bZ.k({$:1,$0:b2});}});}else bw.scheduler().Fork(function(){bZ.k(b0);});},bZ.ct));});};bw.Zero=function(){bI.$cctor();return bI.Zero;};bw.Start=function(bX,bY){var bZ,b0;bZ=(b0=(bw.defCTS())[0],bY==null?b0:bY.$0);bw.scheduler().Fork(function(){if(!bZ.c)bX(bH.New(function(b1){if(b1.$==1)bw.UncaughtAsyncError(b1.$0);},bZ));});};bw.Return=function(bX){return function(bY){bY.k({$:0,$0:bX});};};bw.scheduler=function(){bI.$cctor();return bI.scheduler;};bw.checkCancel=function(bX){return function(bY){if(bY.ct.c)bw.cancel(bY);else bX(bY);};};bw.defCTS=function(){bI.$cctor();return bI.defCTS;};bw.UncaughtAsyncError=function(bX){bV.log("WebSharper: Uncaught asynchronous exception",bX);};bw.FromContinuations=function(bX){return function(bY){var bZ;function b0(b1){if(bZ[0])j.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{bZ[0]=true;bw.scheduler().Fork(b1);}}bZ=[false];bX(function(b1){b0(function(){bY.k({$:0,$0:b1});});},function(b1){b0(function(){bY.k({$:1,$0:b1});});},function(b1){b0(function(){bY.k({$:2,$0:b1});});});};};bw.cancel=function(bX){bX.k({$:2,$0:new bO.New(bX.ct)});};bx.UseAnimations=function(){bD.$cctor();return bD.UseAnimations;};bx.Actions=function(bX){return bx.ConcatActions(o.choose(function(bY){return bY.$==1?{$:1,$0:bY.$0}:null;},bE.ToArray(bX.$0)));};bx.Finalize=function(bX){o.iter(function(bY){if(bY.$==0)bY.$0();},bE.ToArray(bX.$0));};bx.ConcatActions=function(bX){var bY,bZ,b0,b1;bY=T.ofSeqNonCopying(bX);bZ=o.length(bY);return bZ===0?bx.Const():bZ===1?o.get(bY,0):(b0=V.max(V.map(function(b2){return b2.Duration;},bY)),(b1=o.map(function(b2){return bx.Prolong(b0,b2);},bY),bx.Def(b0,function(b2){o.iter(function(b3){b3.Compute(b2);},b1);})));};bx.List=function(bX){return bX.$0;};bx.Const=function(bX){return bx.Def(0,function(){return bX;});};bx.Def=function(bX,bY){return{Compute:bY,Duration:bX};};bx.Prolong=function(bX,bY){var bZ,b0,b1;bZ=bY.Compute;b0=bY.Duration;b1=bP.Create(function(){return bY.Compute(bY.Duration);});return{Compute:function(b2){return b2>=b0?b1.f():bZ(b2);},Duration:bX};};by.$cctor=function(){by.$cctor=a.ignore;by.BatchUpdatesEnabled=true;};bz.concat=function(bX){var bY,bZ;bY=[];for(var b0 in bX)bY.push.apply(bY,bX[b0]);return bY;};bA.IsWhiteSpace=function(bX){return bX.match(new a.RegExp("\\s"))!==null;};Y.TryParse=function(bX,bY,bZ,b0){var b1,b2;b1=+bX;b2=b1===b1-b1%1&&b1>=bY&&b1<=bZ;if(b2)b0.set(b1);return b2;};bB.Clear=function(bX){bX.splice(0,o.length(bX));};bC.$cctor=function(){var bX;bC.$cctor=a.ignore;bC.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bC.rtagName=new a.RegExp("<([\\w:]+)");bC.rhtml=new a.RegExp("<|&#?\\w+;");bC.wrapMap=(bX=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:bX,tbody:bX,tfoot:bX,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bC.defaultWrap=[0,"",""];};bD.$cctor=function(){bD.$cctor=a.ignore;bD.CubicInOut=bG.Custom(function(bX){var bY;bY=bX*bX;return 3*bY-2*(bY*bX);});bD.UseAnimations=true;};bE.Append=function(bX,bY){return bX.$==0?bY:bY.$==0?bX:{$:2,$0:bX,$1:bY};};bE.ToArray=function(bX){var bY;function bZ(b0){var b1,b2;while(true)if(b0.$==1)return bY.push(b0.$0);else if(b0.$==2){b1=b0.$1;b2=b0.$0;bZ(b2);b0=b1;}else return b0.$==3?o.iter(function(b3){bY.push(b3);},b0.$0):null;}bY=[];bZ(bX);return bY.slice(0);};bE.Concat=function(bX){var bY;bY=T.ofSeqNonCopying(bX);return T.TreeReduce(bE.Empty(),bE.Append,bY);};bE.Empty=function(){bQ.$cctor();return bQ.Empty;};bF=bw.Scheduler=bU.Class({Fork:function(bX){var bY;bY=this;this.robin.push(bX);if(this.idle){this.idle=false;a.setTimeout(function(){bY.tick();},0);}},tick:function(){var bX,bY,bZ;bY=this;bZ=bW.now();bX=true;while(bX)if(this.robin.length===0){this.idle=true;bX=false;}else{(this.robin.shift())();bW.now()-bZ>40?(a.setTimeout(function(){bY.tick();},0),bX=false):void 0;}}},e,bF);bF.New=bU.Ctor(function(){e.New.call(this);this.idle=true;this.robin=[];},bF);bG=f.Easing=bU.Class({},e,bG);bG.Custom=function(bX){return new bG.New(bX);};bG.New=bU.Ctor(function(bX){e.New.call(this);this.transformTime=bX;},bG);bH.New=function(bX,bY){return{k:bX,ct:bY};};bI.$cctor=function(){bI.$cctor=a.ignore;bI.noneCT=bJ.New(false,[]);bI.scheduler=new bF.New();bI.defCTS=[new bL.New()];bI.Zero=bw.Return();bI.GetCT=function(bX){bX.k({$:0,$0:bX.ct});};};bJ.New=function(bX,bY){return{c:bX,r:bY};};bK.Filter=function(bX,bY){return new _3.New$2(o.filter(bX,bK.ToArray(bY)));};bK.Except=function(bX,bY){var bZ;bZ=new _3.New$2(bK.ToArray(bY));bZ.ExceptWith(bK.ToArray(bX));return bZ;};bK.ToArray=function(bX){var bY;bY=o.create(bX.Count(),void 0);bX.CopyTo(bY,0);return bY;};bK.Intersect=function(bX,bY){var bZ;bZ=new _3.New$2(bK.ToArray(bX));bZ.IntersectWith(bK.ToArray(bY));return bZ;};bL=d.CancellationTokenSource=bU.Class({},e,bL);bL.New=bU.Ctor(function(){e.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bL);bM.Children=function(bX,bY){var bZ,b0,b1;if(bY!=null&&bY.$==1){b1=[];bZ=bY.$0[0].nextSibling;while(bZ!==bY.$0[1]){b1.push(bZ);bZ=bZ.nextSibling;}return{$:0,$0:b1};}else return{$:0,$0:o.init(bX.childNodes.length,(b0=bX.childNodes,function(b2){return b0[b2];}))};};bM.Except=function(bX,bY){var bZ;bZ=bX.$0;return{$:0,$0:o.filter(function(b0){return o.forall(function(b1){return!(b0===b1);},bZ);},bY.$0)};};bM.Iter=function(bX,bY){o.iter(bX,bY.$0);};bM.DocChildren=function(bX){var bY;function bZ(b0){var b1,b2,b3,b4;while(true){if(b0!=null&&b0.$==2){b2=b0.$0;b0=b2.Current;}else if(b0!=null&&b0.$==1)return bY.push(b0.$0.El);else if(b0==null)return null;else if(b0!=null&&b0.$==5)return bY.push(b0.$0);else if(b0!=null&&b0.$==4)return bY.push(b0.$0.Text);else if(b0!=null&&b0.$==6){b1=b0.$0.Els;return(function(b5){return function(b6){o.iter(b5,b6);};}(function(b5){if(b5==null||b5.constructor===Z)bZ(b5);else bY.push(b5);}))(b1);}else{b3=b0.$1;b4=b0.$0;bZ(b4);b0=b3;}}}bY=[];bZ(bX.Children);return{$:0,$0:T.ofSeqNonCopying(bY)};};bO=d.OperationCanceledException=bU.Class({},bN,bO);bO.New=bU.Ctor(function(bX){bO.New$1.call(this,"The operation was canceled.",null,bX);},bO);bO.New$1=bU.Ctor(function(bX,bY,bZ){this.message=bX;this.inner=bY;Z.setPrototypeOf(this,bO.prototype);this.ct=bZ;},bO);bP.Create=function(bX){return bS.New(false,bX,bP.forceLazy);};bP.forceLazy=function(){var bX;bX=this.v();this.c=true;this.v=bX;this.f=bP.cachedLazy;return bX;};bP.cachedLazy=function(){return this.v;};bQ.$cctor=function(){bQ.$cctor=a.ignore;bQ.Empty={$:0};};bS.New=function(bX,bY,bZ){return{c:bX,v:bY,f:bZ};};bU.OnLoad(function(){c.Main();});}(self));


if (typeof WebSharper !=='undefined') {
  WebSharper.Runtime.ScriptBasePath = '/Content/';
  WebSharper.Runtime.Start();
}
